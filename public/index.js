var Z=Symbol.for("#__init__"),ru=Symbol.for("#__initor__"),I0=Symbol.for("#__inited__"),fu=Symbol.for("#__hooks__"),ed=Symbol.for("#__patch__"),_0=Symbol.for("#has"),$0=Symbol.for("#meta"),k0=Symbol.for("imba"),md=Symbol.for("#__mixin__"),Sd=Symbol.for("#matcher"),bd=Symbol.for("#L"),Ed=Symbol.for("#appendChild"),vd=Symbol.for("#afterVisit"),wd=Symbol.for("#beforeReconcile"),dd=Symbol.for("#afterReconcile"),Td=Symbol.for("##up");var Oh={IsExtension:1,IsTag:2,HasDescriptors:4,HasSuperCalls:8,HasConstructor:16,HasFields:32,HasMixins:64,HasInitor:128,HasDecorators:256,IsObjectExtension:512},Ei=new Map,p0=globalThis[k0]||={counter:0,classes:Ei};function qi(n,i={}){return Ei.has(n)||Ei.set(n,{symbol:Symbol(n.name),parent:Object.getPrototypeOf(n.prototype)?.constructor,for:n,uses:null,inits:null,id:p0.counter++,...i}),Ei.get(n)}function H(n,i){return typeof i==="string"?typeof n===i:i?.[Symbol.hasInstance]?.(n)}function eu(n,i){return i?.[_0]?.(n)??i?.includes?.(n)??i?.has?.(n)??!1}function yh(n){return n?.toIterable?.()||n}function a0(n,i){if(!n||!i)return!1;if(n.get)return i.get===n.get;if(n.set)return i.set===n.set;if(n.value)return n.value===i.value}function mu(n,i,h,s={}){let t=n.constructor;if(!h&&i){if(h=Object.getOwnPropertyDescriptors(i),delete h.constructor,h[Z])console.warn(`Cannot define plain fields when extending class ${t.name}`),delete h[Z]}let l=qi(t);if(l&&l.augments){let u=new Map;for(let o of Object.keys(h)){let c=Object.getOwnPropertyDescriptor(n,o);for(let f of l.augments){let r=u.get(f);r||u.set(f,r={});let e=Object.getOwnPropertyDescriptor(f.prototype,o);if(e&&!a0(c,e))console.warn("wont extend",o,e,c);else r[o]=h[o]}}for(let[o,c]of u)if(Object.keys(c).length)mu(o.prototype,null,c)}return Object.defineProperties(n,h),n}function Su(n,i){let h=qi(n),s=qi(i);if(s.parent){if(!(n.prototype instanceof s.parent))throw new Error(`Mixin ${i.name} has superclass not present in target class`)}if(!s.augments){s.augments=new Set;let l=s.ref=Symbol(i.name),u=Object[Symbol.hasInstance];i.prototype[l]=!0,Object.defineProperty(i,Symbol.hasInstance,{value:function(o){return this===i?o&&!!o[l]:u.call(this,o)}})}if(n.prototype[s.ref])return n;if(s.uses)for(let l of s.uses)Su(n,l);s.augments.add(n),h.uses||=[],h.uses.push(i);let t=Object.getOwnPropertyDescriptors(i.prototype);if(delete t.constructor,t[Z])h.inits||=[],h.inits.push(i.prototype[Z]),delete t[Z];if(Object.defineProperties(n.prototype,t),i?.mixed instanceof Function)i.mixed(n);return n}var hi={cache:{},self:null,target:null,proxy:new Proxy({},{apply:(n,i,...h)=>{return hi.target[i].apply(hi.self,h)},get:(n,i)=>{return Reflect.get(hi.target,i,hi.self)},set:(n,i,h,s)=>{return Reflect.set(hi.target,i,h,hi.self)}})};function x(n,i,h,s,t=null){let l=Object.getPrototypeOf(n.prototype),u=s&Oh.HasMixins,o;if(u)Ei.set(n,Ei.get(l.constructor)),l=Object.getPrototypeOf(l);if(t){let f=s&Oh.IsObjectExtension?t:t.prototype,r=qi(n);if(r.uses){if(t===f)console.warn("Cannot extend object with mixins");for(let e of r.uses)Su(t,e)}if(s&Oh.HasSuperCalls)hi.cache[i]=Object.create(Object.getPrototypeOf(f),Object.getOwnPropertyDescriptors(f));return mu(f,n.prototype),t}let c=l?.constructor;if(o=qi(n,{symbol:i}),Object.defineProperty(n,$0,{value:o,enumerable:!1,configurable:!0}),h&&n.name!==h)Object.defineProperty(n,"name",{value:h,configurable:!0});if(o.flags=s,s&Oh.HasConstructor)n.prototype[ru]=i;if(o.uses)for(let f of o.uses)f.mixes?.(n);if(c?.inherited instanceof Function)c.inherited(n);return n}function si(n,i){if(n[ru]===i)n[I0]?.(),n[fu]&&n[fu].inited(n)}var pi=Symbol.for("#__init__"),ne=Symbol.for("#__initor__"),Fd=Symbol.for("#__inited__"),Ld=Symbol.for("#__hooks__"),Kd=Symbol.for("#__patch__"),Od=Symbol.for("#has"),ie=Symbol.for("#meta"),bu=Symbol.for("imba"),yd=Symbol.for("#__mixin__"),Gd=Symbol.for("#matcher"),Cd=Symbol.for("#L"),Yd=Symbol.for("#appendChild"),Xd=Symbol.for("#afterVisit"),zd=Symbol.for("#beforeReconcile"),Qd=Symbol.for("#afterReconcile"),Hd=Symbol.for("##up");var Gh={IsExtension:1,IsTag:2,HasDescriptors:4,HasSuperCalls:8,HasConstructor:16,HasFields:32,HasMixins:64,HasInitor:128,HasDecorators:256,IsObjectExtension:512},Yi=new Map,he=globalThis[bu]||(globalThis[bu]={counter:0,classes:Yi});function uh(n,i={}){var h;return Yi.has(n)||Yi.set(n,{symbol:Symbol(n.name),parent:(h=Object.getPrototypeOf(n.prototype))==null?void 0:h.constructor,for:n,uses:null,inits:null,id:he.counter++,...i}),Yi.get(n)}function se(n,i){if(!n||!i)return!1;if(n.get)return i.get===n.get;if(n.set)return i.set===n.set;if(n.value)return n.value===i.value}function fc(n,i,h,s={}){let t=n.constructor;!h&&i&&(h=Object.getOwnPropertyDescriptors(i),delete h.constructor,h[pi]&&(console.warn(`Cannot define plain fields when extending class ${t.name}`),delete h[pi]));let l=uh(t);if(l&&l.augments){let u=new Map;for(let o of Object.keys(h)){let c=Object.getOwnPropertyDescriptor(n,o);for(let f of l.augments){let r=u.get(f);r||u.set(f,r={});let e=Object.getOwnPropertyDescriptor(f.prototype,o);e&&!se(c,e)?console.warn("wont extend",o,e,c):r[o]=h[o]}}for(let[o,c]of u)Object.keys(c).length&&fc(o.prototype,null,c)}return Object.defineProperties(n,h),n}function rc(n,i){let h=uh(n),s=uh(i);if(s.parent&&!(n.prototype instanceof s.parent))throw new Error(`Mixin ${i.name} has superclass not present in target class`);if(!s.augments){s.augments=new Set;let l=s.ref=Symbol(i.name),u=Object[Symbol.hasInstance];i.prototype[l]=!0,Object.defineProperty(i,Symbol.hasInstance,{value:function(o){return this===i?o&&!!o[l]:u.call(this,o)}})}if(n.prototype[s.ref])return n;if(s.uses)for(let l of s.uses)rc(n,l);s.augments.add(n),h.uses||(h.uses=[]),h.uses.push(i);let t=Object.getOwnPropertyDescriptors(i.prototype);return delete t.constructor,t[pi]&&(h.inits||(h.inits=[]),h.inits.push(i.prototype[pi]),delete t[pi]),Object.defineProperties(n.prototype,t),(i==null?void 0:i.mixed)instanceof Function&&i.mixed(n),n}var li={cache:{},self:null,target:null,proxy:new Proxy({},{apply:(n,i,...h)=>li.target[i].apply(li.self,h),get:(n,i)=>Reflect.get(li.target,i,li.self),set:(n,i,h,s)=>Reflect.set(li.target,i,h,li.self)})};function d(n,i,h,s,t=null){var l;let u=Object.getPrototypeOf(n.prototype),o=s&Gh.HasMixins,c;if(o&&(Yi.set(n,Yi.get(u.constructor)),u=Object.getPrototypeOf(u)),t){let r=s&Gh.IsObjectExtension?t:t.prototype,e=uh(n);if(e.uses){t===r&&console.warn("Cannot extend object with mixins");for(let S of e.uses)rc(t,S)}return s&Gh.HasSuperCalls&&(li.cache[i]=Object.create(Object.getPrototypeOf(r),Object.getOwnPropertyDescriptors(r))),fc(r,n.prototype),t}let f=u==null?void 0:u.constructor;if(c=uh(n,{symbol:i}),Object.defineProperty(n,ie,{value:c,enumerable:!1,configurable:!0}),h&&n.name!==h&&Object.defineProperty(n,"name",{value:h,configurable:!0}),c.flags=s,s&Gh.HasConstructor&&(n.prototype[ne]=i),c.uses)for(let r of c.uses)(l=r.mixes)==null||l.call(r,n);return(f==null?void 0:f.inherited)instanceof Function&&f.inherited(n),n}var is=Symbol.for("#__listeners__");var te=Symbol(),ec=class{static for(n){return new Proxy({},new this(n))}constructor(n){this.getter=n}get target(){return this.getter()}get(n,i){return this.target[i]}set(n,i,h){return this.target[i]=h,!0}},le=ec;(()=>{d(ec,te,"LazyProxy",16)})();function ue(n,i={}){return new Proxy(i,new le(n))}function Ch(n){let i=typeof n;if(i=="number")return n;if(i=="string"){if(/^\d+fps$/.test(n))return 1000/parseFloat(n);if(/^([-+]?[\d\.]+)s$/.test(n))return parseFloat(n)*1000;if(/^([-+]?[\d\.]+)ms$/.test(n))return parseFloat(n)}return null}function Dt(n,i,h){if(!n)return;let s=Object.getOwnPropertyDescriptor(n,i);return s||n==h?s||void 0:Dt(Reflect.getPrototypeOf(n),i,h)}var Eu=function(n,i,h){let s,t,l;for(;(s=h)&&(h=h.next);)(t=h.listener)&&(h.path&&t[h.path]?l=i?t[h.path].apply(t,i):t[h.path]():l=i?t.apply(h,i):t.call(h)),h.times&&--h.times<=0&&(s.next=h.next,h.listener=null)};function rh(n,i,h,s){let t,l,u;return t=n[is]||(n[is]={}),l=t[i]||(t[i]={}),u=l.tail||(l.tail=l.next={}),u.listener=h,u.path=s,l.tail=u.next={},u}function Sn(n,i,h){let s=rh(n,i,h);return s.times=1,s}function Ss(n,i,h,s){if(!h)return;let t,l,u=n[is];if(!!u&&(t=u[i])){for(;(l=t)&&(t=t.next);)if(t==h||t.listener==h){l.next=t.next,t.listener=null;break}}}function fi(n,i,h=null){let s;(s=n[is])&&(s[i]&&Eu(i,h,s[i]),s.all&&Eu(i,[i,h],s.all))}var oe=Symbol(),mc=class{emit(n,...i){return fi(this,n,i)}on(n,...i){return rh(this,n,...i)}once(n,...i){return Sn(this,n,...i)}un(n,...i){return Ss(this,n,...i)}},It=mc;(()=>{d(mc,oe,"Emitter",0)})();function _s(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function ce(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var vu=Symbol.for("#__init__"),wu=Symbol.for("#schedule"),zt=Symbol.for("#frames"),Yh=Symbol.for("#interval"),vi=Symbol.for("#stage"),wi=Symbol.for("#scheduled"),Xh=Symbol.for("#version"),fe=Symbol.for("#fps"),du=Symbol.for("#ticker"),re=globalThis.requestAnimationFrame||function(n){return globalThis.setTimeout(n,16.666666666666668)};var ee=Symbol(),Sc=class{constructor(n=null){this[vu](n)}[vu](n=null,i=!0,h=!0){var s;this.owner=n&&(s=n.owner)!==void 0?s:null,this.target=n&&(s=n.target)!==void 0?s:null,this.active=n&&(s=n.active)!==void 0?s:!1,this.value=n&&(s=n.value)!==void 0?s:void 0,this.skip=n&&(s=n.skip)!==void 0?s:0,this.last=n&&(s=n.last)!==void 0?s:0}tick(n,i){return this.last=this.owner[zt],this.target.tick(this,i),1}update(n,i){let h=this.active,s=n.value;return this.value!=s&&(this.deactivate(),this.value=s),(this.value||h||i)&&this.activate(),this}queue(){this.owner.add(this)}activate(){return this.value===!0?this.owner.on("commit",this):this.value===!1||typeof this.value=="number"&&(this.value/16.666666666666668<=2?this.owner.on("raf",this):this[Yh]=globalThis.setInterval(this.queue.bind(this),this.value)),this.active=!0,this}deactivate(){return this.value===!0&&this.owner.un("commit",this),this.owner.un("raf",this),this[Yh]&&(globalThis.clearInterval(this[Yh]),this[Yh]=null),this.active=!1,this}},me=Sc;(()=>{d(Sc,ee,"Scheduled",16)})();var Se=Symbol(),bc=class{constructor(){var n=this;this.id=Symbol(),this.queue=[],this.stage=-1,this[vi]=-1,this[zt]=0,this[wi]=!1,this[Xh]=0,this.listeners={},this.intervals={},this.commit=function(){return n.add("commit"),n},this[fe]=0,this.$promise=null,this.$resolve=null,this[du]=function(i){return n[wi]=!1,n.tick(i)}}touch(){return this[Xh]++}get version(){return this[Xh]}add(n,i=!1){return(i||this.queue.indexOf(n)==-1)&&this.queue.push(n),this[wi]||this[wu](),this}get committingΦ(){return this.queue.indexOf("commit")>=0}get syncingΦ(){return this[vi]==1}listen(n,i){let h=this.listeners[n],s=!h;return h||(h=this.listeners[n]=new Set),h.add(i),n=="raf"&&s&&this.add("raf"),this}unlisten(n,i){var h;let s=this.listeners[n];return s&&s.delete(i),n=="raf"&&s&&s.size==0&&(h=this.listeners.raf,delete this.listeners.raf),this}on(n,i){return this.listen(n,i)}un(n,i){return this.unlisten(n,i)}get promise(){var n=this;return this.$promise||(this.$promise=new Promise(function(i){return n.$resolve=i}))}tick(n){var i=this;let h=this.queue,s=this[zt]++;if(this.ts||(this.ts=n),this.dt=n-this.ts,this.ts=n,this.queue=[],this[vi]=1,this[Xh]++,h.length)for(let t=0,l=ce(h),u=l.length;t<u;t++){let o=l[t];typeof o=="string"&&this.listeners[o]?this.listeners[o].forEach(function(c){if(_s(c.tick,Function))return c.tick(i,o);if(_s(c,Function))return c(i,o)}):_s(o,Function)?o(this.dt,this):o.tick&&o.tick(this.dt,this)}return this[vi]=this[wi]?0:-1,this.$promise&&(this.$resolve(this),this.$promise=this.$resolve=null),this.listeners.raf&&this.add("raf"),this}[wu](){return this[wi]||(this[wi]=!0,this[vi]==-1&&(this[vi]=0),re(this[du])),this}schedule(n,i){var h,s;return i||(i=n[h=this.id]||(n[h]={value:!0})),(i[s=this.id]||(i[s]=new me({owner:this,target:n}))).update(i,!0)}unschedule(n,i={}){i||(i=n[this.id]);let h=i&&i[this.id];return h&&h.active&&h.deactivate(),this}},be=bc;(()=>{d(bc,Se,"Scheduler",16)})();var D=new be;function q(){return D.add("commit").promise}function Ee(n,i){return globalThis.setTimeout(function(){n(),q()},i)}function ve(n,i){return globalThis.setInterval(function(){n(),q()},i)}var{clearInterval:we,clearTimeout:de}=globalThis,eh=globalThis.imba||(globalThis.imba={});eh.commit=q;eh.setTimeout=Ee;eh.setInterval=ve;eh.clearInterval=we;eh.clearTimeout=de;var Te=Symbol(),$s,Zd=new($s=class{},(()=>{d($s,Te,"Env",0)})(),$s);function Ne(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var zh=Symbol.for("#idler"),gi=Symbol.for("#resolve"),Fe=Symbol(),Ec=class extends Set{constructor(){super(),this[zh]=Promise.resolve(this)}emit(n,...i){return fi(this,n,i)}on(n,...i){return rh(this,n,...i)}once(n,...i){return Sn(this,n,...i)}un(n,...i){return Ss(this,n,...i)}add(n){var i=this;if(Ne(n,Function)&&(n=n()),!this.has(n)){let h=this.size==0;super.add(n),h&&(this[zh]=this[gi]=null,this.emit("busy",this)),this.emit("add",n,this);let s=function(){return i.delete(n)};n.then(s,s)}return n}delete(n){return super.delete(n)?(this.emit("delete",n,this),this.size==0&&(this[gi]&&(this[gi](!0),this[gi]=null),this.emit("idle",this)),!0):!1}get idle(){var n=this;return this[zh]||(this[zh]=new Promise(function(i){return n.size==0?i(!0):n[gi]=i}))}get idleΦ(){return this.size==0}then(n,i){return this.idle.then(n,i)}},Le=Ec;(()=>{d(Ec,Fe,"Queue",24)})();var Jd=Symbol.for("#L");var Tu=Symbol.for("#toStringDeopt"),Nu=Symbol.for("#symbols"),Fu=Symbol.for("#batches"),Lu=Symbol.for("#extras"),Ku=Symbol.for("#stacks"),Ke=Symbol(),vc=class{constructor(n){this.dom=n,this.string=""}contains(n){return this.dom.classList.contains(n)}has(n){return this.dom.classList.contains(n)}add(n){return this.contains(n)?this:(this.string+=(this.string?" ":"")+n,this.dom.classList.add(n),this)}remove(n){if(!this.contains(n))return this;let i=new RegExp("(^|\\s)"+n+"(?=\\s|$)","g");return this.string=this.string.replace(i,""),this.dom.classList.remove(n),this}toggle(n,i){return i===void 0&&(i=!this.contains(n)),i?this.add(n):this.remove(n)}incr(n,i=0){var h=this;let s=this.stacks,t=s[n]||0;return t<1&&this.add(n),i>0&&setTimeout(function(){return h.decr(n)},i),s[n]=Math.max(t,0)+1}decr(n){let i=this.stacks,h=i[n]||0;return h==1&&this.remove(n),i[n]=Math.max(h,1)-1}reconcile(n,i){let h=this[Nu],s=this[Fu],t=!0;if(!h)h=this[Nu]=[n],s=this[Fu]=[i||""],this.toString=this.valueOf=this[Tu];else{let l=h.indexOf(n),u=i||"";l==-1?(h.push(n),s.push(u)):s[l]!=u?s[l]=u:t=!1}t&&(this[Lu]=" "+s.join(" "),this.sync())}valueOf(){return this.string}toString(){return this.string}[Tu](){return this.string+(this[Lu]||"")}sync(){return this.dom.flagSync$()}get stacks(){return this[Ku]||(this[Ku]={})}},wc=vc;(()=>{d(vc,Ke,"Flags",16)})();var Ou=Symbol.for("#__init__"),ks=Symbol.for("#getRenderContext"),Oe=Symbol.for("#getDynamicContext"),dn={context:null},ye=Symbol(),dc=class{constructor(n=null){this[Ou](n)}[Ou](n=null,i=!0,h=!0){var s;this.stack=n&&(s=n.stack)!==void 0?s:[]}push(n){return this.stack.push(n)}pop(n){return this.stack.pop()}},Ge=dc;(()=>{d(dc,ye,"Renderer",16)})();var hs=new Ge,Ce=Symbol(),_t=class extends Map{constructor(n,i=null){super(),this._=n,this.sym=i}pop(){return dn.context=null}[ks](n){let i=this.get(n);return i||this.set(n,i=new _t(this._,n)),dn.context=i}[Oe](n,i){return this[ks](n)[ks](i)}run(n){return this.value=n,dn.context==this&&(dn.context=null),this.get(n)}cache(n){return this.set(this.value,n),n}},bs=_t;(()=>{d(_t,Ce,"RenderContext",16)})();function Tc(n,i=Symbol(),h=n){return dn.context=n[i]||(n[i]=new bs(h,i))}function Nc(){let n=dn.context,i=n||new bs(null);return globalThis.DEBUG_IMBA&&!n&&hs.stack.length>0&&console.trace("detected unmemoized nodes in",hs.stack.slice(0),"see https://imba.io",i),n&&(dn.context=null),i}function yu(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function Ye(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var ai=Symbol.for("#parent"),Gu=Symbol.for("#closestNode"),Xe=Symbol.for("#parentNode"),ze=Symbol.for("#context"),Fc=Symbol.for("##inited"),ps=Symbol.for("#getRenderContext"),Qe=Symbol.for("#getDynamicContext"),Cu=Symbol.for("#insertChild"),Qt=Symbol.for("#appendChild"),as=Symbol.for("#replaceChild"),Yu=Symbol.for("#removeChild"),Mn=Symbol.for("#insertInto"),Xu=Symbol.for("#insertIntoDeopt"),Pi=Symbol.for("#removeFrom"),zu=Symbol.for("#removeFromDeopt"),di=Symbol.for("#replaceWith"),Qu=Symbol.for("#replaceWithDeopt"),nt=Symbol.for("#placeholderNode"),He=Symbol.for("#attachToParent"),Ze=Symbol.for("#detachFromParent"),Hu=Symbol.for("#placeChild"),Je=Symbol.for("#beforeReconcile"),We=Symbol.for("#afterReconcile"),Be=Symbol.for("#afterVisit"),Me=Symbol.for("#visitContext"),Lc=Symbol.for("#__init__"),Kc=Symbol.for("##parent"),it=Symbol.for("##up"),Zu=Symbol.for("##context"),ti=Symbol.for("#domNode"),Qh=Symbol.for("##placeholderNode"),Ju=Symbol.for("#forNode"),Wu=Symbol.for("#domDeopt"),Hh=Symbol.for("##visitContext"),Re=Symbol.for("#isRichElement"),Bu=Symbol.for("#src"),Dh=Symbol.for("#htmlNodeName"),Ue=Symbol.for("#getSlot"),Wd=Symbol.for("#ImbaElement"),Mu=Symbol.for("#cssns"),qe=Symbol.for("#cssid"),Oc=window.Event,Bd=window.UIEvent,Md=window.FocusEvent,ge=window.MouseEvent,Pe=window.PointerEvent,Ve=window.KeyboardEvent,Qn=window.CustomEvent,yc=window.Node,Ru=window.Comment,je=window.Text,a=window.Element,Rd=window.HTMLElement,Ud=window.HTMLHtmlElement,Ae=window.HTMLSelectElement,xe=window.HTMLInputElement,De=window.HTMLTextAreaElement,Ie=window.HTMLButtonElement,_e=window.HTMLOptionElement,qd=window.HTMLScriptElement,gd=window.SVGElement,Pd=window.DocumentFragment,Vd=window.ShadowRoot,$e=window.Document,jd=window.Window,Ad=window.customElements,Uu={};function Gc(n,i,h){if(!n)return h[i]=null;if(h[i]!==void 0)return h[i];let s=Object.getOwnPropertyDescriptor(n,i);return s!==void 0||n==SVGElement?h[i]=s||null:Gc(Reflect.getPrototypeOf(n),i,h)}var Ht={},Zt={},ke={},pe={};function ht(){return globalThis.document}var ae={get(n,i){let h=n,s;for(;h&&s==null;)(h=h[ai])&&(s=h[i]);return s},set(n,i,h){let s=n,t;for(;s&&t==null;){if(Dt(s,i,Element))return s[i]=h,!0;s=s[ai]}return!0}},n1=Symbol(),i1=class{get flags(){return this.documentElement.flags}emit(...n){return this.documentElement.emit(...n)}};(()=>{d(i1,n1,"Document",1,Document)})();Node.prototype[Lc]=function(){return this};var h1=Symbol(),s1=class{get[ai](){return this[Kc]||this.parentNode||this[it]}get[Gu](){return this}get[Xe](){var n;return(n=this[ai])==null?void 0:n[Gu]}get[ze](){return this[Zu]||(this[Zu]=new Proxy(this,ae))}[Fc](){return this}[ps](n){return Tc(this,n)}[Qe](n,i){return this[ps](n)[ps](i)}[Cu](n,i){return n[Mn](this,i)}[Qt](n){return n[Mn](this,null)}[as](n,i){let h=this[Cu](n,i);return this[Yu](i),h}[Yu](n){return n[Pi](this)}[Mn](n,i=null){return i?n.insertBefore(this,i):n.appendChild(this),this}[Xu](n,i){return i?n.insertBefore(this[ti]||this,i):n.appendChild(this[ti]||this),this}[Pi](n){return n.removeChild(this)}[zu](n){return n.removeChild(this[ti]||this)}[di](n,i){return i[as](n,this)}[Qu](n,i){return i[as](n,this[ti]||this)}get[nt](){let n;return this[Qh]||(this[Qh]=(n=globalThis.document.createComment("placeholder"),n[Ju]=this,n))}set[nt](n){let i=this[Qh];this[Qh]=n,n[Ju]=this,i&&i!=n&&i.parentNode&&i[di](n)}[He](){let n=this[ti],i=n&&n.parentNode;return n&&i&&n!=this&&(this[ti]=null,this[Mn](i,n),n[Pi](i)),this}[Ze](){this[Wu]!=!0&&(this[Wu]=!0,!0)&&(this[di]=this[Qu],this[Pi]=this[zu],this[Mn]=this[Xu],this[it]||(this[it]=this[ai]));let n=this[nt];return this.parentNode&&n!=this&&(n[Mn](this.parentNode,this),this[Pi](this.parentNode)),this[ti]=n,this}[Hu](n,i,h){let s=typeof n;if(s==="undefined"||n===null){if(h&&yu(h,Comment))return h;let t=globalThis.document.createComment("");return h?h[di](t,this):t[Mn](this,null)}if(n===h)return n;if(s!=="object"){let t,l=n;return h?yu(h,Text)?(h.textContent=l,h):(t=globalThis.document.createTextNode(l),h[di](t,this),t):(this.appendChild(t=globalThis.document.createTextNode(l)),t)}else return n[Mn]?h?h[di](n,this):n[Mn](this,null):this[Hu](String(n),i,h)}};(()=>{d(s1,h1,"Node",1,Node)})();var t1=Symbol(),l1=class{log(...n){return console.log(...n)}get hiddenΦ(){var n,i;let h=globalThis.getComputedStyle(this);return h.display=="none"||h.visibility=="hidden"?!0:this.offsetParent||this===globalThis.document.body?!1:(i=(n=this.parentElement)==null?void 0:n.hiddenΦ)!=null?i:!0}get detachedΦ(){return!globalThis.document.documentElement.contains(this)}get unobstructedΦ(){let n=this.getBoundingClientRect(),i=window.visualViewport,h=n.left+n.width*0.5,s=n.top+n.height*0.5;if(i.width>h&&h>0&&i.height>s&&s>0){let t=globalThis.document.elementFromPoint(h,s);return!!(t&&(t.contains(this)||this.contains(t)))}return!1}get focusΦ(){return globalThis.document.activeElement==this}get focinΦ(){return this.contains(globalThis.document.activeElement)}emit(n,i,h={}){var s,t,l;i!=null&&((s=h.detail)!=null||(h.detail=i)),(t=h.bubbles)!=null||(h.bubbles=!0),(l=h.cancelable)!=null||(h.cancelable=!0);let u=new CustomEvent(n,h);h.original&&(u.originalEvent=h.original);let o=this.dispatchEvent(u);return u}text$(n){return this.textContent=n,this}[Je](){return this}[We](){return this}[Be](){this[Hh]&&(this[Hh]=null)}get[Me](){return this[Hh]||(this[Hh]={})}get flags(){return this.$flags||(this.$flags=new wc(this),this.flag$==Element.prototype.flag$&&(this.flags$ext=this.className),this.flagDeopt$()),this.$flags}flag$(n){let i=this.flags$ns;this.className=i?i+(this.flags$ext=n):this.flags$ext=n}flagDeopt$(){var n=this;this.flag$=this.flagExt$,this.flagSelf$=function(i){return n.flagSync$(n.flags$own=i)}}flagExt$(n){return this.flagSync$(this.flags$ext=n)}flagSelf$(n){return this.flagDeopt$(),this.flagSelf$(n)}flagSync$(){return this.className=(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||"")}set$(n,i){let h=Dt(this,n,Element);!h||!h.set?this.setAttribute(n,i):this[n]=i}get richValue(){return this.value}set richValue(n){this.value=n}};(()=>{d(l1,t1,"Element",1,Element)})();Element.prototype.setns$=Element.prototype.setAttributeNS;Element.prototype[Re]=!0;function J(n,i,h,s){let t=globalThis.document.createElement(n);return h&&(t.className=h),s!==null&&t.text$(s),i&&i[Qt]&&i[Qt](t),t}var u1=Symbol(),o1=class{set$(n,i){var h;let s=Uu[h=this.nodeName]||(Uu[h]={}),t=Gc(this,n,s);!t||!t.set?this.setAttribute(n,i):this[n]=i}flag$(n){let i=this.flags$ns;this.setAttribute("class",i?i+(this.flags$ext=n):this.flags$ext=n)}flagSelf$(n){var i=this;return this.flag$=function(h){return i.flagSync$(i.flags$ext=h)},this.flagSelf$=function(h){return i.flagSync$(i.flags$own=h)},this.flagSelf$(n)}flagSync$(){return this.setAttribute("class",(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||""))}};(()=>{d(o1,u1,"SVGElement",1,SVGElement)})();var c1=Symbol(),f1=class{set src(n){if(this[Bu]!=n&&(this[Bu]=n,!0)){if(n&&n.adoptNode)n.adoptNode(this);else if(n&&n.type=="svg"){if(n.attributes)for(let i=n.attributes,h=0,s=Object.keys(i),t=s.length,l,u;h<t;h++)l=s[h],u=i[l],this.setAttribute(l,u);this.innerHTML=n.content}}}};(()=>{d(f1,c1,"SVGSVGElement",1,SVGSVGElement)})();function ss(n){return globalThis.document.createComment(n)}function qu(n){return globalThis.document.createTextNode(n)}var ts=globalThis.navigator,r1=ts&&ts.vendor||"",gu=ts&&ts.userAgent||"",e1=r1.indexOf("Apple")>-1||gu.indexOf("CriOS")>=0||gu.indexOf("FxiOS")>=0,ls=!e1,Pu=new Map,m1=Symbol(),Cc=class extends HTMLElement{connectedCallback(){return ls?this.parentNode.removeChild(this):this.parentNode.connectedCallback()}disconnectedCallback(){if(!ls)return this.parentNode.disconnectedCallback()}},S1=Cc;(()=>{d(Cc,m1,"CustomHook",0)})();window.customElements.define("i-hook",S1);function b1(n,i){let h=Pu.get(i);if(!h){h={};let s=i.prototype,t=[s];for(;(s=s&&Object.getPrototypeOf(s))&&s.constructor!=n.constructor;)t.unshift(s);for(let l=0,u=Ye(t),o=u.length;l<o;l++){let c=u[l],f=Object.getOwnPropertyDescriptors(c);Object.assign(h,f)}Pu.set(i,h)}return h}function kn(n,i,h,s,t){let l;typeof n!="string"&&n&&n.nodeName&&(n=n.nodeName);let u=Zt[n]||n;if(Ht[n]){let o=Ht[n],c=o.prototype[Dh];if(c&&ls)l=globalThis.document.createElement(c,{is:u});else if(o.create$&&c){l=globalThis.document.createElement(c),l.setAttribute("is",u);let f=b1(l,o);Object.defineProperties(l,f),l.__slots={},l.appendChild(globalThis.document.createElement("i-hook"))}else o.create$?(l=o.create$(l),l.__slots={}):console.warn("could not create tag "+n)}else l=globalThis.document.createElement(Zt[n]||n);return l[Kc]=i,l[Lc](),l[Fc](),s!==null&&l[Ue]("__").text$(s),(h||l.flags$ns)&&l.flag$(h||""),l}function pn(n,i,h={}){ke[n]=pe[n]=i,i.nodeName=n;let s=n,t=i.prototype;if(n.indexOf("-")==-1&&(s=""+n+"-tag",Zt[n]=s),h.cssns){let l=(t._ns_||t[Mu]||"")+" "+(h.cssns||"");t._ns_=l.trim()+" ",t[Mu]=h.cssns}if(h.cssid){let l=(t.flags$ns||"")+" "+h.cssid;t[qe]=h.cssid,t.flags$ns=l.trim()+" "}return t[Dh]&&!h.extends&&(h.extends=t[Dh]),h.extends?(t[Dh]=h.extends,Ht[n]=i,ls&&window.customElements.define(s,i,{extends:h.extends})):window.customElements.define(s,i),i}var E1=globalThis.imba||(globalThis.imba={});E1.document=globalThis.document;function Vi(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function st(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var Ih=Symbol.for("#parent"),Vu=Symbol.for("#closestNode"),v1=Symbol.for("#isRichElement"),w1=Symbol.for("#afterVisit"),d1=Symbol.for("#getRenderContext"),ju=Symbol.for("#appendChild"),Au=Symbol.for("#removeChild"),xu=Symbol.for("#replaceChild"),Rn=Symbol.for("#insertInto"),Zh=Symbol.for("#replaceWith"),Du=Symbol.for("#insertChild"),Jh=Symbol.for("#removeFrom"),Iu=Symbol.for("#placeChild"),T1=Symbol.for("#registerFunctionalSlot"),N1=Symbol.for("#getFunctionalSlot"),_u=Symbol.for("#getSlot"),Jt=Symbol.for("##parent"),ui=Symbol.for("##up"),$u=Symbol.for("##flags"),F1=Symbol.for("#domFlags"),rn=Symbol.for("#end"),ku=Symbol.for("#textContent"),Wh=Symbol.for("#textNode"),tt=Symbol.for("#functionalSlots");var L1=Symbol(),Yc=class{constructor(){this.childNodes=[]}log(...n){}hasChildNodes(){return!1}set[Ih](n){this[Jt]=n}get[Ih](){return this[Jt]||this[ui]}get[Vu](){return this[Ih][Vu]}get[v1](){return!0}get flags(){return this[$u]||(this[$u]=new wc(this))}flagSync$(){return this}[w1](){return this}[d1](n){return Tc(this,n)}},us=Yc;(()=>{d(Yc,L1,"Fragment",16)})();var K1=0,O1=Symbol(),Xc=class extends us{constructor(n,i){super(...arguments),this[ui]=i,this.parentNode=null,this[F1]=n,this.childNodes=[],this[rn]=ss("slot"+K1++),i&&i[ju](this)}get[Ih](){return this[Jt]||this.parentNode||this[ui]}set textContent(n){this[ku]=n}get textContent(){return this[ku]}hasChildNodes(){for(let n=0,i=st(this.childNodes),h=i.length;n<h;n++){let s=i[n];if(Vi(s,us)&&s.hasChildNodes())return!0;if(!Vi(s,Ru)){if(Vi(s,yc))return!0}}return!1}text$(n){return this[Wh]?this[Wh].textContent=n:this[Wh]=this[Iu](n),this[Wh]}appendChild(n){return this.parentNode&&n[Rn](this.parentNode,this[rn]),this.childNodes.push(n)}[ju](n){var i;return this.parentNode?n[Rn](this.parentNode,this[rn]):(i=n[ui])!=null||(n[ui]=this[ui]||this),this.childNodes.push(n)}insertBefore(n,i){this.parentNode&&this.parentNode[Du](n,i);let h=this.childNodes.indexOf(i);return h>=0&&this.childNodes.splice(h,0,n),n}[Au](n){this.parentNode&&this.parentNode[Au](n);let i=this.childNodes.indexOf(n);i>=0&&this.childNodes.splice(i,1)}[xu](n,i){this.parentNode&&this.parentNode[xu](n,i);let h=this.childNodes.indexOf(i);return this.childNodes[h]=n,n}[Rn](n,i){let h=this.parentNode;if(this.parentNode!=n&&(this.parentNode=n,!0)){this[rn]&&(i=this[rn][Rn](n,i));for(let s=0,t=st(this.childNodes),l=t.length;s<l;s++)t[s][Rn](n,i)}return this}[Zh](n,i){let h=n[Rn](i,this[rn]);return this[Jh](i),h}[Du](n,i){if(this.parentNode&&this.insertBefore(n,i||this[rn]),i){let h=this.childNodes.indexOf(i);h>=0&&this.childNodes.splice(h,0,n)}else this.childNodes.push(n);return n}[Jh](n){for(let i=0,h=st(this.childNodes),s=h.length;i<s;i++)h[i][Jh](n);return this[rn]&&this[rn][Jh](n),this.parentNode=null,this}[Iu](n,i,h){let s=this.parentNode,t=typeof n;if(t==="undefined"||n===null){if(h&&Vi(h,Ru))return h;let l=ss("");if(h){let u=this.childNodes.indexOf(h);return this.childNodes.splice(u,1,l),s&&h[Zh](l,s),l}return this.childNodes.push(l),s&&l[Rn](s,this[rn]),l}if(n===h)return n;if(t!=="object"){let l,u=n;if(h){if(Vi(h,je))return h.textContent=u,h;{l=qu(u);let o=this.childNodes.indexOf(h);return this.childNodes.splice(o,1,l),s&&h[Zh](l,s),l}}else return this.childNodes.push(l=qu(u)),s&&l[Rn](s,this[rn]),l}else if(h){let l=this.childNodes.indexOf(h);return this.childNodes.splice(l,1,n),s&&h[Zh](n,s),n}else return this.childNodes.push(n),s&&n[Rn](s,this[rn]),n}},y1=Xc;(()=>{d(Xc,O1,"VirtualFragment",16)})();function Wt(n,i){let h=new y1(n,null);return h[ui]=i,h}var G1=Symbol(),C1=class{[T1](n){let i=this[tt]||(this[tt]={});return i[n]||(i[n]=Wt(0,this))}[N1](n,i){let h=this[tt];return h&&h[n]||this[_u](n,i)}[_u](n,i){var h;return n=="__"&&!this.render||!this.__slots?this:(h=this.__slots)[n]||(h[n]=Wt(0,this))}};(()=>{d(C1,G1,"Node",1,yc)})();function Y1(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var X1=Symbol.for("#afterVisit"),Bh=Symbol.for("#insertInto"),pu=Symbol.for("#appendChild"),z1=Symbol.for("#replaceWith"),lt=Symbol.for("#removeFrom"),Q1=Symbol.for("#domFlags"),H1=Symbol.for("##parent"),jn=Symbol.for("#end"),Z1=Symbol.for("#removeChild"),J1=Symbol.for("#insertChild"),W1=Symbol(),zc=class extends us{constructor(n,i){super(...arguments),this[Q1]=n,this[H1]=i,n&256||(this[jn]=ss("list")),this.$=this.childNodes,this.length=0,i&&i[pu](this)}hasChildNodes(){return this.length!=0}[X1](n){let i=this.length;if(this.length=n,i==n)return;let h=this.parentNode;if(!h)return;let s=this.childNodes,t=this[jn];if(i>n)for(;i>n;)h[Z1](s[--i]);else if(n>i)for(;n>i;)h[J1](s[i++],t);this.length=n}[Bh](n,i){this.parentNode=n,this[jn]&&this[jn][Bh](n,i),i=this[jn];for(let h=0,s=Y1(this.childNodes),t=s.length;h<t;h++){let l=s[h];if(h==this.length)break;l[Bh](n,i)}return this}[pu](n){}[z1](n,i){let h=n[Bh](i,this[jn]);return this[lt](i),h}[lt](n){let i=this.length;for(;i>0;)this.childNodes[--i][lt](n);this[jn]&&n.removeChild(this[jn]),this.parentNode=null}},B1=zc;(()=>{d(zc,W1,"IndexedTagFragment",16)})();function Qc(n,i){return new B1(n,i)}function au(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var ut=Symbol.for("#appendChild"),Mh=Symbol.for("#insertChild"),M1=Symbol.for("#replaceWith"),Rh=Symbol.for("#insertInto"),ot=Symbol.for("#removeFrom"),R1=Symbol.for("#afterVisit"),Uh=Symbol.for("#domFlags"),no=Symbol.for("##parent"),An=Symbol.for("#end"),io=Symbol.for("#removeChild"),U1=Symbol(),q1=class extends us{constructor(n,i){super(...arguments),this[Uh]=n,this[no]=i,this.changes=new Map,this.dirty=!1,this.array=this.childNodes,this.$=new bs(this,Symbol()),n&256||(this[An]=ss("map")),i&&i[ut](this)}[ut](n){if(this.parentNode)return this.parentNode[Mh](n,this[An])}hasChildNodes(){return this.childNodes.length!=0}push(n,i){if(!(this[Uh]&1)){this.array.push(n),this[ut](n);return}let h=this.array[i];if(h!==n){this.dirty=!0;let s=this.array.indexOf(n),t=this.changes.get(n);s===-1?(this.array.splice(i,0,n),this.insertChild(n,i,s)):s===i+1?(h&&this.changes.set(h,-1),this.array.splice(i,1)):(s>=0&&this.array.splice(s,1),this.array.splice(i,0,n),this.moveChild(n,i,s)),t==-1&&this.changes.delete(n)}}insertChild(n,i,h){let s=this.parentNode;if(s)if(i>0){let t=this.array[i-1];s[Mh](n,t.nextSibling)}else s[Mh](n,this.childNodes[i+1]||this[An])}moveChild(n,i,h){return this.insertChild(n,i,h)}removeChild(n,i){n.parentNode&&n[ot](n.parentNode)}[Mh](n,i){}[M1](n,i){let h=n[Rh](i,this[An]);return this[ot](i),h}[Rh](n,i){this[no]=n;let h=this.parentNode;if(n!=h){this.parentNode=n;for(let s=0,t=au(this.array),l=t.length;s<l;s++)t[s][Rh](n,i);this[An]&&this[An][Rh](n,i)}return this}[ot](n){for(let i=0,h=au(this.array),s=h.length;i<s;i++){let t=h[i];n[io](t)}return this[An]&&n[io](this[An]),this.parentNode=null}[R1](n){var i=this;if(!(this[Uh]&1)){this[Uh]|=1;return}if(this.dirty&&(this.changes.forEach(function(h,s){if(h==-1)return i.removeChild(s)}),this.changes.clear(),this.dirty=!1),this.array.length>n)for(;this.array.length>n;){let h=this.array.pop();this.removeChild(h)}}};(()=>{d(q1,U1,"KeyedTagFragment",16)})();function ho(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var os=Symbol.for("#__init__"),g1=Symbol.for("##inited"),P1=Symbol.for("#afterVisit"),V1=Symbol.for("#beforeReconcile"),j1=Symbol.for("#afterReconcile"),so=Symbol.for("#__hooks__"),Ti=Symbol.for("#autorender"),qh=Symbol.for("##visitContext"),A1=Symbol(),ct,x1=new(ct=class{constructor(n=null){this[os](n)}[os](n=null,i=!0,h=!0){var s;this.items=n&&(s=n.items)!==void 0?s:[],this.current=n&&(s=n.current)!==void 0?s:null,this.lastQueued=n&&(s=n.lastQueued)!==void 0?s:null,this.tests=n&&(s=n.tests)!==void 0?s:0}flush(){let n=null;for(;n=this.items.shift();){if(!n.parentNode||n.hydratedΦ)continue;let i=this.current;this.current=n,n.__F|=1024,n.connectedCallback(),this.current=i}}queue(n){var i=this;let h=this.items.length,s=0,t=this.lastQueued;this.lastQueued=n;let{DOCUMENT_POSITION_PRECEDING:l,DOCUMENT_POSITION_FOLLOWING:u}=Node;if(h){let o=this.items.indexOf(t),c=o,f=function(e,S){return i.tests++,e.compareDocumentPosition(S)};(o==-1||t.nodeName!=n.nodeName)&&(c=o=0);let r=this.items[c];for(;r&&f(r,n)&u;)r=this.items[++c];if(c!=o)r?this.items.splice(c,0,n):this.items.push(n);else{for(;r&&f(r,n)&l;)r=this.items[--c];c!=o&&(r?this.items.splice(c+1,0,n):this.items.unshift(n))}}else this.items.push(n),this.current||globalThis.queueMicrotask(this.flush.bind(this))}},(()=>{d(ct,A1,null,16)})(),ct);var D1=Symbol(),Hc=class extends HTMLElement{constructor(){super(),this.flags$ns&&(this.flag$=this.flagExt$),this.setup$(),this.build()}setup$(){return this.__slots={},this.__F=0}[os](){return this.__F|=3,this}[g1](){if(this[so])return this[so].inited(this)}flag$(n){this.className=this.flags$ext=n}build(){return this}awaken(){return this}mount(){return this}unmount(){return this}rendered(){return this}dehydrate(){return this}hydrate(){return this.autoschedule=!0,this}tick(n,i){return this.commit()}visit(){return this.commit()}commit(){return this.renderΦ?(this.__F|=256,this.render&&this.render(),this.rendered(),this.__F=(this.__F|512)&-257&-8193):(this.__F|=8192,this)}get autoschedule(){return(this.__F&64)!=0}set autoschedule(n){n?this.__F|=64:this.__F&=-65}set autorender(n){let i=this[Ti]||(this[Ti]={});i.value=n,this.mountedΦ&&D.schedule(this,i)}get renderΦ(){return!this.suspendedΦ}get mountingΦ(){return(this.__F&16)!=0}get mountedΦ(){return(this.__F&32)!=0}get awakenedΦ(){return(this.__F&8)!=0}get renderedΦ(){return(this.__F&512)!=0}get suspendedΦ(){return(this.__F&4096)!=0}get renderingΦ(){return(this.__F&256)!=0}get scheduledΦ(){return(this.__F&128)!=0}get hydratedΦ(){return(this.__F&2)!=0}get ssrΦ(){return(this.__F&1024)!=0}get scheduler(){return D}schedule(){return D.on("commit",this),this.__F|=128,this}unschedule(){return D.un("commit",this),this.__F&=-129,this}async suspend(n=null){let i=this.flags.incr("@suspended");return this.__F|=4096,ho(n,Function)&&(await n(),this.unsuspend()),this}unsuspend(){return this.flags.decr("@suspended")==0&&(this.__F&=-4097,this.commit()),this}[P1](){if(this.visit(),this[qh])return this[qh]=null}[V1](){return this.__F&1024&&(this.__F=this.__F&-1025,this.classList.remove("_ssr_"),this.flags$ext&&this.flags$ext.indexOf("_ssr_")==0&&(this.flags$ext=this.flags$ext.slice(5)),this.__F&512||(this.innerHTML="")),globalThis.DEBUG_IMBA&&hs.push(this),this[qh]&&(this[qh]=null),this}[j1](){return globalThis.DEBUG_IMBA&&hs.pop(this),this}connectedCallback(){let n=this.__F,i=n&1,h=n&8;if(!i&&!(n&1024)){x1.queue(this);return}if(n&48)return;this.__F|=16,i||this[os](),n&2||(this.flags$ext=this.className,this.__F|=2,this.hydrate(),this.commit()),h||(this.awaken(),this.__F|=8),fi(this,"mount",[this]);let s=this.mount();return s&&ho(s.then,Function)&&s.then(D.commit),n=this.__F=(this.__F|32)&-17,n&64&&this.schedule(),this[Ti]&&D.schedule(this,this[Ti]),this}disconnectedCallback(){if(this.__F=this.__F&-49,this.__F&128&&this.unschedule(),fi(this,"unmount",[this]),this.unmount(),this[Ti])return D.unschedule(this,this[Ti])}},Zn=Hc;(()=>{d(Hc,D1,"Component",16)})();function I1(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var to=Symbol.for("#__init__"),_1={cm:1,mm:1,Q:1,pc:1,pt:1,px:1,em:1,ex:1,ch:1,rem:1,vw:1,vh:1,vmin:1,vmax:1,s:1,ms:1,fr:1,"%":1,in:1,turn:1,grad:1,rad:1,deg:1,Hz:1,kHz:1},lo={prefix:1,suffix:1,content:1},$t={rose:[[356,100,97],[356,100,95],[353,96,90],[353,96,82],[351,95,71],[350,89,60],[347,77,50],[345,83,41],[343,80,35],[342,75,30]],pink:[[327,73,97],[326,78,95],[326,85,90],[327,87,82],[329,86,70],[330,81,60],[333,71,51],[335,78,42],[336,74,35],[336,69,30]],fuchsia:[[289,100,98],[287,100,95],[288,96,91],[291,93,83],[292,91,73],[292,84,61],[293,69,49],[295,72,40],[295,70,33],[297,64,28]],purple:[[270,100,98],[269,100,95],[269,100,92],[269,97,85],[270,95,75],[271,91,65],[271,81,56],[272,72,47],[273,67,39],[274,66,32]],violet:[[250,100,98],[251,91,95],[251,95,92],[252,95,85],[255,92,76],[258,90,66],[262,83,58],[263,70,50],[263,69,42],[264,67,35]],indigo:[[226,100,97],[226,100,94],[228,96,89],[230,94,82],[234,89,74],[239,84,67],[243,75,59],[245,58,51],[244,55,41],[242,47,34]],blue:[[214,100,97],[214,95,93],[213,97,87],[212,96,78],[213,94,68],[217,91,60],[221,83,53],[224,76,48],[226,71,40],[224,64,33]],sky:[[204,100,97],[204,94,94],[201,94,86],[199,95,74],[198,93,60],[199,89,48],[200,98,39],[201,96,32],[201,90,27],[202,80,24]],cyan:[[183,100,96],[185,96,90],[186,94,82],[187,92,69],[188,86,53],[189,94,43],[192,91,36],[193,82,31],[194,70,27],[196,64,24]],teal:[[166,76,97],[167,85,89],[168,84,78],[171,77,64],[172,66,50],[173,80,40],[175,84,32],[175,77,26],[176,69,22],[176,61,19]],emerald:[[152,81,96],[149,80,90],[152,76,80],[156,72,67],[158,64,52],[160,84,39],[161,94,30],[163,94,24],[163,88,20],[164,86,16]],green:[[138,76,97],[141,84,93],[141,79,85],[142,77,73],[142,69,58],[142,71,45],[142,76,36],[142,72,29],[143,64,24],[144,61,20]],lime:[[78,92,95],[80,89,89],[81,88,80],[82,85,67],[83,78,55],[84,81,44],[85,85,35],[86,78,27],[86,69,23],[88,61,20]],yellow:[[55,92,95],[55,97,88],[53,98,77],[50,98,64],[48,96,53],[45,93,47],[41,96,40],[35,92,33],[32,81,29],[28,73,26]],amber:[[48,100,96],[48,96,89],[48,97,77],[46,97,65],[43,96,56],[38,92,50],[32,95,44],[26,90,37],[23,83,31],[22,78,26]],orange:[[33,100,96],[34,100,92],[32,98,83],[31,97,72],[27,96,61],[25,95,53],[21,90,48],[17,88,40],[15,79,34],[15,75,28]],red:[[0,86,97],[0,93,94],[0,96,89],[0,94,82],[0,91,71],[0,84,60],[0,72,51],[0,74,42],[0,70,35],[0,63,31]],warmer:[[60,9,98],[60,5,96],[20,6,90],[24,6,83],[24,5,64],[25,5,45],[33,5,32],[30,6,25],[12,6,15],[24,10,10]],warm:[[0,0,98],[0,0,96],[0,0,90],[0,0,83],[0,0,64],[0,0,45],[0,0,32],[0,0,25],[0,0,15],[0,0,9]],gray:[[0,0,98],[240,5,96],[240,6,90],[240,5,84],[240,5,65],[240,4,46],[240,5,34],[240,5,26],[240,4,16],[240,6,10]],cool:[[210,20,98],[220,14,96],[220,13,91],[216,12,84],[218,11,65],[220,9,46],[215,14,34],[217,19,27],[215,28,17],[221,39,11]],cooler:[[210,40,98],[210,40,96],[214,32,91],[213,27,84],[215,20,65],[215,16,47],[215,19,35],[215,25,27],[217,33,17],[222,47,11]]},$1=new RegExp("^("+Object.keys($t).join("|")+")(\\d+(?:\\.\\d+)?)$"),k1=/^([xyz])$/,p1=/^([tlbr]|size|[whtlbr]|[mps][tlbrxy]?|[rcxy]?[gs])$/,a1=`*,::before,::after {
box-sizing: border-box;
border-width: 0;
border-style: solid;
border-color: currentColor;
}`,nm=Symbol(),Zc=class{constructor(n=null){this[to](n)}[to](n=null,i=!0,h=!0){var s;this.entries=n&&(s=n.entries)!==void 0?s:{}}register(n,i){let h=this.entries[n];h?h&&(h.css=i,h.node&&(h.node.textContent=i)):(h=this.entries[n]={sourceId:n,css:i},this.entries.resets||this.register("resets",a1),h.node=globalThis.document.createElement("style"),h.node.setAttribute("data-id",n),h.node.textContent=h.css,globalThis.document.head.appendChild(h.node))}toString(){return Object.values(this.entries).map(function(n){return n.css}).join(`

`)}toValue(n,i,h,s=null){let t;lo[h]&&(n=String(n));let l=typeof n;if(l=="number"){if(i||(k1.test(h)?i="px":p1.test(h)?i="u":h=="rotate"&&(i="turn",n=(n%1).toFixed(4))),i)return _1[i]?n+i:i=="u"?n*4+"px":"calc(var(--u_"+i+",1px) * "+n+")"}else if(l=="string"){if(h&&lo[h]&&n[0]!='"'&&n[0]!="'"&&(n.indexOf('"')>=0?n.indexOf("'")==-1&&(n="'"+n+"'"):n='"'+n+'"'),t=n.match($1)){let u=$t[t[1]][parseInt(t[2])],o="100%";if(typeof s=="number"?o=s+"%":typeof s=="string"&&(o=s),u)return"hsla("+u[0]+","+u[1]+"%,"+u[2]+"%,"+o+")"}}else if(n&&I1(n.toStyleString,Function))return n.toStyleString();return n}parseDimension(n){if(typeof n=="string"){let[i,h,s]=n.match(/^([-+]?[\d\.]+)(%|\w+)$/);return[parseFloat(h),s]}else if(typeof n=="number")return[n]}},im=Zc;(()=>{d(Zc,nm,"Styles",16)})();var Tn=new im,xd=Object.keys($t);var hm=Symbol(),sm=class{css$(n,i,h){return this.style[n]=i}css$var(n,i,h,s,t=null){let l=Tn.toValue(i,h,s,t);this.style.setProperty(n,l)}};(()=>{d(sm,hm,"Element",1,a)})();function tm(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var uo=Symbol.for("#insertInto"),oo=Symbol.for("#removeFrom");function kt(n,i,h={}){let s=i||globalThis.document.body,t=n;if(tm(n,Function)){let l=n,u=h.tick||(h.tick=function(){let o=h.context||(h.context=new bs(s,null)),c=dn.context;dn.context=o;let f=n(o,h);return dn.context==o&&(dn.context=c),h.node!=f&&(h.node&&globalThis.imba.unmount(h.node),f?((h.node=f)[uo](s),f.tick==Zn.prototype.tick&&(f.tick=h.tick,f.scheduledΦ),Sn(f,"unmount",function(){if(h.node==f)return h.node=null,D.unlisten("commit",h.tick)})):(h.node=f,D.unlisten("commit",h.tick))),f});return D.listen("commit",u),u()}else t.__F|=64;return t[uo](s),t}function lm(n){return n&&n[oo]&&n.parentNode&&n[oo](n.parentNode),n}var Jc=globalThis.imba||(globalThis.imba={});Jc.mount=kt;Jc.unmount=lm;function Xn(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function ji(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var nh=Symbol.for("##onchange"),oh=Symbol.for("#afterVisit"),ih=Symbol.for("##oninput"),_h=Symbol.for("##onclick"),ch=Symbol.for("##bound"),_n=Symbol.for("##visitContext");function Es(){return globalThis.imba.uses_dom_bind=!0,!0}var um={INPUT:!0,SELECT:!0,TEXTAREA:!0,BUTTON:!0},Bt=function(n){return Xn(n,Array)||n&&Xn(n.has,Function)},pt=function(n,i){return n==i?!0:Xn(n,Array)?n.indexOf(i)>=0:n&&Xn(n.has,Function)?n.has(i):n&&Xn(n.contains,Function)?n.contains(i):!1},at=function(n,i){if(Xn(n,Array))return n.push(i);if(n&&Xn(n.add,Function))return n.add(i)},nl=function(n,i){if(Xn(n,Array)){let h=n.indexOf(i);if(h>=0)return n.splice(h,1)}else if(n&&Xn(n.delete,Function))return n.delete(i)};function om(n){function i(){return n[0]?n[0][n[1]]:void 0}function h(s){return n[0]?n[0][n[1]]=s:null}return{get:i,set:h}}var cm=Symbol(),fm=class{getRichValue(){return this.value}setRichValue(n){return this.value=n}bind$(n,i){let h=i||[];return n=="data"&&!this[ch]&&um[this.nodeName]&&(this[ch]=!0,this[nh]&&this.addEventListener("change",this[nh]=this[nh].bind(this)),this[ih]&&this.addEventListener("input",this[ih]=this[ih].bind(this),{capture:!0}),this[_h]&&this.addEventListener("click",this[_h]=this[_h].bind(this),{capture:!0})),Object.defineProperty(this,n,Xn(h,Array)?om(h):h),h}};(()=>{d(fm,cm,"Element",1,a)})();Object.defineProperty(a.prototype,"richValue",{get:function(){return this.getRichValue()},set:function(n){return this.setRichValue(n)}});var rm=Symbol(),em=class{[nh](n){let i=this.data,h=this.$$value;this.$$value=void 0;let s=this.getRichValue();if(this.multiple){if(h)for(let t=0,l=ji(h),u=l.length;t<u;t++){let o=l[t];s.indexOf(o)==-1&&nl(i,o)}for(let t=0,l=ji(s),u=l.length;t<u;t++){let o=l[t];(!h||h.indexOf(o)==-1)&&at(i,o)}}else this.data=s[0];return q(),this}getRichValue(){var n;if(this.$$value)return this.$$value;n=[];for(let i=0,h=ji(this.selectedOptions),s=h.length;i<s;i++){let t=h[i];n.push(t.richValue)}return this.$$value=n}syncValue(){let n=this.data;if(this.multiple){let i=[];for(let h=0,s=ji(this.options),t=s.length;h<t;h++){let l=s[h],u=l.richValue,o=pt(n,u);l.selected=o,o&&i.push(u)}this.$$value=i}else for(let i=0,h=ji(this.options),s=h.length;i<s;i++){let t=h[i].richValue;if(t==n){this.$$value=[t],this.selectedIndex=i;break}}}[oh](){if(this.syncValue(),this[_n])return this[_n]=null}};(()=>{d(em,rm,"HTMLSelectElement",1,Ae)})();var mm=Symbol(),Sm=class{setRichValue(n){return this.$$value=n,this.value=n}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}};(()=>{d(Sm,mm,"HTMLOptionElement",1,_e)})();var bm=Symbol(),Em=class{setRichValue(n){return this.$$value=n,this.value=n}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}[ih](n){return this.data=this.value,q()}[oh](){let n=this.data;if(n==null&&(n=""),this[ch]&&this.value!=n&&(this.value=n),this[_n])return this[_n]=null}};(()=>{d(Em,bm,"HTMLTextAreaElement",1,De)})();var vm=Symbol(),wm=class{[ih](n){let i=this.type;if(!(i=="checkbox"||i=="radio")&&!(i=="number"&&Number.isNaN(this.valueAsNumber)))return this.$$value=void 0,this.data=this.richValue,q()}[nh](n){let i=this.data,h=this.richValue;if(this.type=="checkbox"||this.type=="radio"){let s=this.checked;Bt(i)?s?at(i,h):nl(i,h):this.data=s?h:!1}return q()}setRichValue(n){this.$$value!==n&&(this.$$value=n,this.value!==n&&(this.value=n))}getRichValue(){if(this.$$value!==void 0)return this.$$value;let n=this.value,i=this.type;if(i=="range"||i=="number"){let h=this.valueAsNumber;Number.isNaN(h)&&(h=Number(n.replace(/\,/,".")+0)),Number.isNaN(h)&&(h=null),n=h}else i=="checkbox"&&(n==null||n==="on")&&(n=!0);return n}[oh](){if(this[ch]){let n=this.type;if(n=="checkbox"||n=="radio"){let i=this.data;i===!0||i===!1||i==null?this.checked=!!i:this.checked=pt(i,this.richValue)}else this.richValue=this.data}this[_n]&&(this[_n]=null)}};(()=>{d(wm,vm,"HTMLInputElement",1,xe)})();var dm=Symbol(),Tm=class{get checked(){return this.$checked}set checked(n){n!=this.$checked&&(this.$checked=n,this.flags.toggle("checked",!!n))}setRichValue(n){return this.$$value=n,this.value=n}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}[_h](n){let i=this.data,h=this.checked,s=this.richValue;return Bt(i)?h?nl(i,s):at(i,s):this.$$value==null?this.data=!h:this.data=h?null:s,this[oh](),q()}[oh](){if(this[ch]){let n=this.data,i=this.$$value==null?!0:this.$$value;Bt(n)?this.checked=pt(n,i):this.checked=n==i}this[_n]&&(this[_n]=null)}};(()=>{d(Tm,dm,"HTMLButtonElement",1,Ie)})();function Nm(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function co(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var Fm=Symbol.for("#getSlot"),Lm=Symbol.for("#container"),Km=Symbol.for("#afterVisit"),Ai=Symbol.for("#__init__"),gh=Symbol.for("#listeners"),Ln=Symbol.for("#slot"),Om=Symbol.for("#parent"),hn=Symbol.for("##container"),ft=Symbol.for("#domTarget"),fo=Symbol.for("#insertInto"),ym=Symbol.for("#removeFrom"),Gm=Symbol.for("#teleport"),Cm=Symbol.for("#self"),Ym=Symbol.for("#target"),Xm=Symbol(),Wc=class extends Zn{constructor(){super(...arguments),super[Ai]||this[Ai]()}[Ai](n=null,i=!0,h=!0){i&&super[Ai]&&super[Ai](...arguments),this.to=n?n.to:void 0}build(){return this[gh]=[],this.win=globalThis,this.doc=globalThis.document}setup(){return this.setAttribute("style","display:none !important;")}[Fm](n,i){return this[Ln]||(this[Ln]=Wt(0,this[Om])),this[Ln]}get[Lm](){if(!this[hn]){let n=this.className;this[hn]=this.doc.createElement("div"),this[hn].className=n,this[hn].style.cssText="display:contents !important;"}return this[hn]}get domTarget(){return this[ft]||(this[ft]=Nm(this.to,a)?this.to:this.closest(this.to)||this.doc.querySelector(this.to))}get eventTarget(){return this.domTarget}get style(){return this[hn]?this[hn].style:super.style}get classList(){return this[hn]?this[hn].classList:super.classList}get className(){return this[hn]?this[hn].className:super.className}set className(n){this[hn]?this[hn].className=n:super.className=n}[Km](){if(this.mountedΦ&&this[Ln]&&!this[Ln].parentNode)return this[Ln][fo](this.target)}mount(){for(let i=0,h=co(this[gh]),s=h.length;i<s;i++){let[t,l,u]=h[i];this.eventTarget.addEventListener(t,l,u)}let n=this.domTarget;return this[Ln]&&this[Ln][fo](n),this}unmount(){for(let n=0,i=co(this[gh]),h=i.length;n<h;n++){let[s,t,l]=i[n];this.eventTarget.removeEventListener(s,t,l)}return this[Ln]&&this[Ln][ym](this.domTarget),this[ft]=null,this}addEventListener(n,i,h={}){var s;if(i[Gm]=this,i[Cm]=this,this[gh].push([n,i,h]),this.mountedΦ&&((s=this.eventTarget)==null?void 0:s.addEventListener))return this.eventTarget.addEventListener(n,i,h)}},Bc=Wc;(()=>{d(Wc,Xm,"TeleportHook",24)})();var zm=Symbol(),Mc=class extends Bc{get domTarget(){return this.doc.body}get eventTarget(){return this.win}addEventListener(n,i,h={}){return i[Ym]=this.domTarget.parentNode,super.addEventListener(...arguments)}on$resize(n,i,h,s){return this.addEventListener("resize",h,s),h}},Qm=Mc;(()=>{d(Mc,zm,"GlobalHook",8)})();globalThis.customElements&&(globalThis.customElements.define("i-teleport",Bc),globalThis.customElements.define("i-global",Qm));function wn(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}function Hm(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var Gn=Symbol.for("#__init__"),$h=Symbol.for("#insertInto"),kh=Symbol.for("#removeFrom"),Zm=Symbol.for("#all"),xi=Symbol.for("#phase"),Un=Symbol.for("#nodes"),Jm=Symbol.for("#sizes"),Ni=Symbol.for("#linked"),ro=Symbol.for("#mode"),eo=Symbol.for("#enabled"),Wm=Symbol.for("#easer"),Fi=Symbol.for("#group"),rt=Symbol.for("#_easer_"),Bm=Symbol(),Rc=class extends It{constructor(){super(...arguments),super[Gn]||this[Gn]()}[Gn](n=null,i=!0,h=!0){var s;i&&super[Gn]&&super[Gn](...arguments),this.selectors=n&&(s=n.selectors)!==void 0?s:{}}addSelectors(n,i){var h;return((h=this.selectors)[i]||(h[i]=[])).push(...n),!0}getSelectors(...n){let i=[];for(let h=0,s=wn(n),t=s.length;h<t;h++){let l=s[h];this.selectors[l]&&i.push(...this.selectors[l])}return i&&i.length?i.join(","):null}nodesForBase(n,i="transition"){let h=[n],s=(this.selectors[i]||[]).join(",");if(s=="")return h;let t=n.querySelectorAll(s);for(let l=0,u=wn(t),o=u.length;l<o;l++){let c=u[l];c.closest("._ease_")==n&&h.push(c)}return h[Zm]=t,h}nodesWithSize(n,i="in"){let h=this.getSelectors("_off_sized","_"+i+"_sized");return h?n.filter(function(s){return s.matches(h)}):[]}},Mm=Rc;(()=>{d(Rc,Bm,"Transitions",16)})();var Mt=new Mm,Rm=globalThis.imba||(globalThis.imba={});Rm.transitions=Mt;var Um=Symbol(),qm=class extends It{[Gn](n=null,i=!0,h=!0){var s;i&&super[Gn]&&super[Gn](...arguments),this.flushingΦ=n&&(s=n.flushingΦ)!==void 0?s:!1,this.mutations=n&&(s=n.mutations)!==void 0?s:[]}constructor(n){super(),super[Gn]||this[Gn](),this.callback=n}insert(n,i,h){return this.mutations.push({target:n,addedNodes:[i],removedNodes:[],nextSibling:h})}remove(n,i){return this.mutations.push({target:n,addedNodes:[],removedNodes:[i]})}flush(){let n=this.mutations.slice(0);if(!n.length)return this;this.mutations=[],Hm(this.callback,Function)&&this.callback(n),this.emit("start",this,n),this.flushingΦ=!0;for(let i of wn(n)){for(let h of wn(i.addedNodes))h[$h](i.target,i.nextSibling);for(let h of wn(i.removedNodes))h[kh](i.target)}return this.flushingΦ=!1,this.emit("end",this,n)}};(()=>{d(qm,Um,"EaseGroup",16)})();var gm=Symbol(),Uc=class extends It{constructor(n){super(),this.dom=n,this[xi]=null,this[Un]=[],this[Jm]=new Map}log(...n){}get flags(){return this.dom.flags}link(n){return this[Ni]||(this[Ni]=new Set),this[Ni].add(n)}unlink(n){return this[Ni].delete(n)}flag(n){for(let i=0,h=wn(this[Un]),s=h.length;i<s;i++)h[i].flags.add(n);return this}unflag(n){for(let i=0,h=wn(this[Un]),s=h.length;i<s;i++)h[i].flags.remove(n);return this}commit(){return this.dom.offsetWidth}enable(n){return n&&(this[ro]=n),this[eo]!=!0&&(this[eo]=!0,!0)?(this.dom[$h]=this[$h].bind(this),this.dom[kh]=this[kh].bind(this),this.flags.add("_ease_")):this}disable(){return this.flags.remove("_ease_"),!0}set phase(n){var i,h,s,t,l,u,o,c,f,r,e,S,b,m,E,w,v,F,T,L,N,K,O,C;let Y=this[xi];this[xi]!=n&&(this[xi]=n,!0)&&(Y&&this.unflag("@"+Y),n&&this.flag("@"+n),n||(this.unflag("@out"),this.unflag("@in"),this.unflag("@off"),this[Un]=null),n=="enter"&&Y=="leave"&&((h=(i=this.dom)==null?void 0:i.emit)==null||h.call(i,"outcancel"),(t=(s=this.dom)==null?void 0:s.transitionΞoutΞcancel)==null||t.call(s,this)),n=="leave"&&Y=="enter"&&((u=(l=this.dom)==null?void 0:l.emit)==null||u.call(l,"incancel"),(c=(o=this.dom)==null?void 0:o.transitionΞinΞcancel)==null||c.call(o,this)),n=="enter"&&((r=(f=this.dom)==null?void 0:f.emit)==null||r.call(f,"in"),(S=(e=this.dom)==null?void 0:e.transitionΞin)==null||S.call(e,this)),n=="leave"&&((m=(b=this.dom)==null?void 0:b.emit)==null||m.call(b,"out"),(w=(E=this.dom)==null?void 0:E.transitionΞout)==null||w.call(E,this)),Y=="leave"&&!n&&((F=(v=this.dom)==null?void 0:v.emit)==null||F.call(v,"outend"),(L=(T=this.dom)==null?void 0:T.transitionΞoutΞend)==null||L.call(T,this)),Y=="enter"&&!n&&((K=(N=this.dom)==null?void 0:N.emit)==null||K.call(N,"inend"),(C=(O=this.dom)==null?void 0:O.transitionΞinΞend)==null||C.call(O,this)))}get phase(){return this[xi]}get leavingΦ(){return this.phase=="leave"}get enteringΦ(){return this.phase=="enter"}get idleΦ(){return this.phase==null}track(n){var i=this;let h={before:ht().getAnimations()};return this.commit(),n(),this.commit(),h.after=ht().getAnimations(),h.fresh=h.after.filter(function(s){return h.before.indexOf(s)==-1}),h.deep=h.fresh.filter(function(s){let t;return!!((t=s.effect.target)&&t.closest("._ease_")!=i.dom)}),h.own=h.fresh.filter(function(s){return h.deep.indexOf(s)==-1}),h.own.length?h.finished=new Promise(function(s){let t=new Set(h.own),l=function(){if(t.delete(this),t.size==0)return s()};for(let u=0,o=wn(h.own),c=o.length;u<c;u++){let f=o[u];f[Wm]=i,f.addEventListener("finish",l,{once:!0}),f.addEventListener("cancel",l,{once:!0})}}):h.finished=Promise.resolve(!0),h}getAnimatedNodes(){let n=Mt.nodesForBase(this.dom);return this[Ni]&&(n=n.concat(Array.from(this[Ni]))),n}getNodeSizes(n="in",i=this[Un]){let h=Mt.nodesWithSize(i,n),s=new Map;for(let t=0,l=wn(h),u=l.length;t<u;t++){let o=l[t],c=window.getComputedStyle(o);s.set(o,{width:c.width,height:c.height})}return s}applyNodeSizes(n){for(let[i,h]of wn(n))i.style.width=h.width,i.style.height=h.height;return n}clearNodeSizes(n){if(n){for(let[i,h]of wn(n))i.style.removeProperty("width"),i.style.removeProperty("height");return n}}[$h](n,i){var h,s,t=this;if(this[Fi]&&!this[Fi].flushingΦ)return this[Fi].insert(n,this.dom,i),this.dom;let l;if(this.enteringΦ)return this.dom;let u=function(){if(l&&t.clearNodeSizes(l),t.enteringΦ)return t.phase=null};if(this.leavingΦ)return this.track(function(){return t.phase="enter",t.unflag("@off"),t.unflag("@out")}).finished.then(u,function(c){return t.log("error cancel leave",c)}),this.dom;let o=ht().contains(n);return i?this.dom.nextSibling!=i&&n.insertBefore(this.dom,i):this.dom.parentNode!=n&&n.appendChild(this.dom),this[Un]=this.getAnimatedNodes(),this.flag("_instant_"),this.unflag("@out"),this.commit(),l=this[Un].sized=this.getNodeSizes("in"),(s=(h=this.dom)==null?void 0:h.transitionΞinΞinit)==null||s.call(h,this),this.flag("@off"),this.flag("@in"),this.flag("@enter"),this.commit(),this.unflag("_instant_"),this.track(function(){return t.phase="enter",t.applyNodeSizes(l),t.unflag("@off"),t.unflag("@in")}).finished.then(u,function(c){return t.clearNodeSizes(l),t.log("cancelled insert into",c)}),this.dom}[kh](n){var i=this;if(this[Fi]&&!this[Fi].flushingΦ){this[Fi].remove(n,this.dom);return}if(this.leavingΦ)return;let h,s=function(){if(i.phase=="leave")return i.dom.emit("easeoutend",{}),n.removeChild(i.dom),i.phase=null};if(this.enteringΦ&&this[ro]!="forward"){let l=this.track(function(){return i.flag("@off"),i.flag("@in"),i.unflag("@out"),i.phase="leave",i.clearNodeSizes(i[Un].sized)});this.log("cancel enter anims own",l.own,l),l.finished.then(s,function(u){return i.log("error cancel entering",u)});return}this[Un]=this.getAnimatedNodes(),h=this.getNodeSizes("out"),this.applyNodeSizes(h),this.flag("@leave");let t=this.track(function(){return i.phase="leave",i.flag("@off"),i.flag("@out"),i.clearNodeSizes(h)});if(!t.own.length){s();return}t.finished.then(s,function(){return!0})}},Pm=Uc;(()=>{d(Uc,gm,"Easer",16)})();var Vm=Symbol(),jm=class{transitionΞinΞinit(n){return!0}transitionΞin(n){return!0}transitionΞinΞend(n){return!0}transitionΞinΞcancel(n){return!0}transitionΞout(n){return!0}transitionΞoutΞend(n){return!0}transitionΞoutΞcancel(n){return!0}get ease(){return this[rt]||(this[rt]=new Pm(this))}set ease(n){var i,h;if(n==!1){(h=(i=this[rt])==null?void 0:i.disable)==null||h.call(i);return}this.ease.enable(n)}};(()=>{d(jm,Vm,"Element",1,Element)})();function Am(){return globalThis.imba.uses_events_keyboard=!0,!0}var xm=Symbol(),Dm=class{αesc(){return this.keyCode==27}αtab(){return this.keyCode==9}αenter(){return this.keyCode==13}αspace(){return this.keyCode==32}αup(){return this.keyCode==38}αdown(){return this.keyCode==40}αleft(){return this.keyCode==37}αright(){return this.keyCode==39}αdel(){return this.keyCode==8||this.keyCode==46}αkey(n){if(typeof n=="string")return this.key==n;if(typeof n=="number")return this.keyCode==n}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αmod(){let n=globalThis.navigator.platform;return/^(Mac|iPhone|iPad|iPod)/.test(n||"")?!!this.metaKey:!!this.ctrlKey}};(()=>{d(Dm,xm,"KeyboardEvent",1,Ve)})();function an(){return globalThis.imba.uses_events_mouse=!0,!0}var Im=Symbol(),_m=class{αleft(){return this.button==0}αmiddle(){return this.button==1}αright(){return this.button==2}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αmod(){let n=globalThis.navigator.platform;return/^(Mac|iPhone|iPad|iPod)/.test(n||"")?!!this.metaKey:!!this.ctrlKey}};(()=>{d(_m,Im,"MouseEvent",1,ge)})();function On(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function et(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var $m=Symbol.for("#extendType"),km=Symbol.for("#modifierState"),Ph=Symbol.for("#sharedModifierState"),mo=Symbol.for("#onceHandlerEnd"),So=Symbol.for("#extendDescriptors"),V=Symbol.for("#context"),cs=Symbol.for("#defaultPrevented"),Rt=Symbol.for("#stopPropagation"),bo=Symbol.for("#self"),pm=Symbol.for("#target"),am=Symbol.for("#teleport");Am();an();var nS=Symbol(),iS=class{[$m](n){var i,h;let s=n[So]||(n[So]=(i=Object.getOwnPropertyDescriptors(n.prototype),h=i.constructor,delete i.constructor,i));return Object.defineProperties(this,s)}};(()=>{d(iS,nS,"CustomEvent",1,CustomEvent)})();var hS=Symbol(),sS=class{get original(){return this.originalEvent||this}get[km](){var n,i;return(n=this[V])[i=this[V].step]||(n[i]={})}get[Ph](){var n,i;return(n=this[V].handler)[i=this[V].step]||(n[i]={})}[mo](n){return Sn(this[V],"end",n)}αsel(n){return!!this.target.matches(String(n))}αclosest(n){return!!this.target.closest(String(n))}αprevent(){return this[cs]=!0,this.preventDefault(),!0}αtrap(){return this[Rt]=!0,this.stopImmediatePropagation(),this[cs]=!0,this.preventDefault(),!0}αfocin(n){var i;let h=this[V].element;return h=On(n,Element)?n:n?h.closest(n):h,(i=h==null?void 0:h.contains)==null?void 0:i.call(h,globalThis.document.activeElement)}αlog(...n){return console.info(...n),!0}αtrusted(){return!!this.isTrusted}αuntrusted(){return!this.isTrusted}αif(n){return!!n}αwait(n=250){return new Promise(function(i){return setTimeout(i,Ch(n))})}αself(){return this.target==this[V].element}αcooldown(n=250){let i=this[Ph];return i.active?!1:(i.active=!0,i.target=this[V].element,i.target.flags.incr("cooldown"),this[mo](function(){return setTimeout(function(){return i.target.flags.decr("cooldown"),i.active=!1},Ch(n))}),!0)}αthrottle(n=250,i="throttled"){let h=this[Ph];return h.active?(h.next&&h.next(!1),new Promise(function(s){return h.next=function(t){return h.next=null,s(t)}})):(h.active=!0,h.el||(h.el=this[V].element),i&&h.el.flags.incr(i),Sn(this[V],"end",function(){let s=Ch(n);return h.interval=setInterval(function(){h.next?h.next(!0):(clearInterval(h.interval),i&&h.el.flags.decr(i),h.active=!1)},s)}),!0)}αdebounce(n=250){let i=this[Ph],h=this;return i.queue||(i.queue=[]),i.queue.push(i.last=h),new Promise(function(s){return setTimeout(function(){return i.last==h?(h.debounced=i.queue,i.last=null,i.queue=[],s(!0)):s(!1)},Ch(n))})}αflag(n,i){let{element:h,step:s,state:t,id:l,current:u}=this[V],o=On(i,Element)?i:i?h.closest(i):h;if(!o)return!0;this[V].commit=!0,t[s]=l,o.flags.incr(n);let c=Date.now();return Sn(u,"end",function(){let f=Date.now()-c,r=Math.max(250-f,0);return setTimeout(function(){return o.flags.decr(n)},r)}),!0}αbusy(n){return this.αflag("busy",n)}αoutside(){let{handler:n}=this[V];if(n&&n[bo])return!n[bo].parentNode.contains(this.target)}async αpost(n,i={}){return await globalThis.fetch(n,{method:"POST",...i})}async αfetch(n,i={}){return await globalThis.fetch(n,i)}};(()=>{d(sS,hS,"Event",1,Event)})();var tS=Symbol(),lS=class{αself(){let n=this[V].element;return this.type=="focusout"?this.relatedTarget&&!n.contains(this.relatedTarget):this.type=="focusin"?!this.relatedTarget||!n.contains(this.relatedTarget):this.target==n}};(()=>{d(lS,tS,"FocusEvent",1,FocusEvent)})();function Hi(){return globalThis.imba.uses_events=!0,!0}var uS=Symbol(),qc=class{constructor(n,i){this.params=n,this.closure=i}getHandlerForMethod(n,i){return n?n[i]?n:this.getHandlerForMethod(n.parentNode,i):null}abortCurrentHandlers(){var n;if(this.currentEvents)for(let i of et(this.currentEvents))i.aborted=!0,(n=i==null?void 0:i.resolver)==null||n.call(i,!0);return this}emit(n,...i){return fi(this,n,i)}on(n,...i){return rh(this,n,...i)}once(n,...i){return Sn(this,n,...i)}un(n,...i){return Ss(this,n,...i)}get passiveΦ(){return this.params.passive}get captureΦ(){return this.params.capture}get silentΦ(){return this.params.silent}get globalΦ(){return this.params.global}async handleEvent(n){if(this.disabled)return;let i=this[pm]||n.currentTarget,h=this.params,s=null,t=h.silence||h.silent;this.count||(this.count=0),this.state||(this.state={});let l=this.lastState={element:i,event:n,modifiers:h,handler:this,id:++this.count,step:-1,state:this.state,commit:null,called:!1,current:null,aborted:!1};if(l.current=l,n.handle$mod&&n.handle$mod.apply(l,h.options||[])==!1)return;let u=Event[this.type+"$handle"]||Event[n.type+"$handle"]||this.guard;if(!(u&&u.apply(l,h.options||[])==!1)){this.currentEvents||(this.currentEvents=new Set),this.currentEvents.add(l);for(let o=0,c=Object.keys(h),f=c.length,r,e;o<f&&(r=c[o],e=h[r],!l.aborted);o++){if(l.step++,r[0]=="_")continue;r.indexOf("~")>0&&(r=r.split("~")[0]);let S=null,b=[n,l],m,E=null,w,v=!1,F=typeof r=="string";if(r[0]=="$"&&r[1]=="_"&&On(e[0],Function))n[V]=l,r=e[0],l.called=!0,r.passive||(l.commit=!0),b=[n,l].concat(e.slice(1)),E=i;else if(On(e,Array)){b=e.slice(),S=b;for(let T=0,L=et(b),N=L.length;T<N;T++){let K=L[T];if(typeof K=="string"&&K[0]=="~"&&K[1]=="$"){let O=K.slice(2).split("."),C=l[O.shift()]||n;for(let Y=0,En=et(O),A=En.length;Y<A;Y++){let on=En[Y];C=C?C[on]:void 0}b[T]=C}}}if(typeof r=="string"&&(w=r.match(/^(emit|flag|mod|moved|pin|fit|refit|map|remap|css)-(.+)$/))&&(S||(S=b=[]),b.unshift(w[2]),r=w[1]),r=="trap")n[Rt]=!0,n.stopImmediatePropagation(),n[cs]=!0,n.preventDefault();else if(r=="stop")n[Rt]=!0,n.stopImmediatePropagation();else if(r=="prevent")n[cs]=!0,n.preventDefault();else if(r=="commit")l.commit=!0;else if(r=="once")i.removeEventListener(n.type,this);else{if(r=="options"||r=="silence"||r=="silent")continue;if(r=="emit"){let T=b[0],L=b[1];l.called=!0;let N=new CustomEvent(T,{bubbles:!0,detail:L});N.originalEvent=n;let K=(this[am]||i).dispatchEvent(N)}else if(typeof r=="string"){r[0]=="!"&&(v=!0,r=r.slice(1));let T="α"+r,L=n[T];L||(L=this.type&&Event[this.type+"$"+r+"$mod"]),L||(L=n[r+"$mod"]||Event[n.type+"$"+r]||Event[r+"$mod"]),On(L,Function)?(r=L,E=l,b=S||[],n[T]&&(E=n,n[V]=l)):r[0]=="_"?(r=r.slice(1),E=this.closure):E=this.getHandlerForMethod(i,r)}}try{On(r,Function)?m=r.apply(E||i,b):E&&(m=E[r].apply(E,b)),m&&On(m.then,Function)&&m!=D.$promise&&(l.commit&&!t&&D.commit(),m=await m)}catch(T){s=T;break}if(v&&m===!0||!v&&m===!1)break;l.value=m}if(fi(l,"end",l),l.commit&&!t&&D.commit(),this.currentEvents.delete(l),this.currentEvents.size==0&&this.emit("idle"),s!=null){if(this.type!="error"){let o=On(s,Error)?s.message:s,c=new CustomEvent("error",{detail:o,bubbles:!0,cancelable:!0});c.error=s,c.originalEvent=n;let f=i.dispatchEvent(c);if(c.defaultPrevented)return}throw s}return l}}},Eo=qc;(()=>{d(qc,uS,"EventHandler",16)})();var oS=Symbol(),cS=class{on$(n,i,h){let s="on$"+n,t=i.capture||!1,l=i.passive,u,o=t;return l&&(o={passive:l,capture:t}),On(this[s],Function)?(this[s].length>2&&(u=new Eo(i,h)),u=this[s](i,h,u,o)):(u=new Eo(i,h),this.addEventListener(n,u,o)),u}on$error(n,i,h,s){var t;return(t=n.options)!=null&&t.length&&(h.guard=function(...l){let u=this.event.error;return!!l.find(function(o){return On(u,o)})}),this.addEventListener("error",h,s),h}};(()=>{d(cS,oS,"Element",1,Element)})();function fS(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var rS=Symbol(),mt,il=new(mt=class{get iosΦ(){let n=globalThis.navigator.platform||"";return!!(n.match(/iPhone|iPod|iPad/)||n=="MacIntel"&&globalThis.navigator.maxTouchPoints>2)}},(()=>{d(mt,rS,null,0)})(),mt);function hl(n,i){let h=i;return fS(n,Element)?n:typeof n=="string"?n=="this"||n==""?h:n=="up"?h.parentNode:n=="op"?h.offsetParent:h.closest(n)||h.querySelector(n)||globalThis.document.querySelector(n):null}function Xi(n){if(typeof n=="string"){let[i,h,s]=n.match(/^([-+]?[\d\.]+)(%|\w+)$/);return[parseFloat(h),s]}else if(typeof n=="number")return[n]}function Ut(n,i=1){let h=1/i;return Math.round(n*h)/h}function eS(n,i,h){return i>h?Math.max(h,Math.min(i,n)):Math.min(h,Math.max(i,n))}function vo(n,i,h,s,t=0.1){let[l,u]=Xi(h),[o,c]=Xi(s),[f,r]=Xi(t);return u=="%"&&(l=(i-n)*(l/100)),c=="%"&&(o=(i-n)*(o/100)),r=="%"&&(f=(o-l)*(f/100)),function(e,S){let b=(e-n)/(i-n),m=l+(o-l)*b;return t&&(m=Ut(m,f)),S&&(m=eS(m,l,o)),m}}an();var mS=Symbol(),SS=class{αprimary(){return!!this.isPrimary&&(this.pointerType!="mouse"||this.button==0)}αsecondary(){return!this.isPrimary&&this.button!=0}αmouse(){return this.pointerType=="mouse"}αpen(){return this.pointerType=="pen"}αtouch(){return this.pointerType=="touch"}αpressure(n=0.5){return this.pressure>=n}αlock(){return!0}};(()=>{d(SS,mS,"PointerEvent",1,Pe)})();function Li(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var wo=Symbol.for("#capture"),Kn=Symbol.for("#step"),bS=Symbol.for("#cancel"),St=Symbol.for("#reframe"),To=Symbol.for("#mods"),bt=Symbol.for("#dx"),Et=Symbol.for("#dy"),xn=Symbol.for("#context"),fs=Symbol.for("#locked"),gc=Symbol.for("#teardown"),No=Symbol.for("#x"),Fo=Symbol.for("#y"),ES=Symbol.for("#pinTarget");var Lo=null,vS=Symbol(),Pc=class{constructor(n,i,h){this.phase="init",this.events=[],this.originalEvent=n,this.handler=i,this.target=this.currentTarget=h,this[To]={}}set event(n){this.events.push(n)}get ctrlKey(){return this.originalEvent.ctrlKey}get altKey(){return this.originalEvent.altKey}get shiftKey(){return this.originalEvent.shiftKey}get metaKey(){return this.originalEvent.metaKey}get isPrimary(){return this.originalEvent.isPrimary}get pointerType(){return this.originalEvent.pointerType}get start(){return this.originalEvent}get originalTarget(){return this.originalEvent.target}get event(){return this.events[this.events.length-1]}get elapsed(){return this.event.timeStamp-this.events[0].timeStamp}get type(){return this.event.type}get pointerId(){return this.originalEvent.pointerId}get pressure(){return this.event.pressure}get clientX(){return this.event.clientX}get clientY(){return this.event.clientY}get offsetX(){return this.event.offsetX}get offsetY(){return this.event.offsetY}get activeΦ(){return this.phase!="ended"}get endedΦ(){return this.phase=="ended"}get dx(){return this[bt]==null?this.event.x-this.start.x:this[bt]}get dy(){return this[Et]==null?this.event.y-this.start.y:this[Et]}get dr(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)}stopImmediatePropagation(){return this.cancelBubble=!0,this.event.stopImmediatePropagation(),this}stopPropagation(){return this.cancelBubble=!0,this.event.stopPropagation(),this}preventDefault(){return this.defaultPrevented=!0,this.event.preventDefault()}emit(n,...i){return fi(this,n,i)}on(n,...i){return rh(this,n,...i)}once(n,...i){return Sn(this,n,...i)}un(n,...i){return Ss(this,n,...i)}αflag(n,i){let{element:h}=this[xn],s=Date.now(),t=Li(i,a)?i:i?h.closest(i):h;return this[Kn].setup!=!0&&(this[Kn].setup=!0,!0)&&(t.flags.incr(n),Sn(this,"end",function(){return t.flags.decr(n)})),!0}αlock(){return this[wo](),!0}[wo](){if(this[fs]!=!0&&(this[fs]=!0,!0))return this[xn].element.setPointerCapture(this.pointerId)}get[Kn](){var n,i;return(n=this[To])[i=this[xn].step]||(n[i]={})}[bS](){return this[gc]()}αmoved(n,i){let h=this[Kn],{element:s,state:t,event:l}=this[xn];if(!h.setup){let r=n||4;typeof n=="string"&&n.match(/^(up|down|left|right|x|y)$/)&&(h.dir=n,r=i||4),typeof i=="string"&&i.match(/^(up|down|left|right|x|y)$/)&&(h.dir=i),h.setup=!0;let[e,S]=Xi(r);h.threshold=e,h.sy=e,h.x0=this.x,h.y0=this.y,h.dir||(h.dir="dist"),h.x=h.left=h.right=h.y=h.up=h.down=h.dist=0,S&&S!="px"&&console.warn("only px threshold allowed in @touch.moved")}if(h.active)return!0;if(h.cancelled)return!1;let u=h.threshold,o=this.x-h.x0,c=this.y-h.y0;h.x=Math.max(h.x,Math.abs(o)),h.y=Math.max(h.y,Math.abs(c)),h.left=Math.max(h.left,-o),h.right=Math.max(h.right,o),h.up=Math.max(h.up,-c),h.down=Math.max(h.down,c),h.dist=Math.max(h.dist,Math.sqrt(o*o+c*c));let f=h[h.dir];if(f>u&&f>=h.x&&f>=h.y){h.active=!0;let r=t.pinTarget;return s.flags.incr("@move"),r&&r.flags.incr("@move"),this.preventDefault(),Sn(this,"end",function(){return r&&r.flags.decr("@move"),s.flags.decr("@move")}),!0}else if(h.x>u||h.y>u)return h.cancelled=!0,!1;return!1}αhold(n=250){var i=this;let h=this[Kn],s=this[xn].element;if(h.cancelled)return!1;if(h.setup&&!h.active){let t=this.clientX,l=this.clientY,u=t-h.x,o=l-h.y;Math.sqrt(u*u+o*o)>5&&!h.cancelled&&(clearTimeout(h.timeout),h.cancelled=!0)}if(h.setup!=!0&&(h.setup=!0,!0)){h.active=!1,h.x=this.clientX,h.y=this.clientY;let t;return h.timeout=setTimeout(function(){return h.active=!0,i.preventDefault(),s.flags.incr("@hold"),t&&t(!0),t=null},n),Sn(this,"end",function(){return h.active&&s.flags.decr("@hold"),clearTimeout(h.timeout),t&&t(!1),t=null}),new Promise(function(l){return t=l})}return h.active}αsync(n,i="x",h="y"){let s=this[Kn];return s.setup!=!0&&(s.setup=!0,!0)?(s.x=n[i]||0,s.y=n[h]||0,s.tx=this.x,s.ty=this.y):(i&&(n[i]=s.x+(this.x-s.tx)),h&&(n[h]=s.y+(this.y-s.ty))),this[xn].commit=!0,!0}αapply(n,i="x",h="y"){return i&&(n[i]=this.x),h&&(n[h]=this.y),this[xn].commit=!0,!0}αcss(n="x",i="y"){let h=this[Kn];if(h.setup!=!0&&(h.setup=!0,!0))h.el=this[xn].element,h.x=h.el[No]||0,h.y=h.el[Fo]||0,h.tx=this.x,h.ty=this.y;else{let s=h.el[No]=h.x+(this.x-h.tx),t=h.el[Fo]=h.y+(this.y-h.ty);n&&h.el.style.setProperty("--x",s+"px"),i&&h.el.style.setProperty("--y",t+"px")}return!0}αend(){return this.phase=="ended"}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αprimary(){return!!this.isPrimary&&(this.pointerType!="mouse"||this.originalEvent.button==0)}αmouse(){return this.pointerType=="mouse"}αpen(){return this.pointerType=="pen"}αtouch(){return this.pointerType=="touch"}αpressure(n=0.5){return this.pressure>=n}αlog(...n){return console.info(...n),!0}αleft(){return this.originalEvent.button==0}αmiddle(){return this.originalEvent.button==1}αright(){return this.originalEvent.button==2}αround(n=1,i=n){return this.x=Ut(this.x,n),this.y=Ut(this.y,i),!0}[St](...n){let i=this[Kn];if(i.setup!=!0&&(i.setup=!0,!0)){let h=this.target,s=n.length,t=n[0],l=0,u="100%",o=0,c=typeof t;c=="number"||c=="string"&&/^([-+]?\d[\d\.]*)(%|\w+)$/.test(t)||Li(t,Array)?t=null:c=="string"&&(t=="this"||t==""?t=h:t=="up"?t=h.parentNode:t=="op"?t=h.offsetParent:t=h.closest(t)||h.querySelector(t)),t==null&&(s++,n.unshift(t=h)),s==2?o=n[1]:s>2&&([l,u,o=0]=n.slice(1));let f=t.getBoundingClientRect();Li(l,Array)||(l=[l,l]),Li(u,Array)||(u=[u,u]),Li(o,Array)||(o=[o,o]),i.rect=f,i.x=vo(f.left,f.right,l[0],u[0],o[0]),i.y=vo(f.top,f.bottom,l[1],u[1],o[1]),this.x0=this.x=i.x(this.x,i.clamp),this.y0=this.y=i.y(this.y,i.clamp)}else{let h=this.x=i.x(this.x,i.clamp),s=this.y=i.y(this.y,i.clamp);this[bt]=h-this.x0,this[Et]=s-this.y0}return!0}αfit(...n){return this[Kn].clamp=!0,this[St](...n)}αreframe(...n){return this[St](...n)}αpin(...n){var i;let h=this[Kn];if(h.setup!=!0&&(h.setup=!0,!0)){let s=hl(n[0],this.target);Li(s,a)||n.unshift(s=this.target);let t=n[1]||0,l=(i=n[2])!=null?i:n[2]=t,u=s.getBoundingClientRect();h.x=this.clientX-(u.left+u.width*t),h.y=this.clientY-(u.top+u.height*l),s&&(this[ES]=s,s.flags.incr("_touch_"),Sn(this,"end",function(){return s.flags.decr("_touch_")}))}return this.x-=h.x,this.y-=h.y,!0}},wS=Pc;(()=>{d(Pc,vS,"Touch",16)})();var dS=Symbol(),TS=class{on$touch(n,i,h,s){return h.type="touch",this.addEventListener("pointerdown",h,{passive:!1}),il.iosΦ&&globalThis.parent!=globalThis&&Lo!=!0&&(Lo=!0,!0)&&globalThis.parent.postMessage("setupTouchFix"),h}};(()=>{d(TS,dS,"Element",1,a)})();if(globalThis.parent==globalThis&&il.iosΦ){let n=function(i){if(i.data=="setupTouchFix")return globalThis.addEventListener("touchmove",function(){return!1},{passive:!1}),globalThis.removeEventListener("message",n)};globalThis.addEventListener("message",n)}Oc.touch$handle=function(){let n=this.event,i=this.element,h=this.state.pointerId,s=this.modifiers,t=this.handler,l=il.iosΦ;if(this.current=this.state,h!=null)return h==n.pointerId;if(s.ctrl&&!n.ctrlKey||s.alt&&!n.altKey||s.meta&&!n.metaKey||s.shift&&!n.shiftKey||s.if&&!s.if[0]||s.self&&n.target!=i||s.primary&&!n.isPrimary||s.pen&&n.pointerType!="pen"||s.mouse&&n.pointerType!="mouse"||s.touch&&n.pointerType!="touch"||s.sel&&!n.target.matches(String(s.sel[0])))return;let u=this.state=t.state=this.current=new wS(n,t,i);h=u.pointerId;let o=function(m){return m.preventDefault(),!1},c=null,f=Symbol(),r=function(m){let{clientX:E,clientY:w}=u,v=m.clientX,F=m.clientY;(u[fs]||u.defaultPrevented)&&(m.pointerId==u.pointerId||E==v&&w==F)&&(m.preventDefault(),m.stopPropagation()),r&&(globalThis.removeEventListener("click",r,{capture:!0}),r=null)},e=function(m){if(!(u.type=="touchmove"&&m.changedTouches[0].identifier!=h)&&(u.defaultPrevented||u[fs]))return m.preventDefault()},S=function(m){let E=m.type,w=u.phase;if(m.pointerId&&u.pointerId!=m.pointerId||m[f])return;m[f]=!0;let v=E=="pointerup"||E=="pointercancel";if(m.pressure==0&&m.pointerType=="mouse"&&E=="pointermove"&&u.originalEvent.pressure>0)return c(m);E=="pointercancel"?(u.x=u.clientX,u.y=u.clientY):(u.x=m.clientX,u.y=m.clientY),u.event=m,v&&(u.phase="ended");try{t.handleEvent(u)}catch{}if(w=="init"&&!v&&(u.phase="active"),v&&c)return c(m)},b=!1;return c=function(m){if(!b&&(b=!0,i.flags.decr("_touch_"),u.phase!="ended"&&(u.phase="ended",u.x=u.clientX,u.y=u.clientY,t.handleEvent(u)),u.emit("end"),s.passive||--t.prevents==0&&i.style.removeProperty("touch-action"),t.state={},globalThis.removeEventListener("pointermove",S,{passive:!!s.passive}),globalThis.removeEventListener("pointerup",S),globalThis.removeEventListener("pointercancel",S),setTimeout(function(){if(r&&(globalThis.removeEventListener("click",r,{capture:!0}),r=null),l&&e)return globalThis.removeEventListener("touchend",e),globalThis.removeEventListener("touchmove",e,{passive:!1}),e=null},100),!s.passive))return globalThis.document.removeEventListener("selectstart",o,{capture:!0})},u[gc]=c,s.passive||(t.prevents||(t.prevents=0),t.prevents++,i.style.setProperty("touch-action","none"),i.offsetWidth),i.flags.incr("_touch_"),globalThis.addEventListener("pointermove",S,{passive:!!s.passive}),globalThis.addEventListener("pointerup",S),globalThis.addEventListener("pointercancel",S),globalThis.addEventListener("click",r,{capture:!0}),l&&!s.passive&&(globalThis.addEventListener("touchend",e),globalThis.addEventListener("touchmove",e,{passive:!1})),s.passive||globalThis.document.addEventListener("selectstart",o,{capture:!0}),S(n),!1};function Vc(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}function Ko(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var NS=Symbol.for("#context"),FS=Symbol.for("#extendType");var Oo=new(globalThis.WeakMap||Map),vt={threshold:[0]},LS={};Oc.intersect$handle=function(){let n=this.event.detail.observer;return this.modifiers._observer==n};var KS=Symbol(),jc=class extends Qn{αin(){return this.delta>=0&&this.entry.isIntersecting}αout(){return this.delta<0}αcss(n="ratio"){return this.target.style.setProperty("--ratio",this.ratio),!0}αflag(n,i){let{state:h,step:s}=this[NS],t=hl(i||"",this.target);return this.isIntersecting&&!h[s]?(t.flags.incr(n),h[s]=!0):h[s]&&!this.isIntersecting&&(t.flags.decr(n),h[s]=!1),!0}},OS=jc;(()=>{d(jc,KS,"IntersectionEvent",0)})();function yS(n,i){return function(h,s){let t=s.prevRatios||(s.prevRatios=new WeakMap);for(let l=0,u=Vc(h),o=u.length;l<o;l++){let c=u[l],f=t.get(c.target)||0,r=c.intersectionRatio,e={entry:c,ratio:r,from:f,delta:r-f,observer:s},S=new Qn(n,{bubbles:!1,detail:e});S[FS](OS),S.entry=c,S.isIntersecting=c.isIntersecting,S.delta=e.delta,S.ratio=e.ratio,t.set(c.target,r),c.target.dispatchEvent(S)}}}function yo(n=vt){let i=n.threshold.join("-")+n.rootMargin;!n.root&&vt.root&&(n.root||(n.root=vt.root));let h=n.root||LS,s=Oo.get(h);return s||Oo.set(h,s={}),s[i]||(s[i]=new IntersectionObserver(yS("intersect",i),n))}var GS=Symbol(),CS=class{on$intersect(n,i,h,s){let t;if(n.options){let l=[],u={threshold:l};for(let o=0,c=Vc(n.options),f=c.length;o<f;o++){let r=c[o];Ko(r,a)||Ko(r,$e)?u.root=r:typeof r=="number"?l.push(r):typeof r=="string"?u.rootMargin=r:typeof r=="object"&&Object.assign(u,r)}if(l.length==1){let o=l[0];if(o>1)for(l[0]=0;l.length<o;)l.push(l.length/(o-1))}l.length==0&&l.push(0),t=yo(u)}else t=yo();return n._observer=t,t.observe(this),this.addEventListener("intersect",h,s),h}};(()=>{d(CS,GS,"Element",1,a)})();function YS(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var Go=Symbol.for("#width"),Co=Symbol.for("#height"),XS=Symbol.for("#extendType");var Vh=null,zS=Symbol(),Ac=class extends Qn{αcss(n="1elw",i="1elh",h="",s=""){var t;let l=(t=this.entry)==null?void 0:t.target;if(h=="px"&&(s=h,h=""),l&&l.offsetParent){let u=Xi(n),o=Xi(i),c=hl(h,l),f=u?"--u_"+u[1]:"--"+n,r=o?"--u_"+o[1]:"--"+i,e=u?this.width/u[0]:this.width,S=o?this.height/o[0]:this.height;c.style.setProperty(f,e+s),c.style.setProperty(r,S+s)}return!0}get width(){var n;return(n=this[Go])!=null?n:this[Go]=this.entry.target.offsetWidth}get height(){var n;return(n=this[Co])!=null?n:this[Co]=this.entry.target.offsetHeight}},QS=Ac;(()=>{d(Ac,zS,"ResizeEvent",0)})();function HS(){return globalThis.ResizeObserver||Vh||(console.warn(":resize not supported in this browser"),Vh={observe:function(){return!0}}),globalThis.imbaResizeObserver=Vh||(Vh=new ResizeObserver(function(n){for(let i=0,h=YS(n),s=h.length;i<s;i++){let t=h[i],l=new Qn("resize",{bubbles:!1,detail:t});l.entry=t,l.rect=t.contentRect,l[XS](QS),t.target.dispatchEvent(l);let u=new Qn("resized",{bubbles:!0,detail:t});t.target.dispatchEvent(u)}}))}var ZS=Symbol(),JS=class{on$resize(n,i,h,s){return HS().observe(this),this.addEventListener("resize",h,s),h}};(()=>{d(JS,ZS,"Element",1,a)})();var WS=Symbol.for("#extendType"),BS=Symbol.for("#options");var MS=Symbol(),xc=class extends Qn{},RS=xc;(()=>{d(xc,MS,"MutationEvent",0)})();var US=Symbol(),qS=class{on$mutate(n,i,h,s){var t=this;h.observer||(h.observer=new MutationObserver(function(u){let o=new Qn("mutate",{bubbles:!!n.bubble,detail:u});return o[WS](RS),t.dispatchEvent(o)}));let l=h[BS]={};return n.subtree&&(l.subtree=!0),n.childList&&(l.childList=!0),n.attributes&&(l.attributes=!0),!l.attributes&&!l.childList&&(l.childList=!0),h.observer.observe(this,l),this.addEventListener("mutate",h,s),h}};(()=>{d(qS,US,"Element",1,a)})();var wt,Yo=Symbol();function gS(){if(!wt)return wt=function(n){if(n[Yo])return;n[Yo]=!0;let i=globalThis.document.activeElement;if(i&&i.matches("input,textarea")){let h=new Qn("selection",{detail:{start:i.selectionStart,end:i.selectionEnd}});return i.dispatchEvent(h)}},globalThis.document.addEventListener("selectionchange",wt)}var PS=Symbol(),VS=class{on$selection(n,i,h,s){return gS(),this.addEventListener("selection",h,s),h}};(()=>{d(VS,PS,"Element",1,a)})();var Xo=Symbol.for("#string"),zo=Symbol.for("#html"),Hn={win:{sep:"+",name:"win",order:["meta","ctrl","mod","alt","option","shift"].reverse(),labels:{option:"alt",mod:"ctrl",meta:"win"}},mac:{sep:"",name:"mac",order:["ctrl","alt","option","shift","mod","command"].reverse(),labels:{left:"→",up:"↑",down:"↓",right:"←",plus:"+",tab:"⇥",meta:"⌘",mod:"⌘",ctrl:"⌃",option:"⌥",alt:"⌥",del:"⌦",shift:"⇧",enter:"↩",esc:"⎋",backspace:"⌫"}}};Hn.auto=Hn.win;(globalThis.navigator.platform||"").match(/iPhone|iPod|iPad|Mac/)&&(Hn.auto=Hn.mac);var dt={};function Dc(n,i="auto"){let h=""+n+":"+i;if(dt[h])return dt[h];let s=Hn[i]||Hn.win,t=n.split(" ").map(function(l){return l.split("+").sort(function(u,o){return s.order.indexOf(o)-s.order.indexOf(u)}).map(function(u){let o=s.labels[u]||u;return o=o[0].toUpperCase()+(o.slice(1)||"")})});return dt[h]=t}function jS(n,i){let h=Dc(n,i),s=Hn[i]||Hn.win;return h[Xo]||(h[Xo]=h.map(function(t){return t.join(s.sep)}).join(" "))}function AS(n,i){let h=Dc(n,i),s=Hn[i]||Hn.win;return h[zo]||(h[zo]=h.map(function(t){return"<kbd>"+t.map(function(l){return"<kbd>"+l+"</kbd>"}).join("")+"</kbd>"}).join(" "))}var In={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},Qo={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ho={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},Zo={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},ki;for(Cn=1;Cn<20;++Cn)In[111+Cn]="f"+Cn;var Cn;for(Cn=0;Cn<=9;++Cn)In[Cn+96]=Cn.toString();function Tt(n,i,h){if(n.addEventListener){n.addEventListener(i,h,!1);return}n.attachEvent("on"+i,h)}function Nt(n,i,h){if(n.removeEventListener){n.removeEventListener(i,h,!1);return}n.detachEvent("on"+i,h)}function Jo(n){if(n.type=="keypress"){var i=String.fromCharCode(n.which);return n.shiftKey||(i=i.toLowerCase()),i}return In[n.which]?In[n.which]:Qo[n.which]?Qo[n.which]:String.fromCharCode(n.which).toLowerCase()}function xS(n,i){return n.sort().join(",")===i.sort().join(",")}function DS(n){var i=[];return n.shiftKey&&i.push("shift"),n.altKey&&i.push("alt"),n.ctrlKey&&i.push("ctrl"),n.metaKey&&i.push("meta"),i}function IS(n){if(n.preventDefault){n.preventDefault();return}n.returnValue=!1}function _S(n){if(n.stopPropagation){n.stopPropagation();return}n.cancelBubble=!0}function qt(n){return n=="shift"||n=="ctrl"||n=="alt"||n=="meta"}function $S(){if(!ki){ki={};for(var n in In)n>95&&n<112||In.hasOwnProperty(n)&&(ki[In[n]]=n)}return ki}function kS(n,i,h){return h||(h=$S()[n]?"keydown":"keypress"),h=="keypress"&&i.length&&(h="keydown"),h}function pS(n){return n==="+"?["+"]:(n=n.replace(/\+{2}/g,"+plus"),n.split("+"))}function Wo(n,i){var h,s,t,l=[];for(h=pS(n),t=0;t<h.length;++t)s=h[t],Zo[s]&&(s=Zo[s]),i&&i!="keypress"&&Ho[s]&&(s=Ho[s],l.push("shift")),qt(s)&&l.push(s);return i=kS(s,l,i),{key:s,modifiers:l,action:i}}function Ic(n,i){return n===null||n===document?!1:n===i?!0:Ic(n.parentNode,i)}function p(n){var i=this;if(n=n||document,!(i instanceof p))return new p(n);i.handleKeyEvent=r,i.target=n,i._callbacks={},i._directMap={};var h={},s,t=!1,l=!1,u=!1;function o(m){m=m||{};var E=!1,w;for(w in h){if(m[w]){E=!0;continue}h[w]=0}E||(u=!1)}function c(m,E,w,v,F,T){var L,N,K=[],O=w.type;if(!i._callbacks[m])return[];for(O=="keyup"&&qt(m)&&(E=[m]),L=0;L<i._callbacks[m].length;++L)if(N=i._callbacks[m][L],!(!v&&N.seq&&h[N.seq]!=N.level)&&O==N.action&&(O=="keypress"&&!w.metaKey&&!w.ctrlKey||xS(E,N.modifiers))){var C=!v&&N.combo==F,Y=v&&N.seq==v&&N.level==T;(C||Y)&&i._callbacks[m].splice(L,1),K.push(N)}return K}function f(m,E,w,v){i.stopCallback(E,E.target||E.srcElement,w,v)||m(E,w)===!1&&(IS(E),_S(E))}i._handleKey=function(m,E,w){var v=c(m,E,w),F,T={},L=0,N=!1;for(F=0;F<v.length;++F)v[F].seq&&(L=Math.max(L,v[F].level));for(F=0;F<v.length;++F){if(v[F].seq){if(v[F].level!=L)continue;N=!0,T[v[F].seq]=1,f(v[F].callback,w,v[F].combo,v[F].seq);continue}N||f(v[F].callback,w,v[F].combo)}var K=w.type=="keypress"&&l;w.type==u&&!qt(m)&&!K&&o(T),l=N&&w.type=="keydown"};function r(m){typeof m.which!="number"&&(m.which=m.keyCode);var E=Jo(m);if(E){if(m.type=="keyup"&&t===E){t=!1;return}i.handleKey(E,DS(m),m)}}function e(){clearTimeout(s),s=setTimeout(o,1000)}function S(m,E,w,v){h[m]=0;function F(O){return function(){u=O,++h[m],e()}}function T(O){f(w,O,m),v!=="keyup"&&(t=Jo(O)),setTimeout(o,10)}for(var L=0;L<E.length;++L){var N=L+1===E.length,K=N?T:F(v||Wo(E[L+1]).action);b(E[L],K,v,m,L)}}function b(m,E,w,v,F){i._directMap[m+":"+w]=E,m=m.replace(/\s+/g," ");var T=m.split(" "),L;if(T.length>1){S(m,T,E,w);return}L=Wo(m,w),i._callbacks[L.key]=i._callbacks[L.key]||[],c(L.key,L.modifiers,{type:L.action},v,m,F),i._callbacks[L.key][v?"unshift":"push"]({callback:E,modifiers:L.modifiers,action:L.action,seq:v,level:F,combo:m})}i._bindMultiple=function(m,E,w){for(var v=0;v<m.length;++v)b(m[v],E,w)},i.enable=function(){Tt(n,"keypress",r),Tt(n,"keydown",r),Tt(n,"keyup",r)},i.disable=function(){Nt(n,"keypress",r),Nt(n,"keydown",r),Nt(n,"keyup",r)},i.enable()}p.prototype.bind=function(n,i,h){var s=this;return n=n instanceof Array?n:[n],s._bindMultiple.call(s,n,i,h),s};p.prototype.unbind=function(n,i){var h=this;return h.bind.call(h,n,function(){},i)};p.prototype.trigger=function(n,i){var h=this;return h._directMap[n+":"+i]&&h._directMap[n+":"+i]({},n),h};p.prototype.reset=function(){var n=this;return n._callbacks={},n._directMap={},n};p.prototype.stopCallback=function(n,i){var h=this;return(" "+i.className+" ").indexOf(" mousetrap ")>-1||Ic(i,h.target)?!1:i.tagName=="INPUT"||i.tagName=="SELECT"||i.tagName=="TEXTAREA"||i.isContentEditable};p.prototype.handleKey=function(){var n=this;return n._handleKey.apply(n,arguments)};p.addKeycodes=function(n){for(var i in n)n.hasOwnProperty(i)&&(In[i]=n[i]);ki=null};p.init=function(){var n=p(document);for(var i in n)i.charAt(0)!=="_"&&(p[i]=function(h){return function(){return n[h].apply(n,arguments)}}(i))};function Gi(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}function aS(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var Ft=Symbol.for("#updateHotKeys"),nb=Symbol.for("#context"),ib=Symbol.for("#inInput"),gt=Symbol.for("#inEditable"),hb=Symbol.for("#hotkeyTarget"),_c=Symbol.for("#hotkeyCombos"),Ci=Symbol.for("#hotkeyHandlers"),oi=Symbol.for("#combos"),sb=Symbol.for("#extendType"),Pt=Symbol.for("#target"),Bo=Symbol.for("#defaultPrevented"),tb=Symbol.for("#stopPropagation"),lb=Symbol.for("#visit"),Mo=Symbol.for("#key"),ub;try{ub=(globalThis.navigator.platform||"").match(/iPhone|iPod|iPad|Mac/)}catch{}var Vt={esc:!0},ob=Symbol(),$c=class extends Qn{αfocus(n){let i=this[nb].element,h=i.ownerDocument;return n&&(i=i.querySelector(n)||i.closest(n)||h.querySelector(n)),i==h.body?h.activeElement!=h.body&&h.activeElement.blur():i.focus(),!0}αlocal(){return!0}αrepeat(){return!0}},cb=$c;(()=>{d($c,ob,"HotkeyEvent",0)})();var fb=function(n,i,h){return i.tagName=="INPUT"&&(h=="down"||h=="up")?!1:i.tagName=="INPUT"||i.tagName=="SELECT"||i.tagName=="TEXTAREA"?Vt[h]?(n[ib]=!0,n[gt]=!0,!1):!0:i.contentEditable&&(i.contentEditable=="true"||i.contentEditable=="plaintext-only")?Vt[h]?(n[gt]=!0,!1):!0:!1},rb=Symbol(),kc=class{constructor(){this.combos={"*":{}},this.identifiers={},this.labels={},this.handler=this.handle.bind(this),this.mousetrap=null,this.hothandler=this.handle.bind(this)}addKeycodes(n){return p.addKeycodes(n)}trigger(n){var i,h;return(h=(i=this.mousetrap)==null?void 0:i.trigger)==null?void 0:h.call(i,n)}register(n,i={}){return this.mousetrap||(this.mousetrap=p(globalThis.document),this.mousetrap.stopCallback=fb),this.combos[n]||(this.combos[n]=!0,this.mousetrap.bind(n,this.handler)),(i.capture||i.force)&&(Vt[n]=!0),this}comboIdentifier(n){var i;return(i=this.identifiers)[n]||(i[n]=n.replace(/\+/g,"_").replace(/\ /g,"-").replace(/\*/g,"all").replace(/\|/g," "))}humanize(n,i="auto"){return jS(n,i)}htmlify(n,i="auto"){return AS(n,i)}matchCombo(n){return!0}handleEvent(n){var i,h;return(h=(i=this.mousetrap)==null?void 0:i.handleKeyEvent)==null?void 0:h.call(i,n)}handle(n,i){var h;let s=n.target&&n.target[hb]||n.target||globalThis.document.body,t=Array.from(globalThis.document.querySelectorAll("[data-hotkey]")),l=s.ownerDocument,u=s,o=[];for(;u&&u!=l&&u.hotkeys!==!0;)u=u.parentNode;t=t.reverse().filter(function(S){let b=S[_c],m=b&&b[i],E=b&&b["*"];if(!(m||E))return!1;let w=S[Ci],v=S;for(;v&&v!=l;){if(v.hotkeys===!1)return!1;if(v.hotkeys===!0&&!v.contains(s)){let F=!0;for(let T=0,L=Gi(w),N=L.length;T<N;T++){let K=L[T];(K[oi][i]||K[oi]["*"])&&K.globalΦ&&(F=!1)}if(F)return!1}v=v.parentNode}return!0});let c=globalThis.document.activeElement;if(t.length>1){let S=t.filter(function(m){return c.contains(m)});S.length&&(t=S);let b=t.filter(function(m){try{return!m.hiddenΦ}catch{}});b.length>0&&(t=b)}if(!t.length)return;let f={combo:i,originalEvent:n,targets:t},r=new Qn("hotkey",{bubbles:!0,detail:f});r[sb](cb),r.originalEvent=n,r.hotkey=i,s.dispatchEvent(r);for(let S=0,b=Gi(t),m=b.length;S<m;S++){let E=b[S];for(let w=0,v=Gi(E[Ci]),F=v.length;w<F;w++){let T=v[w];if(T[oi][i]||T[oi]["*"]){if(T.params.local&&!T[Pt].contains(s)||T.params.unobstructed&&!E.unobstructedΦ)continue;if(!n[gt]||T.captureΦ||T.params.force){let L=T[Pt];(u&&(u.contains(L)||L.contains(u))||T.globalΦ)&&o.push(T)}}}}let e=[];for(let S=0,b=Gi(o),m=b.length;S<m;S++){let E=b[S],w;(!n.repeat||E.params.repeat)&&(w=E.handleEvent(r));let v=E.lastState||{};if(e.push(v),(!E.passiveΦ&&v.called||r[Bo])&&((h=n==null?void 0:n.preventDefault)==null||h.call(n)),!(E.passiveΦ||v.called==!1&&!r[tb]&&!r[Bo]))break}return e}},eb=kc;(()=>{d(kc,rb,"HotKeyManager",16)})();var mb=new eb,pc=function(n,i){let h=i.element;aS(h,a)&&(h.matches("input,textarea,select,option")?h.focus():h.click())};pc.passive=!0;var Sb=Symbol(),bb=class{on$hotkey(n,i,h,s){var t=this;return this[Ci]||(this[Ci]=[]),this[Ci].push(h),h[Pt]=this,n.$_||(n.$_=[pc]),n[lb]=function(){return t[Ft]()},this[Ft](),h}[Ft](){let n={};for(let i=0,h=Gi(this[Ci]),s=h.length;i<s;i++){let t=h[i],l=t.params,u=l.options[0];if(t[Mo]!=u&&(t[Mo]=u,!0)){t[oi]={};for(let o=0,c=Gi(u.split("|")),f=c.length;o<f;o++){let r=c[o];mb.register(r,l),t[oi][r]=!0}}Object.assign(n,t[oi])}return this[_c]=n,this.dataset.hotkey=Object.keys(n).join(" "),this}};(()=>{d(bb,Sb,"Element",1,a)})();var zi=typeof Reflect=="object"?Reflect:null,Ro=zi&&typeof zi.apply=="function"?zi.apply:function(n,i,h){return Function.prototype.apply.call(n,i,h)},ph;zi&&typeof zi.ownKeys=="function"?ph=zi.ownKeys:Object.getOwnPropertySymbols?ph=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:ph=function(n){return Object.getOwnPropertyNames(n)};function Eb(n){console&&console.warn&&console.warn(n)}var ac=Number.isNaN||function(n){return n!==n};function z(){z.init.call(this)}z.EventEmitter=z;z.prototype._events=void 0;z.prototype._eventsCount=0;z.prototype._maxListeners=void 0;var Uo=10;function vs(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(z,"defaultMaxListeners",{enumerable:!0,get:function(){return Uo},set:function(n){if(typeof n!="number"||n<0||ac(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");Uo=n}});z.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};z.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||ac(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function nf(n){return n._maxListeners===void 0?z.defaultMaxListeners:n._maxListeners}z.prototype.getMaxListeners=function(){return nf(this)};z.prototype.emit=function(n){for(var i=[],h=1;h<arguments.length;h++)i.push(arguments[h]);var s=n==="error",t=this._events;if(t!==void 0)s=s&&t.error===void 0;else if(!s)return!1;if(s){var l;if(i.length>0&&(l=i[0]),l instanceof Error)throw l;var u=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw u.context=l,u}var o=t[n];if(o===void 0)return!1;if(typeof o=="function")Ro(o,this,i);else for(var c=o.length,f=uf(o,c),h=0;h<c;++h)Ro(f[h],this,i);return!0};function hf(n,i,h,s){var t,l,u;if(vs(h),l=n._events,l===void 0?(l=n._events=Object.create(null),n._eventsCount=0):(l.newListener!==void 0&&(n.emit("newListener",i,h.listener?h.listener:h),l=n._events),u=l[i]),u===void 0)u=l[i]=h,++n._eventsCount;else if(typeof u=="function"?u=l[i]=s?[h,u]:[u,h]:s?u.unshift(h):u.push(h),t=nf(n),t>0&&u.length>t&&!u.warned){u.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=n,o.type=i,o.count=u.length,Eb(o)}return n}z.prototype.addListener=function(n,i){return hf(this,n,i,!1)};z.prototype.on=z.prototype.addListener;z.prototype.prependListener=function(n,i){return hf(this,n,i,!0)};function vb(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function sf(n,i,h){var s={fired:!1,wrapFn:void 0,target:n,type:i,listener:h},t=vb.bind(s);return t.listener=h,s.wrapFn=t,t}z.prototype.once=function(n,i){return vs(i),this.on(n,sf(this,n,i)),this};z.prototype.prependOnceListener=function(n,i){return vs(i),this.prependListener(n,sf(this,n,i)),this};z.prototype.removeListener=function(n,i){var h,s,t,l,u;if(vs(i),s=this._events,s===void 0)return this;if(h=s[n],h===void 0)return this;if(h===i||h.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete s[n],s.removeListener&&this.emit("removeListener",n,h.listener||i));else if(typeof h!="function"){for(t=-1,l=h.length-1;l>=0;l--)if(h[l]===i||h[l].listener===i){u=h[l].listener,t=l;break}if(t<0)return this;t===0?h.shift():wb(h,t),h.length===1&&(s[n]=h[0]),s.removeListener!==void 0&&this.emit("removeListener",n,u||i)}return this};z.prototype.off=z.prototype.removeListener;z.prototype.removeAllListeners=function(n){var i,h,s;if(h=this._events,h===void 0)return this;if(h.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):h[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete h[n]),this;if(arguments.length===0){var t=Object.keys(h),l;for(s=0;s<t.length;++s)l=t[s],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=h[n],typeof i=="function")this.removeListener(n,i);else if(i!==void 0)for(s=i.length-1;s>=0;s--)this.removeListener(n,i[s]);return this};function tf(n,i,h){var s=n._events;if(s===void 0)return[];var t=s[i];return t===void 0?[]:typeof t=="function"?h?[t.listener||t]:[t]:h?db(t):uf(t,t.length)}z.prototype.listeners=function(n){return tf(this,n,!0)};z.prototype.rawListeners=function(n){return tf(this,n,!1)};z.listenerCount=function(n,i){return typeof n.listenerCount=="function"?n.listenerCount(i):lf.call(n,i)};z.prototype.listenerCount=lf;function lf(n){var i=this._events;if(i!==void 0){var h=i[n];if(typeof h=="function")return 1;if(h!==void 0)return h.length}return 0}z.prototype.eventNames=function(){return this._eventsCount>0?ph(this._events):[]};function uf(n,i){for(var h=new Array(i),s=0;s<i;++s)h[s]=n[s];return h}function wb(n,i){for(;i+1<n.length;i++)n[i]=n[i+1];n.pop()}function db(n){for(var i=new Array(n.length),h=0;h<i.length;++h)i[h]=n[h].listener||n[h];return i}function Lt(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var Kt=Symbol.for("#getQueryParam"),qo=Symbol.for("#setQueryParam"),go=Symbol.for("#query"),Tb=Symbol(),hh=class{static parse(n,i){return Lt(n,hh)?n:new hh(n,i)}constructor(n,i){this.router=i,this.parse(n)}parse(n){var i;let h;return Lt(n,URL)||(n=new URL(n,this.router.origin)),(h=(i=this.router)==null?void 0:i.aliases[n.pathname])&&(n.pathname=h),this.url=n,this}get activeΦ(){return this.router.location==this}reparse(){return this.parse(this.url)}get searchParams(){return this.url.searchParams}search(){let n=this.searchParams?this.searchParams.toString():"";return n?"?"+n:""}update(n){if(Lt(n,Object))for(let i=0,h=Object.keys(n),s=h.length,t,l;i<s;i++)t=h[i],l=n[t],this.searchParams.set(t,l);else typeof n=="string"&&this.parse(n);return this}clone(){return new hh(this.url.href,this.router)}equals(n){return this.toString()==String(n)}get href(){return this.url.href}get path(){return this.url.href.slice(this.url.origin.length)}get pathname(){return this.url.pathname}get query(){return this[go]||(this[go]=new Proxy({},{get:this[Kt].bind(this),set:this[qo].bind(this)}))}toString(){return this.href}[Kt](n,i){return this.searchParams.get(i)}[qo](n,i,h){var s;let t=(s=this[Kt](n,i))!=null?s:"";return h=h!=null?h:"",t!=h&&(h==null||h==""?this.searchParams.delete(i):this.searchParams.set(i,h),this.activeΦ&&(this.router.history.replaceState({},null,this.path),this.router.touch())),!0}},ah=hh;(()=>{d(hh,Tb,"Location",16)})();function Po(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}function Nb(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}function sl(){return function(){return!0}}var Fb=Symbol(),sh=class{constructor(n,i=""){this.store=n||{},this.cache={raw:{},rich:{}},this.ns=i,this.local=n==globalThis.sessionStorage,this.children=new Map}serialize(n,i){return JSON.stringify(n)}deserialize(n,i){return JSON.parse(n)}getItem(n){let i=String(this.ns)+":"+n;if(Po(this.store,sh))return this.store.getItem(i);if(this.local&&this.cache.rich[i]!=null)return this.cache.rich[i];let h=this.store.getItem(i);if(h!=null)return this.cache.raw[i]==h?this.cache.rich[i]:(this.cache.raw[i]=h,this.cache.rich[i]=this.deserialize(h,i))}setItem(n,i){var h,s;let t=String(this.ns)+":"+n;if(Po(this.store,sh))return this.store.setItem(t,i);let l=this.cache.rich[t],u=typeof i;if(this.local&&(this.cache.rich[t]=i),l!==i||u=="object"){let o=this.store.getItem(t);if(i==null)return this.store.removeItem(t),h=this.cache.rich[t],delete this.cache.rich[t],s=this.cache.raw[t],delete this.cache.raw[t],q();{let c=this.serialize(i,t);if(this.cache.rich[t]=i,this.cache.raw[t]=c,o!=c)return this.store.setItem(t,c),q()}}}removeItem(n){var i;let h=String(this.ns)+":"+n;return i=this.cache[h],delete this.cache[h],this.store.removeItem(h)}get(n,i,h){return this.getItem(i)}set(n,i,h,s){return this.setItem(i,h),!0}apply(n,i,[h]){let s=this.children.get(h);return s||this.children.set(h,s=new Proxy(sl(),new sh(this,h))),s}deleteProperty(n,i){return this.removeItem(i),!0}ownKeys(n){let i=["prototype"],h=this.ns+":";for(let s=0,t=Nb(Object.keys(this.store)),l=t.length;s<l;s++){let u=t[s];u.indexOf(h)==0&&i.push(u.slice(h.length))}return i}},of=sh;(()=>{d(sh,Fb,"Storage",16)})();var Zi=new Proxy(sl(),new of(globalThis.localStorage)),Lb=new Proxy(sl(),new of(globalThis.sessionStorage));function Kb(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var Di=Symbol.for("#states"),Vo=new WeakMap,Ob=Symbol(),cf=class{static from(n,i){return i?new this(n,i):null}constructor(n,i,h=!1){Vo.set(this,n),this.path=i.path,this.data=i.data||{},this.index=i.index,this.type=i.type,this.local=h}get history(){return Vo.get(this)}get next(){return this.history.at(this.index+1)}get prev(){return this.history.at(this.index-1)}toJSON(){return{path:this.path,data:this.data,index:this.index,type:this.type}}save(){return this.history.cache[this.index]=this,this}toString(){return""+this.history.id+"|"+this.index}},Ot=cf;(()=>{d(cf,Ob,"State",16)})();var yb=Symbol(),ff=class{constructor(n){this.router=n,this.store=Lb("router"),this[Di]=[],this.cache={},this.index=-1;let i=globalThis.history.state,h;if(typeof i=="string"){let s=i.split("|");this.id=parseInt(s[0]),this.index=parseInt(s[1]),this.cache=this.store(this.id)}else this.id=this.store.id=(this.store.id||0)+1,this.cache=this.store(this.id);this.index==-1&&this.replaceState({initial:!0},null,n.path)}get length(){return this.cache.length}get state(){return this.at(this.index)}get states(){let n=this.length,i=0;for(;i<n;)this.at(i++);return this[Di]}get currentStates(){return this.states.slice(0,this.length)}get next(){return this.state.next}get prev(){return this.state.prev}slice(n,i=this.length){let h=[];for(;n<i;)h.push(this.at(n++));return h}at(n){var i;if(!(n>=this.length))return(i=this[Di])[n]||(i[n]=Ot.from(this,this.cache[n]))}buildState(n,i,h=!0){let s={data:n,index:this.index+1,path:i||this.router.path,type:h?"push":"replace"};return new Ot(this,s,!0)}pushState(n,i,h,s=!0){return Kb(n,Ot)||(n=this.buildState(n,h,s)),this.index=n.index,this.cache[this.index]=n,this[Di][this.index]=n,this[Di].length=this.cache.length=Math.max(n.index+1,0),globalThis.history[s?"pushState":"replaceState"](String(n),i||null,n.path),this}replaceState(n,i,h){return this.pushState(n,i,h,!1)}},Gb=ff;(()=>{d(ff,yb,"History",16)})();var Cb=Symbol(),rf=class{constructor(n,i,h,s){this.params=s,this.router=n,i&&(this.location=ah.parse(i),this.original=this.location.clone()),this.referrer=h}get apply(){return this.params.apply||[]}get revert(){return this.params.revert||[]}get state(){return this.params.state}get mode(){return this.params.mode}redirect(n){var i,h;return(h=(i=this.location)==null?void 0:i.update)==null||h.call(i,n),this}get path(){var n;return(n=this.location)==null?void 0:n.path}get url(){var n,i;return(i=(n=this.location)==null?void 0:n.toString)==null?void 0:i.call(n)}set path(n){this.location.path=n}abort(n=!1){return this.aborted=!0,n&&(this.forceAbort=n),this}match(n){return this.location?this.router.route(n).match(this.path):null}},jo=rf;(()=>{d(rf,Cb,"Request",16)})();function Ao(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var rs=Symbol.for("#routes"),yt=Symbol.for("#match"),Yb=Symbol.for("#symbol"),xo=Symbol.for("#matches"),Gt=new Map,Ct={},Do={},Xb=/.*/;function zb(n){if(!Gt.has(n)){let i=new Map;return Gt.set(n,i),i}return Gt.get(n)}function Qb(n,i){let h=zb(n);if(!h.has(i)){let s=Object.create(n);return Object.assign(s,i),h.set(i,s),s}return h.get(i)}var Hb=Symbol(),ef=class{},Zb=ef;(()=>{d(ef,Hb,"Match",0)})();function Jb(n){if(Ct[n])return Ct[n];let i=Ct[n]={url:n},h=n.indexOf("?"),s=n.indexOf("#");if(s>=0&&(i.hash=n.slice(s+1),n=i.url=n.slice(0,s)),h>=0){let t=i.query=n.slice(h+1);n=n.slice(0,h),i.query=Do[t]||(Do[t]=new URLSearchParams(t))}return i.path=n,i}var Wb=Symbol(),mf=class{constructor(n){this.router=n,this.fullPath="",this[rs]={},this[yt]=new Zb,this[yt].path=""}route(n){var i;return(i=this[rs])[n]||(i[n]=new Rb(this.router,n,this))}match(){return this[yt]}resolve(n){return"/"}},Bb=mf;(()=>{d(mf,Wb,"RootRoute",16)})();var Mb=Symbol(),tl=class{constructor(n,i,h){this.parent=h||n.rootRoute,this.router=n,this.status=200,this.path=i,this[Yb]=Symbol(),this[xo]={},this[rs]={}}route(n){var i;return(i=this[rs])[n]||(i[n]=new tl(this.router,n,this))}get fullPath(){return""+this.parent.fullPath+"/"+this.$path}load(n){return this.router.queue.add(n)}set path(n){var i=this;if(this.$path==n)return;if(this.raw=n,this.$path=n,this.groups=[],this.cache={},this.dynamic=!1,n.indexOf("?")>=0){let s=n.split("?");n=s.shift(),this.query={};for(let t=0,l=Ao(s.join("?").split("&")),u=l.length;t<u;t++){let o=l[t];if(!o)continue;let[c,f]=o.split("=");c[0]=="!"&&(this.dynamic=!0,c=c.slice(1),f=!1),f===""&&(f=!1),f&&f[0]==":"&&(this.dynamic=!0),this.query[c]=f||f!==!1}}if(n=n.replace(/\:(\w+|\*)(\.)?/g,function(s,t,l){i.dynamic=!0,t!="*"&&i.groups.push(t);let u=i.router.matchers[t]||(l?"([^/#.?]+)":"([^/#?]+)");return l?""+u+".":u}),n==""&&this.query)return;if(n=="*")return this.regex=Xb,this;n="^"+n;let h=n[n.length-1];(h=="$"||h=="/")&&(n=n.slice(0,-1)+"(?=/?[#?]|/?$)"),h!="/"&&h!="$"&&n!="^/"&&(n=n+"(?=[/#?]|$)"),this.regex=new RegExp(n)}match(n=this.router.path){var i,h,s;let t,l=this.parent.match(n);if(!l)return null;let u=Jb(n),o=u.url,c="";if(l.path&&u.path.indexOf(l.path)==0&&(c=l.path+"/",o=o.slice(c.length)),t=this.regex?o.match(this.regex):[""]){let f=c+t[0],r=[this.$path],e={};if(this.groups.length)for(let m=0,E=Ao(t),w=E.length,v;m<w;m++){let F=E[m];(v=this.groups[m-1])&&(e[v]=F,r.push(F))}if(this.query)for(let m=this.query,E=0,w=Object.keys(m),v=w.length,F,T;E<v;E++){F=w[E],T=m[F];let L=F,N=(h=(i=u.query)==null?void 0:i.get)==null?void 0:h.call(i,F);if(T===!1){if(N)return null;r.push("1");continue}if(T[0]==":"&&(L=T.slice(1),T=!0),T==!0&&N||T==N)e[L]=N,r.push(N);else return null}let S=r.join("*");e=(s=this[xo])[S]||(s[S]=e);let b=Qb(l,e);return b.path=f,b}return null}resolve(n=this.router.path){if(this.raw[0]=="/"&&!this.dynamic)return this.raw.replace(/\$/g,"");let i=this.parent.match(n),h=this.parent.resolve(n),s;if(this.dynamic){let t=this.match(n);return t?t.path:null}return this.raw[0]=="?"?s=(h||"/")+this.raw:s=h+"/"+this.raw,s.replace(/\$/g,"").replace(/\/\/+/g,"/")}},Rb=tl;(()=>{d(tl,Mb,"Route",16)})();function Sf(n,i){var h;return typeof i=="string"?typeof n===i:(h=i[Symbol.hasInstance])==null?void 0:h.call(i,n)}var jt=Symbol.for("#enter"),At=Symbol.for("#resolved"),es=Symbol.for("#leave"),Io=Symbol.for("#afterVisitRouted"),_o=Symbol.for("#afterVisitRouteTo"),Ki=Symbol.for("#doc"),qn=Symbol.for("#version"),Ub=Symbol.for("#routes"),$o=Symbol.for("#origin"),Yt=Symbol.for("#request"),Ii=Symbol.for("#hash"),en=Symbol.for("#routeTo"),_i=Symbol.for("#path"),yn=Symbol.for("#match"),th=Symbol.for("#options"),qb=Symbol.for("#cache"),ko=Symbol.for("#unmatched"),Dn=Symbol.for("#active"),gb=Symbol.for("#resolvedPath"),Pb=Symbol.for("#dataKey"),Vb=Symbol.for("#activeKey"),lh=Symbol.for("#urlKey"),Oi=Symbol.for("#dataMap"),yi=Symbol.for("#href"),k=Symbol.for("#route"),po=Symbol.for("#context"),ao=Symbol.for("#afterVisit"),nc=Symbol.for("#routeHandler"),jb=Symbol.for("#parentNode"),Ab=Symbol.for("#visitContext"),ic=Symbol.for("##visitContext"),xb=Symbol.for("#attachToParent"),Db=Symbol.for("#detachFromParent"),hc=Symbol.for("#router");var Dd=ue(function(){return globalThis.document.router}),Ib=Symbol(),bf=class extends z{constructor(n,i={}){super(),this[Ki]=n,this[qn]=0,this[Ub]={},this.aliases={},this.redirects={},this.rules={},this.matchers={},this.options=i,this.busy=[],this.queue=new Le,this.root=new Bb(this),this.location=new ah(i.url||n.location.href,this),this.history=new Gb(this),this.mode=i.mode||"history",this.queue.on("busy",function(){return globalThis.document.flags.incr("_routing_")}),this.queue.on("idle",function(){return globalThis.document.flags.decr("_routing_"),q()}),this.setup()}get origin(){return this[$o]||(this[$o]=this[Ki].location.origin)}get query(){return this.location.query}init(){return this.refresh({mode:"replace"}),this}alias(n,i){return this.aliases[n]=i,this.location.reparse(),this}touch(){return this[qn]++}option(n,i){return i==null?this.options[n]:(this.options[n]=i,this)}get realpath(){let n=this[Ki].location;return n.href.slice(n.origin.length)}get state(){return this.history.state}get states(){return this.history.currentStates}set state(n){this.state.data=n,this.state.save()}get ctx(){return this[Yt]}pushState(n,i,h){return this.history.pushState(n,i||null,String(h))}replaceState(n,i,h){return this.history.replaceState(n,i||null,String(h))}refresh(n={}){var i=this;if(this.refreshing)return;this.refreshing=!0;let h=this.location,s=ah.parse(n.location||this.realpath,this),t=n.mode,l=this[Yt];if(!s.equals(h)||!l||n.state){let u=new jo(this,s,h,n);this[Yt]=u,this.emit("beforechange",u),u.aborted&&(!u.forceAbort&&globalThis.window.confirm("Are you sure you want to leave? You might have unsaved changes")?u.aborted=!1:t=="pop"?this.pushState(this.state,null,String(h)):t=="replace"&&this.replaceState(this.state,null,String(h))),u.aborted||(this.location=u.location,t=="push"?this.pushState(u.state,null,String(this.location)):t=="replace"?this.replaceState(u.state,null,String(this.location)):t=="pop"&&(this.history.index=n.index),this.refreshing=!1,this.emit("change",u),this.touch(),q())}return D.add(function(){let u=i[Ki].location.hash;if(u!=i[Ii])return i.emit("hashchange",i[Ii]=u)}),this.refreshing=!1,this}onpopstate(n){let i=this.history.index,h=i,s={pop:!0,index:0,from:i,mode:"pop"};try{if(typeof n.state=="string"){let[t,l]=n.state.split("|");h=s.index=parseInt(l),h<i?s.revert=this.history.slice(h+1,i+1).reverse():h>i&&(s.apply=this.history.slice(i+1,h+1))}}catch{}return this.refresh(s),this}onbeforeunload(n){let i=new jo(this,null,this.location,{mode:"unload"});if(this.emit("beforechange",i),i.aborted)return!0}onhashchange(n){return this.emit("hashchange",this[Ii]=this[Ki].location.hash),q()}setup(){this.onclick=this.onclick.bind(this),this.onhashchange=this.onhashchange.bind(this);let n=globalThis.window;return this[Ii]=this[Ki].location.hash,this.location=ah.parse(this.realpath,this),n.onpopstate=this.onpopstate.bind(this),n.onbeforeunload=this.onbeforeunload.bind(this),n.addEventListener("hashchange",this.onhashchange),n.addEventListener("click",this.onclick,{capture:!0}),n.document.documentElement.emit("routerinit",this),this.refresh,this}onclick(n){if(n.metaKey||n.altKey)return;let i=null,h=null,s=n.target;for(;s&&(!i||!h);)!i&&s.nodeName=="A"&&(i=s),!h&&s[en]&&(h=s),s=s.parentNode;if(i&&h!=i&&(!h||h.contains(i))){let t=i.getAttribute("href");t&&!t.match(/\:\/\//)&&(!i.getAttribute("target")||i.getAttribute("target")=="_self")&&!i.classList.contains("external")&&i.addEventListener("click",this.onclicklink.bind(this),{once:!0})}return!0}onclicklink(n){let i=n.currentTarget||n.target;i[en]&&i[en].resolve();let h=i.getAttribute("href"),s=new URL(i.href),t=s.href.slice(s.origin.length),l=this.realpath.split("#")[0],u=t.split("#")[0];return l==u?globalThis.document.location.hash=s.hash:i[en]?i[en].go():this.go(t),n.stopPropagation(),n.preventDefault()}get url(){return this.location.url}get path(){let n=this.location.path;return this.aliases[n]||n}get pathname(){return this.location.pathname}serializeParams(n){var i;if(Sf(n,Object)){i=[];for(let h=0,s=Object.keys(n),t=s.length,l,u;h<t;h++)l=s[h],u=n[l],i.push([l,globalThis.encodeURI(u)].join("="));return i.join("&")}return n||""}get hash(){return this[Ii]}set hash(n){let i="#"+this.serializeParams(n);globalThis.history.replaceState(this.state,null,i)}match(n){return this.route(n).match(this.path)}route(n){return this.root.route(n)}go(n,i=null){if(typeof n=="object"&&i===null&&(i=n,n=this.path),typeof n=="number")return globalThis.history.go(n),this;let h=this.location.clone().update(n),s=this.history.buildState(i,h.path,!0);return this.refresh({push:!0,mode:"push",location:h,state:s,apply:[s]}),this}replace(n,i=null){typeof n=="object"&&i===null&&(i=n,n=this.path);let h=this.location.clone().update(n),s=this.history.buildState(i,h.path,!1);return this.refresh({replace:!0,mode:"replace",location:h,state:s,apply:[s]})}},_b=bf;(()=>{d(bf,Ib,"Router",16)})();var $b=Symbol(),Ef=class{constructor(n,i,h,s={}){this.parent=h,this.node=n,this[_i]=i,this[yn]=null,this[th]=s,this[qb]={},this[ko]={},this[Dn]=null,this[gb]=null,this[Pb]=Symbol(),this[Vb]=Symbol(),this[lh]=Symbol()}get router(){return this.node.ownerDocument.router}get route(){return(this.parent?this.parent.route:this.router).route(this[_i])}get match(){return this[yn]}get params(){return this[yn]||this[ko]}get state(){let n=this[Oi]||(this[Oi]=new Map),i=this.params,h=this[Oi].get(i);return h||this[Oi].set(i,h={}),h}set state(n){(this[Oi]||(this[Oi]=new Map)).set(this.params,n)}set path(n){this[_i]!=n&&(this[_i]=n,!0)&&this.router.touch()}get path(){return this[_i]}get isActive(){return!!this[Dn]}get activeΦ(){return!!this[Dn]}resolve(){let n=this.router[qn];if(!(this[qn]!=n&&(this[qn]=n,!0)))return;let i=this.route,h=this[th],s=this.router.path,t=i.match(s),l=this[Dn],u=this[yn],o=t!=u,c=t&&t[this[lh]];return t&&(this[Dn]=!0,this[yn]=t,t[this[lh]]=s),t&&(o||c!=s||!l)&&this[At](t,u,c),!l&&t&&this[jt](),!t&&(l||l===null)&&(this[Dn]=!1,this[es]()),this[yn]}[jt](){var n,i;return this.node.flags.remove("not-routed"),this.node.flags.add("routed"),(i=(n=this.node)==null?void 0:n.routeDidEnter)==null?void 0:i.call(n,this)}[At](n,i,h=""){var s,t;return(t=(s=this.node)==null?void 0:s.routeDidResolve)==null?void 0:t.call(s,this,n,i,h)}[es](){var n,i;return this.node.flags.add("not-routed"),this.node.flags.remove("routed"),(i=(n=this.node)==null?void 0:n.routeDidLeave)==null?void 0:i.call(n,this)}},vf=Ef;(()=>{d(Ef,$b,"ElementRoute",16)})();var kb=Symbol(),wf=class extends vf{[jt](){return this}[At](){return this}[es](){return this}resolve(){let n=this.router[qn];if(!(this[qn]!=n&&(this[qn]=n,!0)))return;let i=this[th],h=this.route,s=this.router.path,t=this.route.resolve(s),l=this.route.match(s);l&&(this[yn]=l,this[yn][this[lh]]=s),i.sticky&&this[yn]&&(t=this[yn][this[lh]]),this[yi]!=t&&(this[yi]=t,!0)&&this.node.nodeName=="A"&&this.node.setAttribute("href",t),this.node.flags.toggle("active",!!l)}get url(){return this.resolve(),globalThis.location.origin+this[yi]}go(){return this.resolve(),this[th]&&this[th].replace?this.router.replace(this[yi]):this.router.path==this[yi]?!0:this.router.go(this[yi])}},pb=wf;(()=>{d(wf,kb,"ElementRouteTo",0)})();var ab=Symbol(),nE=class{get router(){return this.ownerDocument.router}};(()=>{d(nE,ab,"Node",1,Node)})();var iE=Symbol(),hE=class{set route(n){if(n==null)return;if(this[k]){this[k].path=n;return}let i=n[0]!="/"?this[po].route:null;this[k]=new vf(this,n,i,this.route__),this[ao]=this[Io]}get route(){return this[k]}set routeΞto(n){var i=this;if(n==null)return;if(this[en]){this[en].path=n;return}let h=n[0]!="/"?this[po].route:null;this[k]=this[en]=new pb(this,n,h,this.routeTo__),this[ao]=this[_o],this.onclick=function(s){if(!s.altKey&&!s.metaKey&&!s[nc])return s.preventDefault(),s[nc]=i[en],i[en].go()}}[Io](){if(this[k]){let n=this[jb],i=n&&n[Ab];if(i&&i.matchedRoute&&i.matchedRoute!=this[k]){this[k][Dn]!=!1&&(this[k][Dn]=!1,!0)&&(this[k][es](),this[k][qn]=-1);return}if(this[k].resolve(),this[k].activeΦ)i.matchedRoute=this[k];else return}if(this.visit&&this.visit(),this[ic])return this[ic]=null}[_o](){if(this[en]&&this[en].resolve(),this.visit)return this.visit()}routeDidEnter(n){return this[xb]()}routeDidLeave(n){return this[Db]()}routeDidResolve(n,i,h){var s=this;Sf(this.routed,Function)&&i!=h&&this.router.queue.add(async function(){s.suspend();let t=await s.routed(i,n.state,h);return s.unsuspend()})}};(()=>{d(hE,iE,"Element",1,Element)})();var sE=Symbol(),tE=class{get router(){return this[hc]||(this[hc]=new _b(this))}};(()=>{d(tE,sE,"Document",1,Document)})();function zn(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var ws=Symbol.for("##reactive"),ci=Symbol.for("##referenced"),fh=Symbol.for("##dereferenced"),jh=Symbol.for("#map"),sc=Symbol.for("#__init__"),Ah=Symbol.for("#child"),lE=Symbol.for("##spy"),$i=Symbol.for("#reactions"),Xt=Symbol.for("#promise"),W={TOUCHING:2,STALE:4,OBJECT:8,RUNNING:16,INVALIDATING:32,POSSIBLY_STALE:64,AUTORUN:128,DEACTIVATED:256},U=0;var xt=null,uE=0,df=1,Tf={META:new Map,VALUE:new Map,REF:new Map},Yn,ns={root:null,ctx:null,get context(){return X},get atomics(){return xt},get ownref(){return $n},flush(){if(X==Yn)return Yn.flush()}},$n=Symbol.for("~"),Id=Symbol.for("~~"),Nf=function(n,i){return i.has(n)||i.set(n,Symbol()),i.get(n)},Ff=function(n){return typeof n=="symbol"?Nf(n,Tf.VALUE):Symbol.for(n)};var ll=function(n){return typeof n=="symbol"?Nf(n,Tf.REF):Symbol.for("~"+n)},R=function(n,i){return U&&X.add(n[$n]),i},mn=function(n,i){return n[$n].$$invalidated(0),i},Qi=function(n,i,h){let s=n[$n];return s||(s=n[$n]=new Cf,Object.defineProperties(n,h)),i&&s.addSubscriber(i),n},ul=function(n,i){let h=n[$n];return h&&h.removeSubscriber(i),n},oE=Symbol(),Lf=class{constructor(n){this.changes=new Map,this.cleanup(),n&&this.reset(n)}reset(n=[]){return this.array=n,this.initialLength=n.length}cleanup(){return this.idx=0,this.array=null,this.changes.clear(),this.dirty=!1}push(n){if(this.initialLength==0){this.array.indexOf(n)<0&&(this.changes.set(n,1),this.array.push(n),this.idx++);return}let i=this.idx,h=this.array[i];if(h===n)++this.idx;else{if(i>0&&this.array[i-1]===n)return;let s=this.array.indexOf(n),t=this.changes.get(n);if(s===-1)this.array.splice(i,0,n),this.changes.set(n,1),this.idx++;else{if(s<i)return;s===i+1?(h&&this.changes.set(h,-1),this.array.splice(i,1),++this.idx):(s>i&&this.array.splice(s,1),this.array.splice(i,0,n))}t==-1&&this.changes.delete(n)}}end(){if(this.array.length>=this.idx)for(;this.array.length>this.idx;)this.changes.set(this.array.pop(),-1);return this.array}patch(){return this.end()}},cE=Lf;(()=>{d(Lf,oE,"ArrayPatcher",16)})();function ol(n){var i,h;let s=Object.getOwnPropertyDescriptors(n.prototype);return i=s.name,delete s.name,h=s.constructor,delete s.constructor,s}var fE=Symbol(),cl=class{constructor(n,i=0){this.depth=i,this.parent=n,this.target=null,this.spy=null,this.patcher=new cE}get activeΦ(){return X==this}get rootΦ(){return this==Yn}get snapshot(){let n=[],i=this[Ah];for(;i&&i.target;)n.push({depth:i.depth,target:i.target,beacon:i.beacon}),i=i[Ah];return n}reset(n){var i,h;this.target=n,this.beacon=n.beacon;let s=this.spy=n[lE];return this.tracking=s&&(i=s.tracking)!=null?i:!0,this.patcher.reset(n.observing||(n.observing=[])),s&&((h=s==null?void 0:s.enter)==null||h.call(s,this)),this}add(n,i){var h,s;this.tracking&&n&&this.beacon&&this.patcher.push(n),this.spy&&((s=(h=this.spy)==null?void 0:h.observed)==null||s.call(h,this,n,i))}react(n){var i,h;return this.spy&&((h=(i=this.spy)==null?void 0:i.react)==null||h.call(i,this,n)),Yn.reactions.add(n)}push(n){return ns.ctx=X=this.child.reset(n)}pop(){var n,i;let h=null;if(this.beacon){h=this.patcher.end();let s=this.patcher.changes;if(s.size)for(let[t,l]of zn(s))l===1?t.addSubscriber(this.beacon):t.removeSubscriber(this.beacon)}return this.spy&&((i=(n=this.spy)==null?void 0:n.leave)==null||i.call(n,this)),this.patcher.cleanup(),this.target=this.beacon=null,X=this.parent,X==Yn?(Yn.flush(),ns.ctx=null):ns.ctx=X,h}get child(){return this[Ah]||(this[Ah]=new cl(this,this.depth+1))}get reactions(){return this[$i]||(this[$i]=new Set)}flush(){if(!this[$i])return;let n=this[$i];this[$i]=null;for(let i of zn(n))i.call()}},rE=cl;(()=>{d(cl,fE,"Context",16)})();var eE=Symbol(),Kf=class extends rE{add(){return!0}},mE=Kf;(()=>{d(Kf,eE,"Root",0)})();var X=Yn=ns.root=new mE(null,0),SE=function(){return X.tracking=!1},Of=function(n,i,h,s,t){let l=n[h],u=n[t];return u||(u=n[t]=new Cf(s,i,l)),X.add(u,n),l},yf=function(n,i,h,s,t,l){let u=n[h];if(s!=u){n[h]=s;let o=n[l];o&&o.changed(0,s,u)}},bE=Symbol(),Gf=class{constructor(n,i,h){return this.id=df++,this.observer=null,this.observers=null,this.v=0,this.o=n||null,h&&h[ci]&&h[ci](this),this}get $$v(){return this.v}changed(n,i,h){if(uE++,this.v++,h&&h[fh]&&h[fh](this,i),i&&i[ci]&&i[ci](this,h),this.observer&&this.observer.$$invalidated(n+1,this,i,h),this.observers)for(let s of zn(this.observers))s.$$invalidated(n+1,this,i,h);X==Yn&&X.flush()}invalidated(n,i){return console.warn("Ref.invalidated is deprecated - use $$invalidated"),this.$$invalidated(n,i)}$$invalidated(n,i){if(xt)return xt.add(this),!0;if(this.v++,n>30){console.warn("Ref observer chain too deep",this,i);return}if(this.observer&&this.observer.$$invalidated(n+1,this),this.observers)for(let h of zn(this.observers))h.$$invalidated(n+1,this);return n==0&&X==Yn&&X.flush(),!0}addSubscriber(n){this.observer?(this.observers||(this.observers=new Set),this.observers.add(n)):this.observer=n}removeSubscriber(n){this.observer==n&&(this.observer=null);let i=this.observers;i&&i.delete(n)}reportChanged(){return this.changed(0)}reportObserved(n){return X.add(this,n)}},Cf=Gf;(()=>{d(Gf,bE,"Ref",16)})();var EE=Symbol(),Yf=class extends Array{push(){return mn(this,super.push(...arguments))}pop(){return mn(this,super.pop(...arguments))}unshift(){return mn(this,super.unshift(...arguments))}shift(){return mn(this,super.shift(...arguments))}splice(){return mn(this,super.splice(...arguments))}at(){return R(this,super.at(...arguments))}map(){return R(this,super.map(...arguments))}flatMap(){return R(this,super.flatMap(...arguments))}flat(){return R(this,super.flat(...arguments))}filter(){return R(this,super.filter(...arguments))}find(){return R(this,super.find(...arguments))}slice(){return R(this,super.slice(...arguments))}sort(){return R(this,super.sort(...arguments))}get len(){return R(this,this.length)}set len(n){this.length=n,mn(this)}toIterable(){return U&&X.add(this[$n]),this}[Symbol.iterator](){return R(this,super[Symbol.iterator](...arguments))}},vE=Yf;(()=>{d(Yf,EE,"ObservableArray",8)})();var tc=ol(vE),wE=Symbol(),dE=class{get len(){return this.length}set len(n){this.length=n}get[ws](){return Qi(this,null,tc)}[ci](n){return Qi(this,n,tc)}[fh](n){return ul(this,n)}};(()=>{d(dE,wE,"Array",1,Array)})();var lc=Set.prototype.has,TE=Symbol(),Xf=class extends Set{has(){return R(this,super.has(...arguments))}keys(){return R(this,super.keys(...arguments))}values(){return R(this,super.values(...arguments))}entries(){return R(this,super.entries(...arguments))}add(n){return lc.call(this,n)?this:mn(this,super.add(...arguments))}delete(n){return lc.call(this,n)?mn(this,super.delete(...arguments)):this}clear(){return this.size?mn(this,super.clear(...arguments)):this}},NE=Xf;(()=>{d(Xf,TE,"ObservableSet",8)})();var uc=ol(NE),FE=Symbol(),LE=class{get[ws](){return Qi(this,null,uc)}[ci](n){return Qi(this,n,uc)}[fh](n){return ul(this,n)}};(()=>{d(LE,FE,"Set",1,Set)})();var KE=Symbol(),zf=class extends Map{get(){return R(this,super.get(...arguments))}has(){return R(this,super.has(...arguments))}keys(){return R(this,super.keys(...arguments))}values(){return R(this,super.values(...arguments))}entries(){return R(this,super.entries(...arguments))}set(){return mn(this,super.set(...arguments))}clear(){return mn(this,super.clear(...arguments))}delete(){return mn(this,super.delete(...arguments))}},OE=zf;(()=>{d(zf,KE,"ObservableMap",8)})();var oc=ol(OE),yE=Symbol(),GE=class{get[ws](){return Qi(this,null,oc)}[ci](n){return Qi(this,n,oc)}[fh](n){return ul(this,n)}};(()=>{d(GE,yE,"Map",1,Map)})();var CE=Symbol(),YE=class{constructor(n,i={}){var h,s=this;this.name=n,this.options=i;let t=this.key=Ff(n),l=ll(n),u=this.descriptor={enumerable:(h=i.enumerable)!=null?h:!0,configurable:!1,get:function(){return U?Of(this,n,t,s,l):this[t]},set:function(c){return U||!!this[l]?yf(this,n,t,c,s,l):this[t]=c}},o=this.lazyDescriptor={enumerable:!1,configurable:!0,get:function(){return U?(Object.defineProperty(this,n,u),this[n]):this[t]},set:function(c){return this[t]=c,this[l]=null,Object.defineProperty(this,n,u)}}}};(()=>{d(YE,CE,"PropertyType",16)})();var XE=Symbol(),Qf=class{constructor(n=null){this[sc](n)}[sc](n=null,i=!0,h=!0){var s;this[jh]=n&&(s=n[jh])!==void 0?s:new Map}for(n){let i=this[jh].get(n);return i||this[jh].set(n,i=[]),i}get(n){let i=this.for(n);return i[$n]||i[ws],U&&R(i),i}add(n,i){return this.for(n).push(i)}delete(n,i){let h=this.for(n),s=h.indexOf(i);h.splice(s,1)}},zE=Qf;(()=>{d(Qf,XE,"RefIndex",16)})();var QE=Symbol(),HE=class{constructor(n,i){var h=this;this.name=n,this.key=i,this.index=new zE;let s=ll(n),t=this.descriptor={enumerable:!0,configurable:!1,get:function(){return U?Of(this,n,i,h,s):this[i]},set:function(u){let o=this[i];if(U||!!this[s]?yf(this,n,i,u,h,s):this[i]=u,o!=u&&(o&&h.index.delete(o,this),u))return h.index.add(u,this)}},l=this.lazyDescriptor={set:function(u){return this[i]=u,u&&h.index.add(u,this),Object.defineProperty(this,n,t),this[s]=null}}}where(n){return this.index.get(n)}};(()=>{d(HE,QE,"RefType",16)})();var ZE=Symbol(),Hf=class{constructor(n,i,h,s){this.observing=null,this.observers=null,this.flags=68,this.target=n,this.func=i,this.vkey=h,this.type=s,this.v=0}get beacon(){return this}addSubscriber(n){if(n==this){console.warn("@computed depends on itself");return}this.observer?(this.observers||(this.observers=[]),this.observers.push(n)):this.observer=n}removeSubscriber(n){if(this.observer==n)return this.observer=null;let i=this.observers,h=i?i.indexOf(n):-1;h>=0&&i.splice(h,1)}$$invalidated(n,i){if(this.flags|=W.STALE|W.POSSIBLY_STALE,n>40){console.warn("Memo invalidated observer chain too deep",this,i);return}if(this.observer&&this.observer.$$invalidated(n+1,this),!!this.observers){for(let h=0,s=zn(this.observers),t=s.length;h<t;h++)s[h].$$invalidated(n+1,this);return this}}deactivate(){if(this.observing)for(let n=0,i=zn(this.observing),h=i.length;n<h;n++)i[n].removeSubscriber(this);return this.observing=null,this}value(){if(U&&X.add(this),(this.flags&W.POSSIBLY_STALE)==0)return this.target[this.vkey];U++,this.flags|=W.RUNNING,X.push(this);let n=this.func.call(this.target);X.pop(this);let i=this.target[this.vkey],h=!1;if(n&&i&&n.constructor===i.constructor&&n instanceof Array){let s=n.length;if(s!=i.length)h=!0;else{let t=0;for(;t<s;){if(n[t]!=i[t]){h=!0;break}t++}}}else h=n!==i;return this.target[this.vkey]=n,this.flags&=~(W.STALE|W.POSSIBLY_STALE|W.RUNNING),h&&this.v++,U--,n}},ms=Hf;(()=>{d(Hf,ZE,"Memo",16)})();var JE=Symbol(),WE=class{constructor(n,i){var h=this;this.name=n;let s=ll(n),t=Ff(n),l=this.descriptor={enumerable:!1,configurable:!1,get:function(){return this[s].value()}},u=this.lazyDescriptor={enumerable:!1,configurable:!0,get:function(){let o=this[s]=new ms(this,i,t,h.type);return Object.defineProperty(this,n,l),o.value()}}}};(()=>{d(WE,JE,"ComputedType",16)})();var BE=Symbol(),Zf=class{get beacon(){return this}constructor(n,i,h={}){this.cb=n,this.context=i,this.options=h,this.flags=0,this.id=df++,this.cachedComputedVersions=new WeakMap,this.checkComputedValues=new Set,this.observing=[],this.timeout=null}get runningΦ(){return this.flags&W.RUNNING}$$invalidated(n,i){var h,s;i instanceof ms?(this.flags|=W.POSSIBLY_STALE,(s=(h=this.checkComputedValues)==null?void 0:h.add)==null||s.call(h,i)):this.flags|=W.STALE,this.observing&&X.react(this)}activate(){return this.observing=[],this.cachedComputedVersions=new WeakMap,this.checkComputedValues=new Set,this.call(),this}deactivate(){if(this.timeout&&clearTimeout(this.timeout),this.observing)for(let n=0,i=zn(this.observing),h=i.length;n<h;n++)i[n].removeSubscriber(this);return this.observing=this.checkComputedValues=this.cachedComputedVersions=null,this}call(){var n=this;if(U&&console.warn("should not call reaction inside an autorunning context?",Yn.snapshot,this),this.flags&W.POSSIBLY_STALE&&(this.flags&W.STALE)==0){let i=!1;for(let h of zn(this.checkComputedValues)){let s=this.cachedComputedVersions.get(h);h.value();let t=h.v;if(s!=t){i=!0;break}}if(!i){this.flags&=~W.POSSIBLY_STALE,this.checkComputedValues.clear();return}}if(this.options.delay){clearTimeout(this.timeout);let i=this.options.delay;typeof i!="number"&&(i=1000),this.timeout=setTimeout(function(){return n.run()},i);return}return this.run()}run(){U++,this.flags|=W.RUNNING;let n=X.push(this),i=this.cb.call(this.context,SE),h=X.pop(this);this.observing=h,this.checkComputedValues.clear();for(let s=0,t=zn(h),l=t.length;s<l;s++){let u=t[s];u instanceof ms&&this.cachedComputedVersions.set(u,u.v)}return this.flags&=~(W.RUNNING|W.STALE|W.POSSIBLY_STALE),U--,this.options.silent||q(),i}dispose(){return this.deactivate(),this.cb=this.context=this.options=null,this}},ME=Zf;(()=>{d(Zf,BE,"Reaction",16)})();var RE=Symbol(),UE=class extends ME{resolve(n){return this.deactivate(),this.resolved=n}then(...n){var i=this;return this.resolved!==void 0?Promise.resolve(this.resolved).then(...n):(this[Xt]||(this[Xt]=new Promise(function(h){return i.resolve=function(s){return i.deactivate(),i.resolved=s,h(s)}})),this[Xt].then(...n))}run(){U++,this.flags|=W.RUNNING;let n=X.push(this),i=this.cb.call(this.context),h=X.pop(this);this.observing=h,this.checkComputedValues.clear();for(let s=0,t=zn(h),l=t.length;s<l;s++){let u=t[s];u instanceof ms&&this.cachedComputedVersions.set(u,u.v)}return this.flags&=~(W.RUNNING|W.STALE|W.POSSIBLY_STALE),U--,i!=!1&&i!=null&&i!=null&&(this.resolve(i),this.options.silent||q()),i}};(()=>{d(UE,RE,"Awaits",0)})();var qE=Symbol(),gE=class{constructor(n,i){this.scope=i,this.cb=n}get ctx(){return X}run(n=this.scope,i=[],h=!1){X.push(this);try{h&&U++;let s=this.cb.apply(n,i);return h&&U--,X.pop(this),s}catch(s){throw h&&U--,X.pop(this),s}}};(()=>{d(gE,qE,"Action",16)})();function PE(n){let i;return n&&((i=n.toIterable)?i.call(n):n)}var cc=Symbol.for("#__init__"),xh=Symbol.for("#watchers");var VE=Symbol(),jE=class{constructor(n=null){this[cc](n)}[cc](n=null,i=!0,h=!0){var s;this.local=n&&(s=n.local)!==void 0?s:!1,this.session=n&&(s=n.session)!==void 0?s:!1,this.weak=n&&(s=n.weak)!==void 0?s:!1}watch(n){return(this[xh]||(this[xh]=[])).push(n)}$get(n,i){return n[i]}$set(n,i,h,s){if(this[xh]){let t=this.$get(i,h,s);if(t!=n){i[h]=n;for(let l=0,u=PE(this[xh]),o=u.length;l<o;l++){let c=u[l].call(i,n,t,this)}}}else i[h]=n}$accessor(n,i,h,s,t){return t[s]=this}};(()=>{d(jE,VE,"Accessor",16)})();function I(n){if(typeof n==="number")return(Math.abs(n*2654435761)>>>0).toString(16);if(typeof n==="boolean")return n?"1":"0";if(n===null)return"null";if(n===void 0)return"undefined";if(typeof n==="string"){let i=2166136261;for(let h=0;h<n.length;h++)i^=n.charCodeAt(h),i+=(i<<1)+(i<<4)+(i<<7)+(i<<8)+(i<<24),i=i>>>0;return i.toString(16)}if(Array.isArray(n)){let i=2166136261;for(let h=0;h<n.length;h++){i^=(h+1)*2654435761;let s=I(n[h]);for(let t=0;t<s.length;t++)i^=s.charCodeAt(t),i*=16777619,i=i>>>0}return i.toString(16)}if(typeof n==="object"){let i=2166136261,h=Object.keys(n).sort();for(let s=0;s<h.length;s++){let t=h[s],l=I(t);i^=parseInt(l,16),i*=16777619,i=i>>>0;let u=I(n[t]);i^=parseInt(u,16),i*=16777619,i=i>>>0}return i.toString(16)}return I(String(n))}var B={Remove:"remove",Replace:"replace",Add:"add"},Rf=Symbol.for("__MUTATIVE_PROXY_DRAFT__"),AE=Symbol("__MUTATIVE_RAW_RETURN_SYMBOL__"),ds=Symbol.iterator,tn={mutable:"mutable",immutable:"immutable"},El={};function Sh(n,i){return n instanceof Map?n.has(i):Object.prototype.hasOwnProperty.call(n,i)}function Jf(n,i){if(i in n){let h=Reflect.getPrototypeOf(n);while(h){let s=Reflect.getOwnPropertyDescriptor(h,i);if(s)return s;h=Reflect.getPrototypeOf(h)}}return}function vl(n){return Object.getPrototypeOf(n)===Set.prototype}function wl(n){return Object.getPrototypeOf(n)===Map.prototype}function sn(n){var i;return(i=n.copy)!==null&&i!==void 0?i:n.original}function ei(n){return!!y(n)}function y(n){if(typeof n!=="object")return null;return n===null||n===void 0?void 0:n[Rf]}function dl(n){var i;let h=y(n);return h?(i=h.copy)!==null&&i!==void 0?i:h.original:n}function Nn(n,i){if(!n||typeof n!=="object")return!1;let h;return Object.getPrototypeOf(n)===Object.prototype||Array.isArray(n)||n instanceof Map||n instanceof Set||!!(i===null||i===void 0?void 0:i.mark)&&((h=i.mark(n,tn))===tn.immutable||typeof h==="function")}function Uf(n,i=[]){if(Object.hasOwnProperty.call(n,"key")){let h=n.parent.copy,s=y(Pn(h,n.key));if(s!==null&&(s===null||s===void 0?void 0:s.original)!==n.original)return null;let t=n.parent.type===3,l=t?Array.from(n.parent.setMap.keys()).indexOf(n.key):n.key;if(!(t&&h.size>l||Sh(h,l)))return null;i.push(l)}if(n.parent)return Uf(n.parent,i);i.reverse();try{xE(n.copy,i)}catch(h){return null}return i}function mi(n){if(Array.isArray(n))return 1;if(n instanceof Map)return 2;if(n instanceof Set)return 3;return 0}function Pn(n,i){return mi(n)===2?n.get(i):n[i]}function Eh(n,i,h){if(mi(n)===2)n.set(i,h);else n[i]=h}function fl(n,i){let h=y(n);return(h?sn(h):n)[i]}function gn(n,i){if(n===i)return n!==0||1/n===1/i;else return n!==n&&i!==i}function rl(n){if(!n)return;while(n.finalities.revoke.length>0)n.finalities.revoke.pop()()}function ri(n,i){return i?n:[""].concat(n).map((h)=>{let s=`${h}`;if(s.indexOf("/")===-1&&s.indexOf("~")===-1)return s;return s.replace(/~/g,"~0").replace(/\//g,"~1")}).join("/")}function xE(n,i){for(let h=0;h<i.length-1;h+=1){let s=i[h];if(n=Pn(mi(n)===3?Array.from(n):n,s),typeof n!=="object")throw new Error(`Cannot resolve patch at '${i.join("/")}'.`)}return n}function DE(n){let i=Object.create(Object.getPrototypeOf(n));return Reflect.ownKeys(n).forEach((h)=>{let s=Reflect.getOwnPropertyDescriptor(n,h);if(s.enumerable&&s.configurable&&s.writable){i[h]=n[h];return}if(!s.writable)s.writable=!0,s.configurable=!0;if(s.get||s.set)s={configurable:!0,writable:!0,enumerable:s.enumerable,value:n[h]};Reflect.defineProperty(i,h,s)}),i}var IE=Object.prototype.propertyIsEnumerable;function qf(n,i){let h;if(Array.isArray(n))return Array.prototype.concat.call(n);else if(n instanceof Set){if(!vl(n))return new(Object.getPrototypeOf(n)).constructor(n.values());return Set.prototype.difference?Set.prototype.difference.call(n,new Set):new Set(n.values())}else if(n instanceof Map){if(!wl(n))return new(Object.getPrototypeOf(n)).constructor(n);return new Map(n)}else if((i===null||i===void 0?void 0:i.mark)&&(h=i.mark(n,tn),h!==void 0)&&h!==tn.mutable){if(h===tn.immutable)return DE(n);else if(typeof h==="function"){if(i.enablePatches||i.enableAutoFreeze)throw new Error("You can't use mark and patches or auto freeze together.");return h()}throw new Error(`Unsupported mark result: ${h}`)}else if(typeof n==="object"&&Object.getPrototypeOf(n)===Object.prototype){let s={};return Object.keys(n).forEach((t)=>{s[t]=n[t]}),Object.getOwnPropertySymbols(n).forEach((t)=>{if(IE.call(n,t))s[t]=n[t]}),s}else throw new Error("Please check mark() to ensure that it is a stable marker draftable function.")}function _(n){if(n.copy)return;n.copy=qf(n.original,n.options)}function mh(n){if(!Nn(n))return dl(n);if(Array.isArray(n))return n.map(mh);if(n instanceof Map){let h=Array.from(n.entries()).map(([s,t])=>[s,mh(t)]);if(!wl(n))return new(Object.getPrototypeOf(n)).constructor(h);return new Map(h)}if(n instanceof Set){let h=Array.from(n).map(mh);if(!vl(n))return new(Object.getPrototypeOf(n)).constructor(h);return new Set(h)}let i=Object.create(Object.getPrototypeOf(n));for(let h in n)i[h]=mh(n[h]);return i}function Ts(n){return ei(n)?mh(n):n}function Jn(n){var i;if(n.assignedMap=(i=n.assignedMap)!==null&&i!==void 0?i:new Map,!n.operated){if(n.operated=!0,n.parent)Jn(n.parent)}}function Wf(){throw new Error("Cannot modify frozen object")}function Ji(n,i,h,s,t){{h=h!==null&&h!==void 0?h:new WeakMap,s=s!==null&&s!==void 0?s:[],t=t!==null&&t!==void 0?t:[];let u=h.has(n)?h.get(n):n;if(s.length>0){let o=s.indexOf(u);if(u&&typeof u==="object"&&o!==-1){if(s[0]===u)throw new Error("Forbids circular reference");throw new Error(`Forbids circular reference: ~/${t.slice(0,o).map((c,f)=>{if(typeof c==="symbol")return`[${c.toString()}]`;let r=s[f];if(typeof c==="object"&&(r instanceof Map||r instanceof Set))return Array.from(r.keys()).indexOf(c);return c}).join("/")}`)}s.push(u),t.push(i)}else s.push(u)}if(Object.isFrozen(n)||ei(n)){s.pop(),t.pop();return}switch(mi(n)){case 2:for(let[o,c]of n)Ji(o,o,h,s,t),Ji(c,o,h,s,t);n.set=n.clear=n.delete=Wf;break;case 3:for(let o of n)Ji(o,o,h,s,t);n.add=n.clear=n.delete=Wf;break;case 1:Object.freeze(n);let u=0;for(let o of n)Ji(o,u,h,s,t),u+=1;break;default:Object.freeze(n),Object.keys(n).forEach((o)=>{let c=n[o];Ji(c,o,h,s,t)})}s.pop(),t.pop()}function Tl(n,i){let h=mi(n);if(h===0)Reflect.ownKeys(n).forEach((s)=>{i(s,n[s],n)});else if(h===1){let s=0;for(let t of n)i(s,t,n),s+=1}else n.forEach((s,t)=>i(t,s,n))}function gf(n,i,h){if(ei(n)||!Nn(n,h)||i.has(n)||Object.isFrozen(n))return;let s=n instanceof Set,t=s?new Map:void 0;if(i.add(n),Tl(n,(l,u)=>{var o;if(ei(u)){let c=y(u);_(c);let f=((o=c.assignedMap)===null||o===void 0?void 0:o.size)||c.operated?c.copy:c.original;Eh(s?t:n,l,f)}else gf(u,i,h)}),t){let l=n,u=Array.from(l);l.clear(),u.forEach((o)=>{l.add(t.has(o)?t.get(o):o)})}}function _E(n,i){let h=n.type===3?n.setMap:n.copy;if(n.finalities.revoke.length>1&&n.assignedMap.get(i)&&h)gf(Pn(h,i),n.finalities.handledSet,n.options)}function el(n){if(n.type===3&&n.copy)n.copy.clear(),n.setMap.forEach((i)=>{n.copy.add(dl(i))})}function ml(n,i,h,s){if(n.operated&&n.assignedMap&&n.assignedMap.size>0&&!n.finalized){if(h&&s){let l=Uf(n);if(l)i(n,l,h,s)}n.finalized=!0}}function Nl(n,i,h,s){let t=y(h);if(t){if(!t.callbacks)t.callbacks=[];if(t.callbacks.push((l,u)=>{var o;let c=n.type===3?n.setMap:n.copy;if(gn(Pn(c,i),h)){let f=t.original;if(t.copy)f=t.copy;if(el(n),ml(n,s,l,u),n.options.enableAutoFreeze)n.options.updatedValues=(o=n.options.updatedValues)!==null&&o!==void 0?o:new WeakMap,n.options.updatedValues.set(f,t.original);Eh(c,i,f)}}),n.options.enableAutoFreeze){if(t.finalities!==n.finalities)n.options.enableAutoFreeze=!1}}if(Nn(h,n.options))n.finalities.draft.push(()=>{let l=n.type===3?n.setMap:n.copy;if(gn(Pn(l,i),h))_E(n,i)})}function $E(n,i,h,s,t){let{original:l,assignedMap:u,options:o}=n,c=n.copy;if(c.length<l.length)[l,c]=[c,l],[h,s]=[s,h];for(let f=0;f<l.length;f+=1)if(u.get(f.toString())&&c[f]!==l[f]){let r=i.concat([f]),e=ri(r,t);h.push({op:B.Replace,path:e,value:Ts(c[f])}),s.push({op:B.Replace,path:e,value:Ts(l[f])})}for(let f=l.length;f<c.length;f+=1){let r=i.concat([f]),e=ri(r,t);h.push({op:B.Add,path:e,value:Ts(c[f])})}if(l.length<c.length){let{arrayLengthAssignment:f=!0}=o.enablePatches;if(f){let r=i.concat(["length"]),e=ri(r,t);s.push({op:B.Replace,path:e,value:l.length})}else for(let r=c.length;l.length<r;r-=1){let e=i.concat([r-1]),S=ri(e,t);s.push({op:B.Remove,path:S})}}}function kE({original:n,copy:i,assignedMap:h},s,t,l,u){h.forEach((o,c)=>{let f=Pn(n,c),r=Ts(Pn(i,c)),e=!o?B.Remove:Sh(n,c)?B.Replace:B.Add;if(gn(f,r)&&e===B.Replace)return;let S=s.concat(c),b=ri(S,u);t.push(e===B.Remove?{op:e,path:b}:{op:e,path:b,value:r}),l.push(e===B.Add?{op:B.Remove,path:b}:e===B.Remove?{op:B.Add,path:b,value:f}:{op:B.Replace,path:b,value:f})})}function pE({original:n,copy:i},h,s,t,l){let u=0;n.forEach((o)=>{if(!i.has(o)){let c=h.concat([u]),f=ri(c,l);s.push({op:B.Remove,path:f,value:o}),t.unshift({op:B.Add,path:f,value:o})}u+=1}),u=0,i.forEach((o)=>{if(!n.has(o)){let c=h.concat([u]),f=ri(c,l);s.push({op:B.Add,path:f,value:o}),t.unshift({op:B.Remove,path:f,value:o})}u+=1})}function bh(n,i,h,s){let{pathAsArray:t=!0}=n.options.enablePatches;switch(n.type){case 0:case 2:return kE(n,i,h,s,t);case 1:return $E(n,i,h,s,t);case 3:return pE(n,i,h,s,t)}}var aE=!1,Ns=(n,i,h=!1)=>{if(typeof n==="object"&&n!==null&&(!Nn(n,i)||h)&&!aE)throw new Error("Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.")};var Sl={get size(){return sn(y(this)).size},has(n){return sn(y(this)).has(n)},set(n,i){let h=y(this),s=sn(h);if(!s.has(n)||!gn(s.get(n),i))_(h),Jn(h),h.assignedMap.set(n,!0),h.copy.set(n,i),Nl(h,n,i,bh);return this},delete(n){if(!this.has(n))return!1;let i=y(this);if(_(i),Jn(i),i.original.has(n))i.assignedMap.set(n,!1);else i.assignedMap.delete(n);return i.copy.delete(n),!0},clear(){let n=y(this);if(!this.size)return;_(n),Jn(n),n.assignedMap=new Map;for(let[i]of n.original)n.assignedMap.set(i,!1);n.copy.clear()},forEach(n,i){let h=y(this);sn(h).forEach((s,t)=>{n.call(i,this.get(t),t,this)})},get(n){var i,h;let s=y(this),t=sn(s).get(n),l=((h=(i=s.options).mark)===null||h===void 0?void 0:h.call(i,t,tn))===tn.mutable;if(s.options.strict)Ns(t,s.options,l);if(l)return t;if(s.finalized||!Nn(t,s.options))return t;if(t!==s.original.get(n))return t;let u=El.createDraft({original:t,parentDraft:s,key:n,finalities:s.finalities,options:s.options});return _(s),s.copy.set(n,u),u},keys(){return sn(y(this)).keys()},values(){let n=this.keys();return{[ds]:()=>this.values(),next:()=>{let i=n.next();if(i.done)return i;return{done:!1,value:this.get(i.value)}}}},entries(){let n=this.keys();return{[ds]:()=>this.entries(),next:()=>{let i=n.next();if(i.done)return i;let h=this.get(i.value);return{done:!1,value:[i.value,h]}}}},[ds](){return this.entries()}},nv=Reflect.ownKeys(Sl),Bf=(n,i,{isValuesIterator:h})=>()=>{var s,t;let l=i.next();if(l.done)return l;let u=l.value,o=n.setMap.get(u),c=y(o),f=((t=(s=n.options).mark)===null||t===void 0?void 0:t.call(s,o,tn))===tn.mutable;if(n.options.strict)Ns(u,n.options,f);if(!f&&!c&&Nn(u,n.options)&&!n.finalized&&n.original.has(u)){let r=El.createDraft({original:u,parentDraft:n,key:u,finalities:n.finalities,options:n.options});n.setMap.set(u,r),o=r}else if(c)o=c.proxy;return{done:!1,value:h?o:[o,o]}},Fs={get size(){return y(this).setMap.size},has(n){let i=y(this);if(i.setMap.has(n))return!0;_(i);let h=y(n);if(h&&i.setMap.has(h.original))return!0;return!1},add(n){let i=y(this);if(!this.has(n))_(i),Jn(i),i.assignedMap.set(n,!0),i.setMap.set(n,n),Nl(i,n,n,bh);return this},delete(n){if(!this.has(n))return!1;let i=y(this);_(i),Jn(i);let h=y(n);if(h&&i.setMap.has(h.original))return i.assignedMap.set(h.original,!1),i.setMap.delete(h.original);if(!h&&i.setMap.has(n))i.assignedMap.set(n,!1);else i.assignedMap.delete(n);return i.setMap.delete(n)},clear(){if(!this.size)return;let n=y(this);_(n),Jn(n);for(let i of n.original)n.assignedMap.set(i,!1);n.setMap.clear()},values(){let n=y(this);_(n);let i=n.setMap.keys();return{[Symbol.iterator]:()=>this.values(),next:Bf(n,i,{isValuesIterator:!0})}},entries(){let n=y(this);_(n);let i=n.setMap.keys();return{[Symbol.iterator]:()=>this.entries(),next:Bf(n,i,{isValuesIterator:!1})}},keys(){return this.values()},[ds](){return this.values()},forEach(n,i){let h=this.values(),s=h.next();while(!s.done)n.call(i,s.value,s.value,this),s=h.next()}};if(Set.prototype.difference)Object.assign(Fs,{intersection(n){return Set.prototype.intersection.call(new Set(this.values()),n)},union(n){return Set.prototype.union.call(new Set(this.values()),n)},difference(n){return Set.prototype.difference.call(new Set(this.values()),n)},symmetricDifference(n){return Set.prototype.symmetricDifference.call(new Set(this.values()),n)},isSubsetOf(n){return Set.prototype.isSubsetOf.call(new Set(this.values()),n)},isSupersetOf(n){return Set.prototype.isSupersetOf.call(new Set(this.values()),n)},isDisjointFrom(n){return Set.prototype.isDisjointFrom.call(new Set(this.values()),n)}});var iv=Reflect.ownKeys(Fs),Pf=new WeakSet,Vf={get(n,i,h){var s,t;let l=(s=n.copy)===null||s===void 0?void 0:s[i];if(l&&Pf.has(l))return l;if(i===Rf)return n;let u;if(n.options.mark){let f=i==="size"&&(n.original instanceof Map||n.original instanceof Set)?Reflect.get(n.original,i):Reflect.get(n.original,i,h);if(u=n.options.mark(f,tn),u===tn.mutable){if(n.options.strict)Ns(f,n.options,!0);return f}}let o=sn(n);if(o instanceof Map&&nv.includes(i)){if(i==="size")return Object.getOwnPropertyDescriptor(Sl,"size").get.call(n.proxy);let f=Sl[i];if(f)return f.bind(n.proxy)}if(o instanceof Set&&iv.includes(i)){if(i==="size")return Object.getOwnPropertyDescriptor(Fs,"size").get.call(n.proxy);let f=Fs[i];if(f)return f.bind(n.proxy)}if(!Sh(o,i)){let f=Jf(o,i);return f?"value"in f?f.value:(t=f.get)===null||t===void 0?void 0:t.call(n.proxy):void 0}let c=o[i];if(n.options.strict)Ns(c,n.options);if(n.finalized||!Nn(c,n.options))return c;if(c===fl(n.original,i)){if(_(n),n.copy[i]=Fl({original:n.original[i],parentDraft:n,key:n.type===1?Number(i):i,finalities:n.finalities,options:n.options}),typeof u==="function"){let f=y(n.copy[i]);return _(f),Jn(f),f.copy}return n.copy[i]}return c},set(n,i,h){var s;if(n.type===3||n.type===2)throw new Error("Map/Set draft does not support any property assignment.");let t;if(n.type===1&&i!=="length"&&!(Number.isInteger(t=Number(i))&&t>=0&&(i===0||t===0||String(t)===String(i))))throw new Error("Only supports setting array indices and the 'length' property.");let l=Jf(sn(n),i);if(l===null||l===void 0?void 0:l.set)return l.set.call(n.proxy,h),!0;let u=fl(sn(n),i),o=y(u);if(o&&gn(o.original,h))return n.copy[i]=h,n.assignedMap=(s=n.assignedMap)!==null&&s!==void 0?s:new Map,n.assignedMap.set(i,!1),!0;if(gn(h,u)&&(h!==void 0||Sh(n.original,i)))return!0;if(_(n),Jn(n),Sh(n.original,i)&&gn(h,n.original[i]))n.assignedMap.delete(i);else n.assignedMap.set(i,!0);return n.copy[i]=h,Nl(n,i,h,bh),!0},has(n,i){return i in sn(n)},ownKeys(n){return Reflect.ownKeys(sn(n))},getOwnPropertyDescriptor(n,i){let h=sn(n),s=Reflect.getOwnPropertyDescriptor(h,i);if(!s)return s;return{writable:!0,configurable:n.type!==1||i!=="length",enumerable:s.enumerable,value:h[i]}},getPrototypeOf(n){return Reflect.getPrototypeOf(n.original)},setPrototypeOf(){throw new Error("Cannot call 'setPrototypeOf()' on drafts")},defineProperty(){throw new Error("Cannot call 'defineProperty()' on drafts")},deleteProperty(n,i){var h;if(n.type===1)return Vf.set.call(this,n,i,void 0,n.proxy);if(fl(n.original,i)!==void 0||i in n.original)_(n),Jn(n),n.assignedMap.set(i,!1);else n.assignedMap=(h=n.assignedMap)!==null&&h!==void 0?h:new Map,n.assignedMap.delete(i);if(n.copy)delete n.copy[i];return!0}};function Fl(n){let{original:i,parentDraft:h,key:s,finalities:t,options:l}=n,u=mi(i),o={type:u,finalized:!1,parent:h,original:i,copy:null,proxy:null,finalities:t,options:l,setMap:u===3?new Map(i.entries()):void 0};if(s||"key"in n)o.key=s;let{proxy:c,revoke:f}=Proxy.revocable(u===1?Object.assign([],o):o,Vf);if(t.revoke.push(f),Pf.add(c),o.proxy=c,h){let r=h;r.finalities.draft.push((e,S)=>{var b,m;let E=y(c),w=r.type===3?r.setMap:r.copy,v=Pn(w,s),F=y(v);if(F){let T=F.original;if(F.operated)T=dl(v);if(el(F),ml(F,bh,e,S),r.options.enableAutoFreeze)r.options.updatedValues=(b=r.options.updatedValues)!==null&&b!==void 0?b:new WeakMap,r.options.updatedValues.set(T,F.original);Eh(w,s,T)}(m=E.callbacks)===null||m===void 0||m.forEach((T)=>{T(e,S)})})}else{let r=y(c);r.finalities.draft.push((e,S)=>{el(r),ml(r,bh,e,S)})}return c}El.createDraft=Fl;function hv(n,i,h,s,t){var l;let u=y(n),o=(l=u===null||u===void 0?void 0:u.original)!==null&&l!==void 0?l:n,c=!!i.length;if(u===null||u===void 0?void 0:u.operated)while(u.finalities.draft.length>0)u.finalities.draft.pop()(h,s);let f=c?i[0]:u?u.operated?u.copy:u.original:n;if(u)rl(u);if(t)Ji(f,f,u===null||u===void 0?void 0:u.options.updatedValues);return[f,h&&c?[{op:B.Replace,path:[],value:i[0]}]:h,s&&c?[{op:B.Replace,path:[],value:o}]:s]}function sv(n,i){var h;let s={draft:[],revoke:[],handledSet:new WeakSet},t,l;if(i.enablePatches)t=[],l=[];let o=((h=i.mark)===null||h===void 0?void 0:h.call(i,n,tn))===tn.mutable||!Nn(n,i)?n:Fl({original:n,parentDraft:null,finalities:s,options:i});return[o,(c=[])=>{let[f,r,e]=hv(o,c,t,l,i.enableAutoFreeze);return i.enablePatches?[f,r,e]:f}]}function bl(n){let{rootDraft:i,value:h,useRawReturn:s=!1,isRoot:t=!0}=n;if(Tl(h,(l,u,o)=>{let c=y(u);if(c&&i&&c.finalities===i.finalities){n.isContainDraft=!0;let f=c.original;if(o instanceof Set){let r=Array.from(o);o.clear(),r.forEach((e)=>o.add(l===e?f:e))}else Eh(o,l,f)}else if(typeof u==="object"&&u!==null)n.value=u,n.isRoot=!1,bl(n)}),t){if(!n.isContainDraft)console.warn("The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance.");if(s)console.warn("The return value contains drafts, please don't use 'rawReturn()' to wrap the return value.")}}function jf(n){var i;let h=y(n);if(!Nn(n,h===null||h===void 0?void 0:h.options))return n;let s=mi(n);if(h&&!h.operated)return h.original;let t;function l(){t=s===2?!wl(n)?new(Object.getPrototypeOf(n)).constructor(n):new Map(n):s===3?Array.from(h.setMap.values()):qf(n,h===null||h===void 0?void 0:h.options)}if(h){h.finalized=!0;try{l()}finally{h.finalized=!1}}else t=n;if(Tl(t,(u,o)=>{if(h&&gn(Pn(h.original,u),o))return;let c=jf(o);if(c!==o){if(t===n)l();Eh(t,u,c)}}),s===3){let u=(i=h===null||h===void 0?void 0:h.original)!==null&&i!==void 0?i:t;return!vl(u)?new(Object.getPrototypeOf(u)).constructor(t):new Set(t)}return t}function Mf(n){if(!ei(n))throw new Error(`current() is only used for Draft, parameter: ${n}`);return jf(n)}var tv=(n)=>{if(n!==void 0&&Object.prototype.toString.call(n)!=="[object Object]")throw new Error(`Invalid options: ${String(n)}, 'options' should be an object.`);return function i(h,s,t){var l,u,o;if(typeof h==="function"&&typeof s!=="function")return function(N,...K){return i(N,(O)=>h.call(this,O,...K),s)};let c=h,f=s,r=t;if(typeof s!=="function")r=s;if(r!==void 0&&Object.prototype.toString.call(r)!=="[object Object]")throw new Error(`Invalid options: ${r}, 'options' should be an object.`);r=Object.assign(Object.assign({},n),r);let e=ei(c)?Mf(c):c,S=Array.isArray(r.mark)?(N,K)=>{for(let O of r.mark){if(typeof O!=="function")throw new Error(`Invalid mark: ${O}, 'mark' should be a function.`);let C=O(N,K);if(C)return C}return}:r.mark,b=(l=r.enablePatches)!==null&&l!==void 0?l:!1,m=(u=r.strict)!==null&&u!==void 0?u:!1,w={enableAutoFreeze:(o=r.enableAutoFreeze)!==null&&o!==void 0?o:!1,mark:S,strict:m,enablePatches:b};if(!Nn(e,w)&&typeof e==="object"&&e!==null)throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");let[v,F]=sv(e,w);if(typeof s!=="function"){if(!Nn(e,w))throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");return[v,F]}let T;try{T=f(v)}catch(N){throw rl(y(v)),N}let L=(N)=>{let K=y(v);if(!ei(N)){if(N!==void 0&&!gn(N,v)&&(K===null||K===void 0?void 0:K.operated))throw new Error("Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.");let C=N===null||N===void 0?void 0:N[AE];if(C){let Y=C[0];if(w.strict&&typeof N==="object"&&N!==null)bl({rootDraft:K,value:N,useRawReturn:!0});return F([Y])}if(N!==void 0){if(typeof N==="object"&&N!==null)bl({rootDraft:K,value:N});return F([N])}}if(N===v||N===void 0)return F([]);let O=y(N);if(w===O.options){if(O.operated)throw new Error("Cannot return a modified child draft.");return F([Mf(N)])}return F([N])};if(T instanceof Promise)return T.then(L,(N)=>{throw rl(y(v)),N});return L(T)}},vh=tv();var Z6=Object.prototype.constructor.toString();function Ll(n,i){let h=Object.keys(n),s=Object.keys(i);return h.length===s.length&&Object.keys(n).every((t)=>i.hasOwnProperty(t))}function Kl(n,i){return Object.keys(n).length===Object.keys(i).length&&Object.keys(n).every((h)=>i.hasOwnProperty(h)&&n[h]===i[h])}function dh(n,i){if(typeof n!=="object"||typeof i!=="object"||n===null||i===null)return n===i;if(!Ll(n,i))return!1;return Object.keys(n).every((h)=>dh(n[h],i[h]))}function Ol(n){if(!wh(n))return n;let i={};for(let[h,s]of Object.entries(n)){if(s===void 0)continue;i[h]=s}return i}function yl(n,i){if(!wh(n)||!wh(i))return i;let h=Object.assign({},n);for(let s of Object.keys(i)){if(i[s]===void 0)continue;if(i[s]===null){delete h[s];continue}let t=wh(n[s])&&wh(i[s]);h[s]=t?yl(n[s],i[s]):i[s]}return h}function wh(n){return typeof n==="object"&&n!==null&&!Array.isArray(n)}function Af(n,i,h){if(!n)return;if(i.length===0)return;let s=n||{};for(let l=0;l<i.length-1;l++){let u=i[l];if(!(u in s)||typeof s[u]!=="object")s[u]=typeof i[l+1]==="number"?[]:{};s=s[u]}let t=i[i.length-1];if(Array.isArray(s)&&typeof t==="number")s.splice(t,0,h);else s[t]=h}function Gl(n,i,h){if(!n)return;if(i.length===0)return;let s=n||{};for(let t=0;t<i.length-1;t++){let l=i[t];if(!(l in s)||typeof s[l]!=="object")s[l]=typeof i[t+1]==="number"?[]:{};s=s[l]}s[i[i.length-1]]=h}function Cl(n,i){if(!n)return;if(i.length===0)return;let[h,...s]=i;if(!(h in n))return;if(s.length===0){if(Array.isArray(n))n.splice(h,1);else delete n[h];return}if(Cl(n[h],s),lv(n[h]))delete n[h]}function lv(n){return n&&Object.keys(n).length===0}function uv(n){return n.cardinality==="one"}function Xl(n){return n["value-type"]==="ref"}function Ks(n){return n["value-type"]==="blob"}function Os(n,i){return n[i]}function zl(n,i){return i.reduce((h,s)=>h&&h.get(s),n)}function Fn(n,i){if(i.length===0)throw new Error("path must have at least one element");if(i.length===1){n.delete(i[0]);return}let[h,...s]=i;if(!n.has(h))return;Fn(n.get(h),s)}function nn(n,i,h){if(i.length===0)throw new Error("path must have at least one element");if(i.length===1){n.set(i[0],h);return}let[s,...t]=i,l=n.get(s);if(!l)l=new Map,n.set(s,l);nn(l,t,h)}function xf(n,i){let h=new Map,s=new Map,t=new Map;for(let l of i){let[u,o,c,f]=l,r=Os(n,o);if(!r){console.warn("no such attr",u,n);continue}if(Xl(r))nn(t,[c,o,u],l);nn(h,[u,o,c],l),nn(s,[o,u,c],l)}return{eav:h,aev:s,vae:t}}function Df(n){let i=new Map,h=new Map,s=new Map,t=new Map;for(let l of Object.values(n)){let u=l["forward-identity"],[o,c,f]=u,r=l["reverse-identity"];if(nn(s,[c,f],l),Ks(l))nn(i,[c,f],l);if(l["primary?"])nn(h,[c],l);if(r){let[e,S,b]=r;nn(t,[S,b],l)}}return{blobAttrs:i,primaryKeys:h,forwardIdents:s,revIdents:t}}function If(n){return{__type:n.__type,attrs:n.attrs,triples:ln(n.eav,3),cardinalityInference:n.cardinalityInference,linkIndex:n.linkIndex}}function _f(n){return ys(n.attrs,n.triples,n.cardinalityInference,n.linkIndex)}function Ql(n){n.attrIndexes=Df(n.attrs)}function ys(n,i,h,s){let t=xf(n,i);return t.attrs=n,t.attrIndexes=Df(n),t.cardinalityInference=h,t.linkIndex=s,t.__type="store",t}function Gs(n,i){var h,s;let t;if(Array.isArray(i[0])){let[u,o]=i[0],c=n.aev.get(u);if(!c)return null;t=(h=ln(c,2).find((r)=>r[2]===o))===null||h===void 0?void 0:h[0]}else t=i[0];if(!t)return null;let l=i[2];if(Array.isArray(l)&&l.length===2&&n.aev.get(l[0])){let[u,o]=l,c=n.aev.get(u);if(!c)return null;let r=(s=ln(c,2).find((E)=>E[2]===o))===null||s===void 0?void 0:s[0];if(!r)return null;let[e,S,b,...m]=i;return[t,S,r,...m]}else{let[u,...o]=i;return[t,...o]}}function ov(n,i){let h=Gs(n,i);if(!h)return;let[s,t,l]=h,u=Os(n.attrs,t);if(!u)return;if(Fn(n.eav,[s,t,l]),Fn(n.aev,[t,s,l]),Xl(u))Fn(n.vae,[l,t,s])}var cv=0;function $f(n,i,h){let[s,t,l]=h,u,o=zl(n.ea,[s,t,l]);if(o)u=o[3];return u||Date.now()*10+cv++}function fv(n,i){var h;let s=Gs(n,i);if(!s)return;let[t,l,u]=s,o=Os(n.attrs,l);if(!o)return;let c=zl(n.eav,[t,l,u]),f=(h=c===null||c===void 0?void 0:c[3])!==null&&h!==void 0?h:$f(n,o,s),r=[t,l,u,f];if(uv(o))nn(n.eav,[t,l],new Map([[u,r]])),nn(n.aev,[l,t],new Map([[u,r]]));else nn(n.eav,[t,l,u],r),nn(n.aev,[l,t,u],r);if(Xl(o))nn(n.vae,[u,l,t],r)}function rv(n,i){var h;let s=Gs(n,i);if(!s)return;let[t,l,u]=s,o=Os(n.attrs,l);if(!o)return;if(!Ks(o))throw new Error("merge operation is not supported for links");let c=zl(n.eav,[t,l]);if(!c)return;let f=(h=c.values().next())===null||h===void 0?void 0:h.value;if(!f)return;let r=f[2],e=yl(r,u),S=[t,l,e,$f(n,o,f)];nn(n.eav,[t,l],new Map([[e,S]]))}function Yl(n,i){var h,s;let[t,l]=i,u=Gs(n,[t]);if(!u)return;let[o]=u,c=n.eav.get(o);if(c){for(let r of c.keys()){let e=n.attrs[r];if(e&&e["on-delete-reverse"]==="cascade")ln(c.get(r),1).forEach(([S,b,m])=>{var E;return Yl(n,[m,(E=e["reverse-identity"])===null||E===void 0?void 0:E[1]])});if(!l||!e||((h=e["forward-identity"])===null||h===void 0?void 0:h[1])===l)Fn(n.aev,[r,o]),Fn(n.eav,[o,r])}if(c.size===0)Fn(n.eav,[o])}let f=n.vae.get(o)&&ln(n.vae.get(o),2);if(f)f.forEach((r)=>{var e,S;let[b,m,E]=r,w=n.attrs[m];if(!l||!w||((e=w["reverse-identity"])===null||e===void 0?void 0:e[1])===l)Fn(n.eav,[b,m,E]),Fn(n.aev,[m,b,E]),Fn(n.vae,[E,m,b]);if(w&&w["on-delete"]==="cascade")Yl(n,[b,(S=w["forward-identity"])===null||S===void 0?void 0:S[1]])});if(((s=n.vae.get(o))===null||s===void 0?void 0:s.size)===0)Fn(n.vae,[o])}function kf(n,i){let h=xf(n.attrs,i);Object.keys(h).forEach((s)=>{n[s]=h[s]})}function ev(n,[i]){n.attrs[i.id]=i,Ql(n)}function pf(n){return ln(n.eav,3)}function mv(n,[i]){if(!n.attrs[i])return;let h=pf(n).filter(([s,t])=>t!==i);delete n.attrs[i],Ql(n),kf(n,h)}function Sv(n,[i]){let h=n.attrs[i.id];if(!h)return;n.attrs[i.id]=Object.assign(Object.assign({},h),i),Ql(n),kf(n,pf(n))}function bv(n,i){let[h,...s]=i;switch(h){case"add-triple":fv(n,s);break;case"deep-merge-triple":rv(n,s);break;case"retract-triple":ov(n,s);break;case"delete-entity":Yl(n,s);break;case"add-attr":ev(n,s);break;case"delete-attr":mv(n,s);break;case"update-attr":Sv(n,s);break;case"rule-params":break;default:throw new Error(`unhandled transaction action: ${h}`)}}function ln(n,i,h=[]){if(!n)return h;if(i===0)return h;if(i===1){for(let s of n.values())h.push(s);return h}for(let s of n.values())ln(s,i-1,h);return h}function Ls(n,i,h){var s,t;let l=[];if(h===null||h===void 0?void 0:h.hasOwnProperty("$not")){for(let o of i.keys())if(h.$not!==o)l.push(i.get(o));return l}if(h===null||h===void 0?void 0:h.hasOwnProperty("$isNull")){let{attrId:o,isNull:c,reverse:f}=h.$isNull;if(f)for(let r of i.keys()){let e=n.vae.get(r),S=!e||((s=e.get(o))===null||s===void 0?void 0:s.get(null))||!e.get(o);if(c?S:!S)l.push(i.get(r))}else{let r=n.aev.get(o);for(let e of i.keys()){let S=!r||((t=r.get(e))===null||t===void 0?void 0:t.get(null))||!r.get(e);if(c?S:!S)l.push(i.get(e))}}return l}if(h===null||h===void 0?void 0:h.$comparator)return ln(i,1).filter(h.$op);let u=h.in||h.$in||[h];for(let o of u){let c=i.get(o);if(c)l.push(c)}return l}function Ev(n,i,h){let s="";if(n!==void 0)s+="e";if(i!==void 0)s+="a";if(h!==void 0)s+="v";return s}function af(n,[i,h,s]){var t,l;switch(Ev(i,h,s)){case"e":{let o=n.eav.get(i);return ln(o,2)}case"ea":{let o=(t=n.eav.get(i))===null||t===void 0?void 0:t.get(h);return ln(o,1)}case"eav":{let o=(l=n.eav.get(i))===null||l===void 0?void 0:l.get(h);if(!o)return[];return Ls(n,o,s)}case"ev":{let o=n.eav.get(i);if(!o)return[];let c=[];for(let f of o.values())c.push(...Ls(n,f,s));return c}case"a":{let o=n.aev.get(h);return ln(o,2)}case"av":{let o=n.aev.get(h);if(!o)return[];let c=[];for(let f of o.values())c.push(...Ls(n,f,s));return c}case"v":{let o=[];for(let c of n.eav.values())for(let f of c.values())o.push(...Ls(n,f,s))}default:return ln(n.eav,3)}}function nr(n,i,h){var s;let t={};for(let[l,u]of i.entries()){let o=(s=n.eav.get(h))===null||s===void 0?void 0:s.get(u.id),c=ln(o,1);for(let f of c)t[l]=f[2]}return t}function Si(n,i,h){var s;return(s=n.attrIndexes.forwardIdents.get(i))===null||s===void 0?void 0:s.get(h)}function Hl(n,i,h){var s;return(s=n.attrIndexes.revIdents.get(i))===null||s===void 0?void 0:s.get(h)}function ir(n,i){return n.attrIndexes.blobAttrs.get(i)}function hr(n,i){var h;let s=n.attrIndexes.primaryKeys.get(i);if(s)return s;return(h=n.attrIndexes.forwardIdents.get(i))===null||h===void 0?void 0:h.get("id")}function Zl(n,i){return vh(n,(h)=>{i.forEach((s)=>{bv(h,s)})})}function vv(n){return typeof n==="string"&&n.startsWith("?")}function wv(n,i,h){if(h.hasOwnProperty(n)){let s=h[n];return lr(s,i,h)}return Object.assign(Object.assign({},h),{[n]:i})}function tr(n,i,h){return n===i?h:null}function dv(n){switch(typeof n){case"string":return n.startsWith("?")?wv:tr;default:return tr}}var Tv=["in","$in","$not","$isNull","$comparator"];function Nv(n){for(let i of Tv)if(n.hasOwnProperty(i))return!0;return!1}function lr(n,i,h){if(!h)return null;if(typeof n==="object"){if(Nv(n))return h;return null}return dv(n)(n,i,h)}function Fv(n,i,h){return n.reduce((s,t,l)=>{let u=i[l];return lr(t,u,s)},h)}function Lv(n,i,h){return Ov(n,i,h).map((s)=>Fv(i,s,h)).filter((s)=>s)}function Kv(n,i,h){if(i.or)return i.or.patterns.flatMap((s)=>{return Jl(n,s,h)});if(i.and)return i.and.patterns.reduce((s,t)=>{return Jl(n,t,s)},h);return h.flatMap((s)=>Lv(n,i,s))}function Jl(n,i,h=[{}]){return i.reduce((s,t)=>{return Kv(n,t,s)},h)}function Wl(n,i){if(Array.isArray(i))return i.map((h)=>Wl(n,h));return vv(i)?n[i]:i}function ur(n,{find:i,where:h}){return Jl(n,h).map((t)=>Wl(t,i))}function Ov(n,i,h){return af(n,Wl(h,i))}var Cs,yv=new Uint8Array(16);function Bl(){if(!Cs){if(Cs=typeof crypto!=="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Cs)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}return Cs(yv)}var P=[];for(let n=0;n<256;++n)P.push((n+256).toString(16).slice(1));function or(n,i=0){return P[n[i+0]]+P[n[i+1]]+P[n[i+2]]+P[n[i+3]]+"-"+P[n[i+4]]+P[n[i+5]]+"-"+P[n[i+6]]+P[n[i+7]]+"-"+P[n[i+8]]+P[n[i+9]]+"-"+P[n[i+10]]+P[n[i+11]]+P[n[i+12]]+P[n[i+13]]+P[n[i+14]]+P[n[i+15]]}var Gv=typeof crypto!=="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ml={randomUUID:Gv};function Cv(n,i,h){if(Ml.randomUUID&&!i&&!n)return Ml.randomUUID();n=n||{};let s=n.random||(n.rng||Bl)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,i){h=h||0;for(let t=0;t<16;++t)i[h+t]=s[t];return i}return or(s)}var Rl=Cv;function cr(n){let i=n.replace(/-/g,""),h=[];for(let s=0;s<i.length;s+=2)h.push(parseInt(i.substring(s,s+2),16));return h}function Yv(n,i){for(let h=0;h<n.length;h++){if(n[h]<i[h])return-1;if(n[h]>i[h])return 1}return 0}function fr(n,i){return Yv(cr(n),cr(i))}function Xv(){return Rl()}var M=Xv;var zv=0;function Th(n){return Xs(`_${n}`,zv++)}function Xs(n,i){return`?${n}-${i}`}class bi extends Error{constructor(n){super(n);this.name="AttrNotFoundError"}}function Qv(n,i){let h=hr(n,i);if(!h)throw new bi(`Could not find id attr for ${i}`);return h}function rr(n,i,h,s){return[Hv(n,i,h,s)]}function Hv(n,i,h,s){return[n(h,s),Qv(i,h).id,n(h,s),n("time",s)]}function Zv(n,i,h){return n.map((s)=>s===i?h:s)}function br(n,i,h,s,t){let l=Si(i,h,t),u=Hl(i,h,t),o=l||u;if(!o)throw new bi(`Could not find attr for ${[h,t]}`);if(o["value-type"]!=="ref")throw new Error(`Attr ${o.id} is not a ref`);let[c,f]=o["forward-identity"],[r,e]=o["reverse-identity"],S=s+1,b=l?[n(f,s),o.id,n(e,S),Th("time")]:[n(f,S),o.id,n(e,s),Th("time")],m=l?e:f,E=Boolean(l);return[m,S,b,o,E]}function er(n,i){if(typeof i!=="string")return function l(u){return!1};let s=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/%/g,".*").replace(/_/g,"."),t=new RegExp(`^${s}$`,n?void 0:"i");return function l(u){if(typeof u!=="string")return!1;return t.test(u)}}function Jv(n,i){if(typeof i!=="object"||i.hasOwnProperty("$in")||i.hasOwnProperty("in"))return i;let h=n["checked-data-type"]==="date";if(i.hasOwnProperty("$gt"))return{$comparator:!0,$op:h?function s(t){return new Date(t[2])>new Date(i.$gt)}:function s(t){return t[2]>i.$gt}};if(i.hasOwnProperty("$gte"))return{$comparator:!0,$op:h?function s(t){return new Date(t[2])>=new Date(i.$gte)}:function s(t){return t[2]>=i.$gte}};if(i.hasOwnProperty("$lt"))return{$comparator:!0,$op:h?function s(t){return new Date(t[2])<new Date(i.$lt)}:function s(t){return t[2]<i.$lt}};if(i.hasOwnProperty("$lte"))return{$comparator:!0,$op:h?function s(t){return new Date(t[2])<=new Date(i.$lte)}:function s(t){return t[2]<=i.$lte}};if(i.hasOwnProperty("$like")){let s=er(!0,i.$like);return{$comparator:!0,$op:function t(l){return s(l[2])}}}if(i.hasOwnProperty("$ilike")){let s=er(!1,i.$ilike);return{$comparator:!0,$op:function t(l){return s(l[2])}}}return i}function Wv(n,i,h,s,t,l){let u=Si(i,h,t),o=Hl(i,h,t),c=u||o;if(!c)throw new bi(`No attr for etype = ${h} label = ${t}`);if(l===null||l===void 0?void 0:l.hasOwnProperty("$isNull")){let f=Si(i,h,"id");if(!f)throw new bi(`No attr for etype = ${h} label = id`);return[n(h,s),f.id,{$isNull:{attrId:c.id,isNull:l.$isNull,reverse:!u}},Th("time")]}if(u)return[n(h,s),c.id,Jv(c,l),Th("time")];return[l,c.id,n(h,s),Th("time")]}function Bv(n,i,h,s,t){let[l,u,o]=t.reduce((c,f)=>{let[r,e,S]=c,[b,m,E]=br(n,i,r,e,f);return[b,m,[...S,E]]},[h,s,[]]);return[l,u,o]}function Ul(n,i,h,s,t,l){let u=t.slice(0,t.length-1),o=t[t.length-1],[c,f,r]=Bv(n,i,h,s,u),e=Wv(n,i,c,f,o,l);return r.concat([e])}function Mv(n,i){return i?[i].concat(n):n}function Rv([n,i]){return n==="or"&&Array.isArray(i)}function Uv([n,i]){return n==="and"&&Array.isArray(i)}function qv(n,i,h){return(s,t)=>{let l=n(s,t);if(i==l)return l;return`${l}-${h}`}}function mr(n,i,h,s,t,l){let u=n(s,t),o=l.map((c,f)=>{let r=qv(n,u,f);return Er(r,h,s,t,c)});return{[i]:{patterns:o,joinSym:u}}}function gv(n){let i=[];for(let h=1;h<=n.length;h++)i.push(n.slice(0,h));return i}function Sr(n,i,h,s,t){return gv(t).map((l)=>Ul(n,i,h,s,l,{$isNull:!0}))}function Er(n,i,h,s,t){return Object.entries(t).flatMap(([l,u])=>{if(Rv([l,u]))return mr(n,"or",i,h,s,u);if(Uv([l,u]))return mr(n,"and",i,h,s,u);if(l==="$entityIdStartsWith")return[];let o=l.split(".");if(u===null||u===void 0?void 0:u.hasOwnProperty("$not")){let c=Ul(n,i,h,s,o,u),f=Sr(n,i,h,s,o);return[{or:{patterns:[c,...f],joinSym:n(h,s)}}]}if((u===null||u===void 0?void 0:u.hasOwnProperty("$isNull"))&&u.$isNull===!0&&o.length>1)return[{or:{patterns:Sr(n,i,h,s,o),joinSym:n(h,s)}}];return Ul(n,i,h,s,o,u)})}function Pv(n,i,h,s){let t=Xs;if(!s)return rr(t,n,i,h);return Er(t,n,i,h,s).concat(rr(t,n,i,h))}function Vv(n,i,h){return[n(i,h),n("time",h)]}function jv(n,i,h,s,t,l){let[u,o,c,f,r]=br(n,i,h,s,t),e=Zv(c,n(h,s),l);return[u,o,e,f,r]}function Av(n,i,{etype:h,level:s,form:t},l){let u=Object.keys(t).filter((o)=>o!=="$");if(!u.length)return Object.values(l);return Object.entries(l).map(function o([c,f]){return u.map(function e(S){var b,m,E;let w=Boolean(i.cardinalityInference&&((E=(m=(b=i.linkIndex)===null||b===void 0?void 0:b[h])===null||m===void 0?void 0:m[S])===null||E===void 0?void 0:E.isSingular));try{let[v,F,T]=jv(n,i,h,s,S,c),L=vr(i,{etype:v,level:F,form:t[S],join:T}),N=w?L[0]:L;return{[S]:N}}catch(v){if(v instanceof bi)return{[S]:w?void 0:[]};throw v}}).reduce(function e(S,b){return Object.assign(Object.assign({},S),b)},f)})}function Ys([n,i],[h,s]){if(i===s||i==null&&s==null)return fr(n,h);if(s==null)return 1;if(i==null)return-1;if(i>s)return 1;return-1}function ql(n){if(n==null)return n;return new Date(n).getTime()}function xv(n,i,h,s){var t;let[l,u,o,c]=n,f=h==="desc"?1:-1;if(((t=i["forward-identity"])===null||t===void 0?void 0:t[2])==="id")return Ys(s,[l,c])===f;let[r,e]=s,S=i["checked-data-type"]==="date"?ql(e):e,b=i["checked-data-type"]==="date"?ql(o):o;return Ys([r,S],[l,b])===f}function Dv(n,i){let h=i[1];return n.attrs[h]}function Iv(n,i,h){let s=Object.keys(h)[0];return Si(n,i,s)}function _v(n,i,h,s){if(h)return Dv(n,h);if(s)return Iv(n,i,s)}function $v(n,i,h){var s,t;if(!Array.isArray(h.fields))return ir(n,i);let l=new Map;for(let u of h.fields){let o=Si(n,i,u),c=(s=o===null||o===void 0?void 0:o["forward-identity"])===null||s===void 0?void 0:s[2];if(c&&Ks(o))l.set(c,o)}if(!l.has("id")){let u=Si(n,i,"id"),o=(t=u===null||u===void 0?void 0:u["forward-identity"])===null||t===void 0?void 0:t[2];if(o)l.set(o,u)}return l}function kv(n,i,h,s,t,l){var u;let o=ur(n,l),c=s===null||s===void 0?void 0:s["start-cursor"],f=_v(n,i,c,t);if(f&&((u=f===null||f===void 0?void 0:f["forward-identity"])===null||u===void 0?void 0:u[2])!=="id"){let S=f["checked-data-type"]==="date",b=f.id;o=o.map(([m])=>{var E,w,v,F,T;let L=(T=(F=(v=(w=(E=n.eav.get(m))===null||E===void 0?void 0:E.get(b))===null||w===void 0?void 0:w.values())===null||v===void 0?void 0:v.next())===null||F===void 0?void 0:F.value)===null||T===void 0?void 0:T[2];if(S)L=ql(L);return[m,L]})}o.sort(h==="asc"?function S(b,m){return Ys(b,m)}:function S(b,m){return Ys(m,b)});let r={},e=$v(n,i,l);for(let S of o){let[b]=S;if(r[b])continue;if(c&&f&&xv(c,f,h,S))continue;let m=nr(n,e,b);if(m)r[b]=m}return r}function pv(n){var i;let h=(i=n.$)===null||i===void 0?void 0:i.order;if(!h)return"asc";return h[Object.keys(h)[0]]||"asc"}function av(n,{etype:i,level:h,form:s,join:t,pageInfo:l}){var u,o,c,f,r,e,S,b,m;let E=((u=s.$)===null||u===void 0?void 0:u.limit)||((o=s.$)===null||o===void 0?void 0:o.first)||((c=s.$)===null||c===void 0?void 0:c.last),w=(f=s.$)===null||f===void 0?void 0:f.offset,v=(r=s.$)===null||r===void 0?void 0:r.before,F=(e=s.$)===null||e===void 0?void 0:e.after,T=(S=s.$)===null||S===void 0?void 0:S.order,L=(b=s.$)===null||b===void 0?void 0:b.fields;if((w||v||F)&&(!l||!l["start-cursor"]))return[];let N=Mv(Pv(n,i,h,(m=s.$)===null||m===void 0?void 0:m.where),t),K=Vv(Xs,i,h),O=kv(n,i,pv(s),l,T,{where:N,find:K,fields:L});if(E!=null){let C=Object.entries(O);if(C.length<=E)return O;return Object.fromEntries(C.slice(0,E))}return O}function nw(n,i){try{return av(n,i)}catch(h){if(h instanceof bi)return{};throw h}}function vr(n,i){let h=nw(n,i);return Av(Xs,n,i,h)}function iw(n){let i={};for(let[h,s]of Object.entries(n))i[h]={startCursor:s["start-cursor"],endCursor:s["end-cursor"],hasNextPage:s["has-next-page?"],hasPreviousPage:s["has-previous-page?"]};return i}function gl({store:n,pageInfo:i,aggregate:h},s){let l={data:Object.keys(s).reduce(function u(o,c){if((h===null||h===void 0?void 0:h[c])||c==="$$ruleParams")return o;return o[c]=vr(n,{etype:c,form:s[c],level:0,pageInfo:i===null||i===void 0?void 0:i[c]}),o},{})};if(i)l.pageInfo=iw(i);if(h)l.aggregate=h;return l}function hw(){return new Set(Object.keys({__etype:1,__ops:1,update:1,link:1,unlink:1,delete:1,merge:1,ruleParams:1}))}var sw=hw();function Pl(n,i,h){return new Proxy({__etype:n,__ops:h},{get:(t,l)=>{if(l==="__ops")return h;if(l==="__etype")return n;if(!sw.has(l))return;return(u)=>{return Pl(n,i,[...h,[l,n,i,u]])}}})}function zs(n){return n.startsWith("lookup__")}function Vl(n){let[i,h,...s]=n.split("__");return[h,JSON.parse(s.join("__"))]}function tw(n){return new Proxy({__etype:n},{get(i,h){if(h==="__etype")return n;let s=h;if(zs(s))return Pl(n,Vl(s),[]);return Pl(n,s,[])}})}function jl(){return new Proxy({},{get(n,i){return tw(i)}})}var lw=jl();function Al(n){return n.__ops}function dr(n,i){let{attrIdMap:h,refSwapAttrIds:s}=n,t=[];for(let u of i){let o=h[u];if(o)t.push(o);else if(Array.isArray(u)&&u.length==2&&h[u[0]]){let[c,f]=u;t.push([h[c],f])}else t.push(u)}let[l]=i;if((l==="add-triple"||l==="retract-triple")&&s.has(i[2])){let u=t[1];t[1]=t[3],t[3]=u}return t}function j(n,i,h){return Object.values(n).find((s)=>{let[t,l,u]=s["forward-identity"];return l===i&&u===h})}function ni(n,i,h){return Object.values(n).find((s)=>{let t=s["reverse-identity"];if(!t)return!1;let[l,u,o]=t;return u===i&&o===h})}function uw(n){if(Array.isArray(n))return n;let i=Object.entries(n);if(i.length!==1)throw new Error("lookup must be an object with a single unique attr and value.");return i[0]}function Dl(n,i,h){return h.indexOf(".")!==-1&&!j(n,i,h)}function Il(n){let[i,h,...s]=n.split(".");if(s.length>0||h!=="id")throw new Error(`${n} is not a valid lookup attribute.`);return i}function ow(n,i,h){if(!Dl(n,i,h))return j(n,i,h);let s=Il(h),t=j(n,i,s)||ni(n,i,s);if(t&&t["value-type"]!=="ref")throw new Error(`${h} does not reference a valid link attribute.`);return t}function _l(n){if(typeof n==="string"&&!zs(n))return null;return typeof n==="string"&&zs(n)?Vl(n):uw(n)}function un(n,i,h){let s=_l(h);if(s===null)return h;let[t,l]=s,u=ow(n,i,t);if(!u||!u["unique?"])throw new Error(`${t} is not a unique attribute.`);return[u.id,l]}function Tr(n,i,h,s){let t=un(n,i,h);if(!Array.isArray(t))return s;return[["add-triple",t,j(n,i,"id").id,t]].concat(s)}function cw(n,[i,h,s]){let t=Object.entries(s).flatMap(([l,u])=>{let o=Array.isArray(u)?u:[u],c=j(n,i,l),f=ni(n,i,l);return o.map((r)=>{return c?["add-triple",un(n,i,h),c.id,un(n,c["reverse-identity"][1],r)]:["add-triple",un(n,f["forward-identity"][1],r),f.id,un(n,i,h)]})});return Tr(n,i,h,t)}function fw(n,[i,h,s]){let t=Object.entries(s).flatMap(([l,u])=>{let o=Array.isArray(u)?u:[u],c=j(n,i,l),f=ni(n,i,l);return o.map((r)=>{return c?["retract-triple",un(n,i,h),c.id,un(n,c["reverse-identity"][1],r)]:["retract-triple",un(n,f["forward-identity"][1],r),f.id,un(n,i,h)]})});return Tr(n,i,h,t)}function rw(n,[i,h,s]){let t=Ol(s),l=un(n,i,h);return[["id",l]].concat(Object.entries(t)).map(([o,c])=>{let f=j(n,i,o);return["add-triple",l,f.id,c]})}function ew(n,[i,h]){return[["delete-entity",un(n,i,h),i]]}function mw(n,[i,h,s]){let t=Ol(s),l=un(n,i,h),u=Object.entries(t).map(([c,f])=>{let r=j(n,i,c);return["deep-merge-triple",l,r.id,f]});return[["add-triple",l,j(n,i,"id").id,l]].concat(u)}function Sw(n,[i,h,s]){return[["rule-params",un(n,i,h),i,s]]}function bw(n){let[i,h,s,t]=n;if(!t)return n;let l=Object.assign({},t);return delete l.id,[i,h,s,l]}function Ew(n,i){let[h,...s]=bw(i);switch(h){case"merge":return mw(n,s);case"update":return rw(n,s);case"link":return cw(n,s);case"unlink":return fw(n,s);case"delete":return ew(n,s);case"ruleParams":return Sw(n,s);default:throw new Error(`unsupported action ${h}`)}}function vw(n){switch(n){case"string":case"date":case"boolean":case"number":return n;default:return}}function ww(n,i,h){var s,t;let l=(t=(s=n.entities[i])===null||s===void 0?void 0:s.attrs)===null||t===void 0?void 0:t[h];if(h==="id")return null;if(!l)throw new Error(`${i}.${h} does not exist in your schema`);let{unique:u,indexed:o}=l===null||l===void 0?void 0:l.config,c=vw(l===null||l===void 0?void 0:l.valueType);return{"index?":o,"unique?":u,"checked-data-type":c}}function xl(n,i,h,s){let t=n?ww(n,i,h):null,l=M(),o=[M(),i,h];return Object.assign(Object.assign({id:l,"forward-identity":o,"value-type":"blob",cardinality:"one","unique?":!1,"index?":!1,isUnsynced:!0},t||{}),s||{})}function dw(n,i,h){return Object.values(n.links).find((t)=>{return t.forward.on===i&&t.forward.label===h||t.reverse.on===i&&t.reverse.label===h})}function Tw(n,i,h){let s=dw(n,i,h);if(!s)throw new Error(`Couldn't find the link ${i}.${h} in your schema`);let{forward:t,reverse:l}=s;return{"forward-identity":[M(),t.on,t.label],"reverse-identity":[M(),l.on,l.label],cardinality:t.has==="one"?"one":"many","unique?":l.has==="one"}}function wr(n,i,h,s){let t=n?Tw(n,i,h):null,l=M(),u=[M(),i,h],o=[M(),h,i];return Object.assign(Object.assign({id:l,"forward-identity":u,"reverse-identity":o,"value-type":"ref",cardinality:"many","unique?":!1,"index?":!1,isUnsynced:!0},t||{}),s||{})}var Nw=new Set(["update","merge","link","unlink"]),Fw=new Set(["link","unlink"]),Lw=new Set(["update","merge"]),Kw=new Set(["link","unlink","update","merge","delete","ruleParams"]),$l={"unique?":!0,"index?":!0},Ow=Object.assign(Object.assign({},$l),{cardinality:"one"});function yw(n){let i=[],[h,s,t,l]=n;if(!Kw.has(h))return i;let u=_l(t);if(u)i.push({etype:s,lookupPair:u});if(h==="link")for(let[o,c]of Object.entries(l)){let f=Array.isArray(c)?c:[c];for(let r of f){let e=_l(r);if(e)i.push({etype:s,lookupPair:e,linkLabel:o})}}return i}function Gw({attrs:n,schema:i},h){var s,t;let[l,u,o]=[new Set,Object.assign({},n),[]];function c(e){u[e.id]=e,o.push(["add-attr",e]),l.add(e.id)}function f(e){if((e===null||e===void 0?void 0:e.isUnsynced)&&!l.has(e.id))o.push(["add-attr",e]),l.add(e.id)}function r(e,S){let b=j(u,e,S),m=ni(u,e,S);if(f(b),f(m),!b&&!m)c(wr(i,e,S,Ow))}for(let e of h)for(let{etype:S,lookupPair:b,linkLabel:m}of yw(e)){let E=b[0];if(m){r(S,m);let w=j(u,S,m),v=ni(u,S,m);f(w),f(v);let F=((s=w===null||w===void 0?void 0:w["reverse-identity"])===null||s===void 0?void 0:s[1])||((t=v===null||v===void 0?void 0:v["forward-identity"])===null||t===void 0?void 0:t[1])||m;if(Dl(u,F,E))r(F,Il(E));else{let T=j(u,F,E);if(!T)c(xl(i,F,E,$l));f(T)}}else if(Dl(u,S,E))r(S,Il(E));else{let w=j(u,S,E);if(!w)c(xl(i,S,E,$l));f(w)}}for(let e of h){let[S,b,m,E]=e;if(Nw.has(S)){let w=Object.keys(E);w.push("id");for(let v of w){let F=j(u,b,v);if(f(F),Lw.has(S)){if(!F)c(xl(i,b,v,v==="id"?{"unique?":!0}:null))}if(Fw.has(S)){let T=ni(u,b,v);if(!F&&!T)c(wr(i,b,v));f(T)}}}}return[u,o]}function Nr(n,i){let s=(Array.isArray(i)?i:[i]).flatMap((o)=>Al(o)),[t,l]=Gw(n,s),u=s.flatMap((o)=>Ew(t,o));return[...l,...u]}var Fr=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};class Wi{constructor(n){this.dbName=n,this._storeName="kv",this._dbPromise=this._init()}_init(){return new Promise((n,i)=>{let h=indexedDB.open(this.dbName,1);h.onerror=(s)=>{i(s)},h.onsuccess=(s)=>{n(s.target.result)},h.onupgradeneeded=(s)=>{s.target.result.createObjectStore(this._storeName)}})}getItem(n){return Fr(this,void 0,void 0,function*(){let i=yield this._dbPromise;return new Promise((h,s)=>{let u=i.transaction([this._storeName],"readonly").objectStore(this._storeName).get(n);u.onerror=(o)=>{s(o)},u.onsuccess=(o)=>{if(u.result)h(u.result);else h(null)}})})}setItem(n,i){return Fr(this,void 0,void 0,function*(){let h=yield this._dbPromise;return new Promise((s,t)=>{let o=h.transaction([this._storeName],"readwrite").objectStore(this._storeName).put(i,n);o.onerror=(c)=>{t(c)},o.onsuccess=(c)=>{s()}})})}}var Yw=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};class Bi{static getIsOnline(){return Yw(this,void 0,void 0,function*(){return navigator.onLine})}static listen(n){let i=()=>{n(!0)},h=()=>{n(!1)};return addEventListener("online",i),addEventListener("offline",h),()=>{removeEventListener("online",i),removeEventListener("offline",h)}}}var Xw=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};class Qs extends Error{constructor(n){var i;let h=((i=n.body)===null||i===void 0?void 0:i.message)||`API Error (${n.status})`;super(h);let s=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,s);if(Error.captureStackTrace)Error.captureStackTrace(this,Qs);this.name="InstantAPIError",this.status=n.status,this.body=n.body}get[Symbol.toStringTag](){return"InstantAPIError"}}function bn(n,i){return Xw(this,void 0,void 0,function*(){let h=yield fetch(n,i),s=yield h.json();return h.status===200?Promise.resolve(s):Promise.reject(new Qs({status:h.status,body:s}))})}var Nh=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};function Lr({apiURI:n,appId:i,email:h}){return bn(`${n}/runtime/auth/send_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":i,email:h})})}function Kr(n){return Nh(this,arguments,void 0,function*({apiURI:i,appId:h,email:s,code:t}){return yield bn(`${i}/runtime/auth/verify_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":h,email:s,code:t})})})}function Or(n){return Nh(this,arguments,void 0,function*({apiURI:i,appId:h,refreshToken:s}){return yield bn(`${i}/runtime/auth/verify_refresh_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":h,"refresh-token":s})})})}function kl(n){return Nh(this,arguments,void 0,function*({apiURI:i,appId:h,code:s,codeVerifier:t}){return yield bn(`${i}/runtime/oauth/token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:h,code:s,code_verifier:t})})})}function yr(n){return Nh(this,arguments,void 0,function*({apiURI:i,appId:h,nonce:s,idToken:t,clientName:l,refreshToken:u}){return yield bn(`${i}/runtime/oauth/id_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:h,nonce:s,id_token:t,client_name:l,refresh_token:u})})})}function Gr(n){return Nh(this,arguments,void 0,function*({apiURI:i,appId:h,refreshToken:s}){return yield bn(`${i}/runtime/signout`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:h,refresh_token:s})})})}var Fh=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};function Cr(n){return Fh(this,arguments,void 0,function*({apiURI:i,appId:h,path:s,file:t,refreshToken:l,contentType:u,contentDisposition:o}){let c={app_id:h,path:s,authorization:`Bearer ${l}`,"content-type":u||t.type};if(o)c["content-disposition"]=o;return yield bn(`${i}/storage/upload`,{method:"PUT",headers:c,body:t})})}function Yr(n){return Fh(this,arguments,void 0,function*({apiURI:i,appId:h,path:s,refreshToken:t}){let{data:l}=yield bn(`${i}/storage/files?app_id=${h}&filename=${encodeURIComponent(s)}`,{method:"DELETE",headers:{"content-type":"application/json",authorization:`Bearer ${t}`}});return l})}function Xr(n){return Fh(this,arguments,void 0,function*({apiURI:i,appId:h,fileName:s,refreshToken:t,metadata:l={}}){let{data:u}=yield bn(`${i}/storage/signed-upload-url`,{method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${t}`},body:JSON.stringify({app_id:h,filename:s})});return u})}function zr(n,i){return Fh(this,void 0,void 0,function*(){return(yield fetch(n,{method:"PUT",body:i,headers:{"Content-Type":i.type}})).ok})}function Qr(n){return Fh(this,arguments,void 0,function*({apiURI:i,appId:h,path:s,refreshToken:t}){let{data:l}=yield bn(`${i}/storage/signed-download-url?app_id=${h}&filename=${encodeURIComponent(s)}`,{method:"GET",headers:{"content-type":"application/json",authorization:`Bearer ${t}`}});return l})}var Lh=!1,pl=!1,al=!1;if(typeof window!=="undefined"&&typeof window.localStorage!=="undefined")Lh=!!window.localStorage.getItem("devBackend"),pl=!!window.localStorage.getItem("__instantLogging"),al=!!window.localStorage.getItem("__devtoolLocalDash");function nu(n,i){if(!i)return n;let h={};return i.forEach((s)=>{h[s]=n[s]}),h}function Zr(n,i,h){var s,t;let l={peers:{}};if(i&&"user"in i?i.user:!0){let o=nu((s=n.user)!==null&&s!==void 0?s:{},i===null||i===void 0?void 0:i.keys);l.user=Object.assign(Object.assign({},o),{peerId:h})}for(let o of Object.keys((t=n.peers)!==null&&t!==void 0?t:{})){let c=(i===null||i===void 0?void 0:i.peers)===void 0,f=Array.isArray(i===null||i===void 0?void 0:i.peers)&&(i===null||i===void 0?void 0:i.peers.includes(o));if(c||f){let r=nu(n.peers[o],i===null||i===void 0?void 0:i.keys);l.peers[o]=Object.assign(Object.assign({},r),{peerId:o})}}return l}function Jr(n,i){if(n.isLoading!==i.isLoading)return!0;if(n.error!==i.error)return!0;if(n.user||i.user){if(!n.user||!i.user)return!0;if(!Kl(n.user,i.user))return!0}if(!Ll(n.peers,i.peers))return!0;for(let s of Object.keys(n.peers))if(!Kl(n.peers[s],i.peers[s]))return!0;return!1}class Hs{constructor(){this.promise=new Promise((n,i)=>{this._resolve=n,this._reject=i})}resolve(n){this._resolve(n)}reject(n){this._reject(n)}}var Zs=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})};class Js{constructor(n,i,h,s,t=(o)=>{return JSON.stringify(o)},l=(o)=>{return JSON.parse(o)},u=100){this._subs=[],this._persister=n,this._key=i,this._onMerge=s,this._loadedCbs=[],this._isLoading=!0,this.currentValue=h,this.toJSON=t,this.fromJSON=l,this._saveThrottleMs=u,this._pendingSaveCbs=[],this._version=0,this._load()}_load(){return Zs(this,void 0,void 0,function*(){let n=this.fromJSON(yield this._persister.getItem(this._key));this._isLoading=!1,this._onMerge(n,this.currentValue);for(let i of this._loadedCbs)i()})}waitForLoaded(){return Zs(this,void 0,void 0,function*(){if(!this._isLoading)return;yield new Promise((i)=>{this._loadedCbs.push(i)})})}isLoading(){return this._isLoading}version(){return this._version}waitForSync(){return Zs(this,void 0,void 0,function*(){if(!this._nextSave)return;yield new Promise((i)=>{this._pendingSaveCbs.push(i)})})}_writeToStorage(){this._persister.setItem(this._key,this.toJSON(this.currentValue));for(let n of this._pendingSaveCbs)n();this._pendingSaveCbs.length=0}flush(){return Zs(this,void 0,void 0,function*(){if(!this._nextSave)return;clearTimeout(this._nextSave),this._writeToStorage()})}_enqueuePersist(n){if(this._nextSave){if(n)this._pendingSaveCbs.push(n);return}this._nextSave=setTimeout(()=>{this._nextSave=null,this._writeToStorage()},this._saveThrottleMs)}set(n,i){if(this._version++,this.currentValue=n(this.currentValue),this._isLoading)this._loadedCbs.push(()=>this._enqueuePersist(i));else this._enqueuePersist(i);for(let h of this._subs)h(this.currentValue)}subscribe(n){return this._subs.push(n),n(this.currentValue),()=>{this._subs=this._subs.filter((i)=>i!==n)}}}function Wr(n,i=[]){n.forEach((h)=>{let{data:s}=h,{"datalog-result":t}=s,{"join-rows":l}=t;for(let u of l)for(let o of u)i.push(o);Wr(h["child-nodes"],i)})}function iu(n){let i=[];return Wr(n,i),i}function Br(n){return Object.values(n.links).reduce((i,h)=>{var s,t,l,u;return(s=i[l=h.forward.on])!==null&&s!==void 0||(i[l]={}),i[h.forward.on][h.forward.label]={isForward:!0,isSingular:h.forward.has==="one",link:h},(t=i[u=h.reverse.on])!==null&&t!==void 0||(i[u]={}),i[h.reverse.on][h.reverse.label]={isForward:!1,isSingular:h.reverse.has==="one",link:h},i},{})}var Ws="v0.18.9";function hu(n){return{info:n?console.info.bind(console):()=>{},debug:n?console.debug.bind(console):()=>{},error:n?console.error.bind(console):()=>{}}}var g=function(n,i,h,s){function t(l){return l instanceof h?l:new h(function(u){u(l)})}return new(h||(h=Promise))(function(l,u){function o(r){try{f(s.next(r))}catch(e){u(e)}}function c(r){try{f(s.throw(r))}catch(e){u(e)}}function f(r){r.done?l(r.value):t(r.value).then(o,c)}f((s=s.apply(n,i||[])).next())})},Vn={CONNECTING:"connecting",OPENED:"opened",AUTHENTICATED:"authenticated",CLOSED:"closed",ERRORED:"errored"},Hw=30000,Zw=0,Mr=1,Jw={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"},su="_instant_oauth_redirect",tu="currentUser",Ww=0;function Bw(n){let i=new WebSocket(n);return i._id=Ww++,i}function Mw(){return typeof window!=="undefined"||typeof chrome!=="undefined"}var Rr={"set-presence":!0,"set-presence-ok":!0,"refresh-presence":!0,"patch-presence":!0};function Rw(n){var i;let h=JSON.parse(n);for(let s in h){let t=h[s];if((i=t===null||t===void 0?void 0:t.result)===null||i===void 0?void 0:i.store)t.result.store=_f(t.result.store)}return h}function Uw(n){var i;let h={};for(let s in n){let t=n[s],l=Object.assign({},t);if((i=t.result)===null||i===void 0?void 0:i.store)l.result=Object.assign(Object.assign({},t.result),{store:If(t.result.store)});h[s]=l}return JSON.stringify(h)}class Bs{constructor(n,i=Wi,h=Bi,s){if(this._isOnline=!0,this._isShutdown=!1,this.status=Vn.CONNECTING,this.queryCbs={},this.queryOnceDfds={},this.authCbs=[],this.attrsCbs=[],this.mutationErrorCbs=[],this.connectionStatusCbs=[],this.mutationDeferredStore=new Map,this._reconnectTimeoutId=null,this._reconnectTimeoutMs=0,this._localIdPromises={},this._errorMessage=null,this._oauthCallbackResponse=null,this._linkIndex=null,this._rooms={},this._roomsPendingLeave={},this._presence={},this._broadcastQueue=[],this._broadcastSubs={},this._currentUserCached={isLoading:!0,error:void 0,user:void 0},this._beforeUnloadCbs=[],this._dataForQueryCache={},this._onMergeQuerySubs=(t,l)=>{let u=t||{},o=Object.assign({},l);Object.entries(l).forEach(([f,r])=>{var e;let S=(e=u===null||u===void 0?void 0:u[f])===null||e===void 0?void 0:e.result,b=r.result;if(S&&!b)o[f].result=S}),Object.keys(u).filter((f)=>!l[f]).slice(0,10).forEach((f)=>{o[f]=u[f]}),this.querySubs.set((f)=>o),this.loadedNotifyAll()},this._onMergePendingMutations=(t,l)=>{let u=new Map([...t.entries(),...l.entries()]);this.pendingMutations.set((c)=>u),this.loadedNotifyAll(),this._rewriteMutations(this.attrs,t).forEach((c,f)=>{if(!l.has(f)&&!c["tx-id"])this._sendMutation(f,c)})},this.getPreviousResult=(t)=>{let l=I(t);return this.dataForQuery(l)},this.notifyOne=(t)=>{var l,u;let o=(l=this.queryCbs[t])!==null&&l!==void 0?l:[],c=(u=this._dataForQueryCache[t])===null||u===void 0?void 0:u.data,f=this.dataForQuery(t);if(!f)return;if(dh(f,c))return;o.forEach((r)=>r.cb(f))},this.notifyOneQueryOnce=(t)=>{var l;let u=(l=this.queryOnceDfds[t])!==null&&l!==void 0?l:[],o=this.dataForQuery(t);u.forEach((c)=>{this._completeQueryOnce(c.q,t,c.dfd),c.dfd.resolve(o)})},this.notifyQueryError=(t,l)=>{(this.queryCbs[t]||[]).forEach((o)=>o.cb({error:l}))},this.pushTx=(t)=>{try{let l=Nr({attrs:this.optimisticAttrs(),schema:this.config.schema},t);return this.pushOps(l)}catch(l){return this.pushOps([],l)}},this.pushOps=(t,l)=>{let u=M(),o={op:"transact","tx-steps":t,error:l};this.pendingMutations.set((f)=>{return f.set(u,o),f});let c=new Hs;return this.mutationDeferredStore.set(u,c),this._sendMutation(u,o),this.notifyAll(),c.promise},this._wsOnOpen=(t)=>{let l=t.target;if(this._ws!==l){this._log.info("[socket][open]",l._id,"skip; this is no longer the current ws");return}this._log.info("[socket][open]",this._ws._id),this._setStatus(Vn.OPENED),this.getCurrentUser().then((u)=>{var o;this._trySend(M(),{op:"init","app-id":this.config.appId,"refresh-token":(o=u.user)===null||o===void 0?void 0:o.refresh_token,versions:this.versions,"__admin-token":this.config.__adminToken})})},this._wsOnMessage=(t)=>{let l=t.target,u=JSON.parse(t.data.toString());if(this._ws!==l){this._log.info("[socket][message]",l._id,u,"skip; this is no longer the current ws");return}this._handleReceive(l._id,JSON.parse(t.data.toString()))},this._wsOnError=(t)=>{let l=t.target;if(this._ws!==l){this._log.info("[socket][error]",l._id,"skip; this is no longer the current ws");return}this._log.error("[socket][error]",l._id,t)},this._wsOnClose=(t)=>{let l=t.target;if(this._ws!==l){this._log.info("[socket][close]",l._id,"skip; this is no longer the current ws");return}this._setStatus(Vn.CLOSED);for(let u of Object.values(this._rooms))u.isConnected=!1;if(this._isShutdown){this._log.info("[socket][close]",l._id,"Reactor has been shut down and will not reconnect");return}this._log.info("[socket][close]",l._id,"schedule reconnect, ms =",this._reconnectTimeoutMs),setTimeout(()=>{if(this._reconnectTimeoutMs=Math.min(this._reconnectTimeoutMs+1000,1e4),!this._isOnline){this._log.info("[socket][close]",l._id,"we are offline, no need to start socket");return}this._startSocket()},this._reconnectTimeoutMs)},this.config=Object.assign(Object.assign({},Jw),n),this._log=hu(n.verbose||Lh||pl),this.versions=Object.assign(Object.assign({},s||{}),{"@instantdb/core":Ws}),this.config.schema)this._linkIndex=Br(this.config.schema);if(!Mw())return;if(typeof BroadcastChannel==="function")this._broadcastChannel=new BroadcastChannel("@instantdb"),this._broadcastChannel.addEventListener("message",(t)=>g(this,void 0,void 0,function*(){var l;if(((l=t.data)===null||l===void 0?void 0:l.type)==="auth"){let u=yield this.getCurrentUser();this.updateUser(u.user)}}));if(this._oauthCallbackResponse=this._oauthLoginInit(),this._initStorage(i),this.getCurrentUser(),h.getIsOnline().then((t)=>{this._isOnline=t,this._startSocket(),h.listen((l)=>{if(l===this._isOnline)return;if(this._log.info("[network] online =",l),this._isOnline=l,this._isOnline)this._startSocket();else this._log.info("Changing status from",this.status,"to",Vn.CLOSED),this._setStatus(Vn.CLOSED)})}),typeof addEventListener!=="undefined")this._beforeUnload=this._beforeUnload.bind(this),addEventListener("beforeunload",this._beforeUnload)}_initStorage(n){this._persister=new n(`instant_${this.config.appId}_5`),this.querySubs=new Js(this._persister,"querySubs",{},this._onMergeQuerySubs,Uw,Rw),this.pendingMutations=new Js(this._persister,"pendingMutations",new Map,this._onMergePendingMutations,(i)=>{return JSON.stringify([...i.entries()])},(i)=>{return new Map(JSON.parse(i))}),this._beforeUnloadCbs.push(()=>{this.pendingMutations.flush(),this.querySubs.flush()})}_beforeUnload(){for(let n of this._beforeUnloadCbs)n()}_finishTransaction(n,i,h){let s=this.mutationDeferredStore.get(i);this.mutationDeferredStore.delete(i);let t=n!=="error"&&n!=="timeout";if(!s&&!t)console.error("Mutation failed",Object.assign({status:n,clientId:i},h));if(!s)return;if(t)s.resolve({status:n,clientId:i});else s.reject(Object.assign({status:n,clientId:i},h))}_setStatus(n,i){this.status=n,this._errorMessage=i,this.notifyConnectionStatusSubs(n)}_flushEnqueuedRoomData(n){var i,h;let s=(h=(i=this._presence[n])===null||i===void 0?void 0:i.result)===null||h===void 0?void 0:h.user,t=this._broadcastQueue[n];if(this._broadcastQueue[n]=[],s)this._trySetPresence(n,s);if(t)for(let l of t){let{topic:u,roomType:o,data:c}=l;this._tryBroadcast(n,o,u,c)}}_handleReceive(n,i){var h,s,t,l;let u=Boolean(this.config.schema)&&("cardinalityInference"in this.config?Boolean(this.config.cardinalityInference):!0);if(!Rr[i.op])this._log.info("[receive]",n,i.op,i);switch(i.op){case"init-ok":this._setStatus(Vn.AUTHENTICATED),this._reconnectTimeoutMs=0,this._setAttrs(i.attrs),this._flushPendingMessages(),this._sessionId=i["session-id"];for(let G of Object.keys(this._rooms))this._tryJoinRoom(G);break;case"add-query-exists":this.notifyOneQueryOnce(I(i.q));break;case"add-query-ok":let{q:o,result:c}=i,f=I(o),r=(s=(h=c===null||c===void 0?void 0:c[0])===null||h===void 0?void 0:h.data)===null||s===void 0?void 0:s["page-info"],e=(l=(t=c===null||c===void 0?void 0:c[0])===null||t===void 0?void 0:t.data)===null||l===void 0?void 0:l.aggregate,S=iu(c),b=ys(this.attrs,S,u,this._linkIndex);this.querySubs.set((G)=>{return G[f].result={store:b,pageInfo:r,aggregate:e},G}),this.notifyOne(f),this.notifyOneQueryOnce(f);break;case"refresh-ok":let{computations:m,attrs:E}=i;this._setAttrs(E);let w=m.map((G)=>{var Q,cn,vn,fn;let Ri=G["instaql-query"],Bn=G["instaql-result"],Ui=I(Ri),j0=iu(Bn),A0=ys(this.attrs,j0,u,this._linkIndex),x0=(cn=(Q=Bn===null||Bn===void 0?void 0:Bn[0])===null||Q===void 0?void 0:Q.data)===null||cn===void 0?void 0:cn["page-info"],D0=(fn=(vn=Bn===null||Bn===void 0?void 0:Bn[0])===null||vn===void 0?void 0:vn.data)===null||fn===void 0?void 0:fn.aggregate;return{hash:Ui,store:A0,pageInfo:x0,aggregate:D0}});w.forEach(({hash:G,store:Q,pageInfo:cn,aggregate:vn})=>{this.querySubs.set((fn)=>{return fn[G].result={store:Q,pageInfo:cn,aggregate:vn},fn})}),w.forEach(({hash:G})=>{this.notifyOne(G)});break;case"transact-ok":let{"client-event-id":v,"tx-id":F}=i,L=this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).get(v);if(!L)break;this.pendingMutations.set((G)=>{return G.delete(v),G});let N=L["tx-steps"];this.querySubs.set((G)=>{var Q;for(let[cn,vn]of Object.entries(G)){let fn=(Q=vn===null||vn===void 0?void 0:vn.result)===null||Q===void 0?void 0:Q.store;if(!fn)continue;let Ri=Zl(fn,N);G[cn].result.store=Ri}return G});let K=L["tx-steps"].filter(([G,...Q])=>G==="add-attr").map(([G,Q])=>Q).concat(Object.values(this.attrs));this._setAttrs(K),this._finishTransaction("synced",v);break;case"patch-presence":{let G=i["room-id"];this._patchPresencePeers(G,i.edits),this._notifyPresenceSubs(G);break}case"refresh-presence":{let G=i["room-id"];this._setPresencePeers(G,i.data),this._notifyPresenceSubs(G);break}case"server-broadcast":let O=i["room-id"],C=i.topic;this._notifyBroadcastSubs(O,C,i);break;case"join-room-ok":let Y=i["room-id"],En=this._rooms[Y];if(!En){if(this._roomsPendingLeave[Y])this._tryLeaveRoom(Y),delete this._roomsPendingLeave[Y];break}En.isConnected=!0,this._notifyPresenceSubs(Y),this._flushEnqueuedRoomData(Y);break;case"join-room-error":let A=i["room-id"],on=this._rooms[A];if(on)on.error=i.error;this._notifyPresenceSubs(A);break;case"error":this._handleReceiveError(i);break;default:break}}_handleMutationError(n,i,h){let s=this.pendingMutations.currentValue.get(i);if(s&&(n!=="timeout"||!s["tx-id"]))this.pendingMutations.set((t)=>{return t.delete(i),t}),this.notifyAll(),this.notifyAttrsSubs(),this.notifyMutationErrorSubs(h),this._finishTransaction(n,i,h)}_handleReceiveError(n){var i,h,s,t,l;let u=n["client-event-id"],o=this.pendingMutations.currentValue.get(u),c={message:n.message||"Uh-oh, something went wrong. Ping Joe & Stopa."};if(n.hint)c.hint=n.hint;if(o){let e={message:n.message,hint:n.hint};this._handleMutationError("error",u,e);return}if(((i=n["original-event"])===null||i===void 0?void 0:i.hasOwnProperty("q"))&&((h=n["original-event"])===null||h===void 0?void 0:h.op)==="add-query"){let e=(s=n["original-event"])===null||s===void 0?void 0:s.q,S=I(e);this.notifyQueryError(I(e),c),this.notifyQueryOnceError(e,S,u,c);return}if(((t=n["original-event"])===null||t===void 0?void 0:t.op)==="init"){if(n.type==="record-not-found"&&((l=n.hint)===null||l===void 0?void 0:l["record-type"])==="app-user"){this.changeCurrentUser(null);return}this._setStatus(Vn.ERRORED,c),this.notifyAll();return}let r=Object.assign({},n);if(delete r.message,delete r.hint,console.error(n.message,r),n.hint)console.error(`This error comes with some debugging information. Here it is: 
`,n.hint)}notifyQueryOnceError(n,i,h,s){var t;let l=(t=this.queryOnceDfds[i])===null||t===void 0?void 0:t.find((u)=>u.eventId===h);if(!l)return;l.dfd.reject(s),this._completeQueryOnce(n,i,l.dfd)}_setAttrs(n){this.attrs=n.reduce((i,h)=>{return i[h.id]=h,i},{}),this.notifyAttrsSubs()}_startQuerySub(n,i){let h=M();return this.querySubs.set((s)=>{return s[i]=s[i]||{q:n,result:null,eventId:h},s}),this._trySendAuthed(h,{op:"add-query",q:n}),h}subscribeQuery(n,i,h){var s;if(h&&"ruleParams"in h)n=Object.assign({$$ruleParams:h.ruleParams},n);let t=I(n),l=this.getPreviousResult(n);if(l)i(l);return this.queryCbs[t]=(s=this.queryCbs[t])!==null&&s!==void 0?s:[],this.queryCbs[t].push({q:n,cb:i}),this._startQuerySub(n,t),()=>{this._unsubQuery(n,t,i)}}queryOnce(n,i){var h;if(i&&"ruleParams"in i)n=Object.assign({$$ruleParams:i.ruleParams},n);let s=new Hs;if(!this._isOnline)return s.reject(new Error("We can't run `queryOnce`, because the device is offline.")),s.promise;if(!this.querySubs)return s.reject(new Error("We can't run `queryOnce` on the backend. Use adminAPI.query instead: https://www.instantdb.com/docs/backend#query")),s.promise;let t=I(n),l=this._startQuerySub(n,t);return this.queryOnceDfds[t]=(h=this.queryOnceDfds[t])!==null&&h!==void 0?h:[],this.queryOnceDfds[t].push({q:n,dfd:s,eventId:l}),setTimeout(()=>s.reject(new Error("Query timed out")),Hw),s.promise}_completeQueryOnce(n,i,h){if(!this.queryOnceDfds[i])return;this.queryOnceDfds[i]=this.queryOnceDfds[i].filter((s)=>s.dfd!==h),this._cleanupQuery(n,i)}_unsubQuery(n,i,h){if(!this.queryCbs[i])return;this.queryCbs[i]=this.queryCbs[i].filter((s)=>s.cb!==h),this._cleanupQuery(n,i)}_cleanupQuery(n,i){var h,s;if(((h=this.queryCbs[i])===null||h===void 0?void 0:h.length)||((s=this.queryOnceDfds[i])===null||s===void 0?void 0:s.length))return;delete this.queryCbs[i],delete this.queryOnceDfds[i],this._trySendAuthed(M(),{op:"remove-query",q:n})}_rewriteMutations(n,i){if(!n)return i;let h=(o)=>{let[c,f,r]=o["forward-identity"];return j(n,f,r)},s=(o)=>{let[c,f,r]=o["forward-identity"];return ni(n,f,r)},t={attrIdMap:{},refSwapAttrIds:new Set},l=(o)=>{let c=[];for(let f of o){let[r]=f;if(r==="add-attr"){let[S,b]=f,m=h(b);if(m){t.attrIdMap[b.id]=m.id;continue}if(b["value-type"]==="ref"){let E=s(b);if(E){t.attrIdMap[b.id]=E.id,t.refSwapAttrIds.add(b.id);continue}}}let e=dr(t,f);c.push(e)}return c},u=new Map;for(let[o,c]of i.entries())u.set(o,Object.assign(Object.assign({},c),{"tx-steps":l(c["tx-steps"])}));return u}optimisticAttrs(){var n;let i=[...this.pendingMutations.currentValue.values()].flatMap((u)=>u["tx-steps"]),h=new Set(i.filter(([u,o])=>u==="delete-attr").map(([u,o])=>o)),s=[];for(let[u,o]of i)if(u==="add-attr")s.push(o);else if(u==="update-attr"&&o.id&&((n=this.attrs)===null||n===void 0?void 0:n[o.id])){let c=Object.assign(Object.assign({},this.attrs[o.id]),o);s.push(c)}let t=[...Object.values(this.attrs||{}),...s].filter((u)=>!h.has(u.id));return Object.fromEntries(t.map((u)=>[u.id,u]))}dataForQuery(n){let i=this._errorMessage;if(i)return{error:i};if(!this.querySubs)return;if(!this.pendingMutations)return;let h=this.querySubs.version(),s=this.querySubs.currentValue,t=this.pendingMutations.version(),l=this.pendingMutations.currentValue,{q:u,result:o}=s[n]||{};if(!o)return;let c=this._dataForQueryCache[n];if(c&&h===c.querySubVersion&&t===c.pendingMutationsVersion)return c.data;let{store:f,pageInfo:r,aggregate:e}=o,b=[...this._rewriteMutations(f.attrs,l).values()].flatMap((w)=>w["tx-steps"]),m=Zl(f,b),E=gl({store:m,pageInfo:r,aggregate:e},u);return this._dataForQueryCache[n]={querySubVersion:h,pendingMutationsVersion:t,data:E},E}notifyAll(){Object.keys(this.queryCbs).forEach((n)=>{this.notifyOne(n)})}loadedNotifyAll(){if(this.pendingMutations.isLoading()||this.querySubs.isLoading())return;this.notifyAll()}shutdown(){var n;this._isShutdown=!0,(n=this._ws)===null||n===void 0||n.close()}_sendMutation(n,i){if(i.error){this._handleMutationError("error",n,{error:i.error,message:i.error.message});return}if(this.status!==Vn.AUTHENTICATED){this._finishTransaction("enqueued",n);return}let h=Math.max(5000,this.pendingMutations.currentValue.size*5000);if(!this._isOnline)this._finishTransaction("enqueued",n);else this._trySend(n,i),setTimeout(()=>{this._finishTransaction("pending",n)},3000),setTimeout(()=>{if(!this._isOnline)return;this._handleMutationError("timeout",n,{message:"transaction timed out"})},h)}_flushPendingMessages(){Object.keys(this.queryCbs).map((s)=>{return this.querySubs.currentValue[s]}).filter((s)=>s).forEach(({eventId:s,q:t})=>{this._trySendAuthed(s,{op:"add-query",q:t})}),Object.values(this.queryOnceDfds).flat().forEach(({eventId:s,q:t})=>{this._trySendAuthed(s,{op:"add-query",q:t})}),this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).forEach((s,t)=>{if(!s["tx-id"])this._sendMutation(t,s)})}_trySendAuthed(...n){if(this.status!==Vn.AUTHENTICATED)return;this._trySend(...n)}_trySend(n,i,h){if(this._ws.readyState!==Mr)return;if(!Rr[i.op])this._log.info("[send]",this._ws._id,i.op,i);this._ws.send(JSON.stringify(Object.assign({"client-event-id":n},i)))}_startSocket(){if(this._ws&&this._ws.readyState==Zw){this._log.info("[socket][start]",this._ws._id,"maintained as current ws, we were still in a connecting state");return}let n=this._ws;if(this._ws=Bw(`${this.config.websocketURI}?app_id=${this.config.appId}`),this._ws.onopen=this._wsOnOpen,this._ws.onmessage=this._wsOnMessage,this._ws.onclose=this._wsOnClose,this._ws.onerror=this._wsOnError,this._log.info("[socket][start]",this._ws._id),(n===null||n===void 0?void 0:n.readyState)===Mr)this._log.info("[socket][start]",this._ws._id,"close previous ws id = ",n._id),n.close()}getLocalId(n){return g(this,void 0,void 0,function*(){let i=`localToken_${n}`,h=yield this._persister.getItem(i);if(h)return h;if(this._localIdPromises[i])return this._localIdPromises[i];let s=M();return this._localIdPromises[i]=this._persister.setItem(i,s).then(()=>s),this._localIdPromises[i]})}_replaceUrlAfterOAuth(){if(typeof URL==="undefined")return;let n=new URL(window.location.href);if(n.searchParams.get(su)){let i=n.toString();n.searchParams.delete(su),n.searchParams.delete("code"),n.searchParams.delete("error");let h=n.pathname+(n.searchParams.size?"?"+n.searchParams:"")+n.hash;if(history.replaceState(history.state,"",h),typeof navigation==="object"&&typeof navigation.addEventListener==="function"&&typeof navigation.removeEventListener==="function"){let s=!1,t=(l)=>{var u;if(!s){if(s=!0,navigation.removeEventListener("navigate",t),!l.userInitiated&&l.navigationType==="replace"&&((u=l.destination)===null||u===void 0?void 0:u.url)===i)history.replaceState(history.state,"",h)}};navigation.addEventListener("navigate",t)}}}_oauthLoginInit(){return g(this,void 0,void 0,function*(){var n,i,h,s;if(typeof window==="undefined"||typeof window.location==="undefined"||typeof URLSearchParams==="undefined")return null;let t=new URLSearchParams(window.location.search);if(!t.get(su))return null;let l=t.get("error");if(l)return this._replaceUrlAfterOAuth(),{error:{message:l}};let u=t.get("code");if(!u)return null;this._replaceUrlAfterOAuth();try{let{user:o}=yield kl({apiURI:this.config.apiURI,appId:this.config.appId,code:u});return this.setCurrentUser(o),null}catch(o){if(((n=o===null||o===void 0?void 0:o.body)===null||n===void 0?void 0:n.type)==="record-not-found"&&((h=(i=o===null||o===void 0?void 0:o.body)===null||i===void 0?void 0:i.hint)===null||h===void 0?void 0:h["record-type"])==="app-oauth-code"&&(yield this._hasCurrentUser()))return null;return{error:{message:((s=o===null||o===void 0?void 0:o.body)===null||s===void 0?void 0:s.message)||"Error logging in."}}}})}_waitForOAuthCallbackResponse(){return g(this,void 0,void 0,function*(){return yield this._oauthCallbackResponse})}__subscribeMutationErrors(n){return this.mutationErrorCbs.push(n),()=>{this.mutationErrorCbs=this.mutationErrorCbs.filter((i)=>i!==n)}}subscribeAuth(n){this.authCbs.push(n);let i=this._currentUserCached;if(!i.isLoading)n(this._currentUserCached);let h=!1;return this.getCurrentUser().then((s)=>{if(h)return;if(dh(s,i))return;n(s)}),()=>{h=!0,this.authCbs=this.authCbs.filter((s)=>s!==n)}}getAuth(){return g(this,void 0,void 0,function*(){let{user:n,error:i}=yield this.getCurrentUser();if(i)throw i;return n})}subscribeConnectionStatus(n){return this.connectionStatusCbs.push(n),()=>{this.connectionStatusCbs=this.connectionStatusCbs.filter((i)=>i!==n)}}subscribeAttrs(n){if(this.attrsCbs.push(n),this.attrs)n(this.attrs);return()=>{this.attrsCbs=this.attrsCbs.filter((i)=>i!==n)}}notifyAuthSubs(n){this.authCbs.forEach((i)=>i(n))}notifyMutationErrorSubs(n){this.mutationErrorCbs.forEach((i)=>i(n))}notifyAttrsSubs(){if(!this.attrs)return;let n=this.optimisticAttrs();this.attrsCbs.forEach((i)=>i(n))}notifyConnectionStatusSubs(n){this.connectionStatusCbs.forEach((i)=>i(n))}setCurrentUser(n){return g(this,void 0,void 0,function*(){yield this._persister.setItem(tu,JSON.stringify(n))})}getCurrentUserCached(){return this._currentUserCached}getCurrentUser(){return g(this,void 0,void 0,function*(){let n=yield this._waitForOAuthCallbackResponse();if(n===null||n===void 0?void 0:n.error){let s={error:n.error,user:void 0};return this._currentUserCached=Object.assign({isLoading:!1},s),s}let i=yield this._persister.getItem(tu),h={user:JSON.parse(i),error:void 0};return this._currentUserCached=Object.assign({isLoading:!1},h),h})}_hasCurrentUser(){return g(this,void 0,void 0,function*(){let n=yield this._persister.getItem(tu);return JSON.parse(n)!=null})}changeCurrentUser(n){return g(this,void 0,void 0,function*(){var i;let{user:h}=yield this.getCurrentUser();if(dh(h,n))return;yield this.setCurrentUser(n),this.updateUser(n);try{(i=this._broadcastChannel)===null||i===void 0||i.postMessage({type:"auth"})}catch(s){console.error("Error posting message to broadcast channel",s)}})}updateUser(n){let i={error:void 0,user:n};this._currentUserCached=Object.assign({isLoading:!1},i),this._dataForQueryCache={},this.querySubs.set((h)=>{return Object.keys(h).forEach((s)=>{delete h[s].result}),h}),this._reconnectTimeoutMs=0,this._ws.close(),this._oauthCallbackResponse=null,this.notifyAuthSubs(i)}sendMagicCode({email:n}){return Lr({apiURI:this.config.apiURI,appId:this.config.appId,email:n})}signInWithMagicCode(n){return g(this,arguments,void 0,function*({email:i,code:h}){let s=yield Kr({apiURI:this.config.apiURI,appId:this.config.appId,email:i,code:h});return yield this.changeCurrentUser(s.user),s})}signInWithCustomToken(n){return g(this,void 0,void 0,function*(){let i=yield Or({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:n});return yield this.changeCurrentUser(i.user),i})}potentiallyInvalidateToken(n,i){var h;let s=(h=n===null||n===void 0?void 0:n.user)===null||h===void 0?void 0:h.refresh_token;if(!s)return;if(i.invalidateToken===!1){this._log.info("[auth-invalidate] skipped invalidateToken");return}Gr({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:s}).then(()=>{this._log.info("[auth-invalidate] completed invalidateToken")}).catch((l)=>{})}signOut(n){return g(this,void 0,void 0,function*(){let i=yield this.getCurrentUser();this.potentiallyInvalidateToken(i,n),yield this.changeCurrentUser(null)})}createAuthorizationURL({clientName:n,redirectURL:i}){let{apiURI:h,appId:s}=this.config;return`${h}/runtime/oauth/start?app_id=${s}&client_name=${n}&redirect_uri=${i}`}exchangeCodeForToken(n){return g(this,arguments,void 0,function*({code:i,codeVerifier:h}){let s=yield kl({apiURI:this.config.apiURI,appId:this.config.appId,code:i,codeVerifier:h});return yield this.changeCurrentUser(s.user),s})}issuerURI(){let{apiURI:n,appId:i}=this.config;return`${n}/runtime/${i}`}signInWithIdToken(n){return g(this,arguments,void 0,function*({idToken:i,clientName:h,nonce:s}){var t;let l=yield this.getCurrentUser(),u=(t=l===null||l===void 0?void 0:l.user)===null||t===void 0?void 0:t.refresh_token,o=yield yr({apiURI:this.config.apiURI,appId:this.config.appId,idToken:i,clientName:h,nonce:s,refreshToken:u});return yield this.changeCurrentUser(o.user),o})}joinRoom(n){if(!this._rooms[n])this._rooms[n]={isConnected:!1,error:void 0};return this._presence[n]=this._presence[n]||{},this._tryJoinRoom(n),()=>{this._cleanupRoom(n)}}_cleanupRoom(n){var i,h,s,t;if(!((h=(i=this._presence[n])===null||i===void 0?void 0:i.handlers)===null||h===void 0?void 0:h.length)&&!Object.keys((s=this._broadcastSubs[n])!==null&&s!==void 0?s:{}).length){let l=(t=this._rooms[n])===null||t===void 0?void 0:t.isConnected;if(delete this._rooms[n],delete this._presence[n],delete this._broadcastSubs[n],l)this._tryLeaveRoom(n);else this._roomsPendingLeave[n]=!0}}getPresence(n,i,h={}){let s=this._rooms[i],t=this._presence[i];if(!s||!t||!t.result)return null;return Object.assign(Object.assign({},Zr(t.result,h,this._sessionId)),{isLoading:!s.isConnected,error:s.error})}publishPresence(n,i,h){let s=this._rooms[i],t=this._presence[i];if(!s||!t)return;t.result=t.result||{};let l=Object.assign(Object.assign({},t.result.user),h);if(t.result.user=l,!s.isConnected)return;this._trySetPresence(i,l),this._notifyPresenceSubs(i)}_trySetPresence(n,i){this._trySendAuthed(M(),{op:"set-presence","room-id":n,data:i})}_tryJoinRoom(n){this._trySendAuthed(M(),{op:"join-room","room-id":n}),delete this._roomsPendingLeave[n]}_tryLeaveRoom(n){this._trySendAuthed(M(),{op:"leave-room","room-id":n})}subscribePresence(n,i,h,s){let t=this.joinRoom(i),l=Object.assign(Object.assign({},h),{roomId:i,cb:s,prev:null});return this._presence[i]=this._presence[i]||{},this._presence[i].handlers=this._presence[i].handlers||[],this._presence[i].handlers.push(l),this._notifyPresenceSub(i,l),()=>{var u,o,c;this._presence[i].handlers=(c=(o=(u=this._presence[i])===null||u===void 0?void 0:u.handlers)===null||o===void 0?void 0:o.filter((f)=>f!==l))!==null&&c!==void 0?c:[],t()}}_notifyPresenceSubs(n){var i,h;(h=(i=this._presence[n])===null||i===void 0?void 0:i.handlers)===null||h===void 0||h.forEach((s)=>{this._notifyPresenceSub(n,s)})}_notifyPresenceSub(n,i){let h=this.getPresence("",n,i);if(!h)return;if(i.prev&&!Jr(h,i.prev))return;i.prev=h,i.cb(h)}_patchPresencePeers(n,i){var h,s,t;let l=((s=(h=this._presence[n])===null||h===void 0?void 0:h.result)===null||s===void 0?void 0:s.peers)||{},u=Object.fromEntries(Object.entries(l).map(([f,r])=>[f,{data:r}])),o=(t=this._presence[n])===null||t===void 0?void 0:t.result,c=vh(u,(f)=>{for(let[r,e,S]of i)switch(e){case"+":Af(f,r,S);break;case"r":Gl(f,r,S);break;case"-":Cl(f,r);break}delete f[this._sessionId]});this._setPresencePeers(n,c)}_setPresencePeers(n,i){let h=Object.assign({},i);delete h[this._sessionId];let s=Object.fromEntries(Object.entries(h).map(([t,l])=>[t,l.data]));this._presence=vh(this._presence,(t)=>{Gl(t,[n,"result","peers"],s)})}publishTopic({roomType:n,roomId:i,topic:h,data:s}){var t;let l=this._rooms[i];if(!l)return;if(!l.isConnected){this._broadcastQueue[i]=(t=this._broadcastQueue[i])!==null&&t!==void 0?t:[],this._broadcastQueue[i].push({topic:h,roomType:n,data:s});return}this._tryBroadcast(i,n,h,s)}_tryBroadcast(n,i,h,s){this._trySendAuthed(M(),{op:"client-broadcast","room-id":n,roomType:i,topic:h,data:s})}subscribeTopic(n,i,h){let s=this.joinRoom(n);return this._broadcastSubs[n]=this._broadcastSubs[n]||{},this._broadcastSubs[n][i]=this._broadcastSubs[n][i]||[],this._broadcastSubs[n][i].push(h),this._presence[n]=this._presence[n]||{},()=>{if(this._broadcastSubs[n][i]=this._broadcastSubs[n][i].filter((t)=>t!==h),!this._broadcastSubs[n][i].length)delete this._broadcastSubs[n][i];s()}}_notifyBroadcastSubs(n,i,h){var s,t,l;(l=(t=(s=this._broadcastSubs)===null||s===void 0?void 0:s[n])===null||t===void 0?void 0:t[i])===null||l===void 0||l.forEach((u)=>{var o,c,f,r,e,S;let b=(o=h.data)===null||o===void 0?void 0:o.data,m=h.data["peer-id"]===this._sessionId?(f=(c=this._presence[n])===null||c===void 0?void 0:c.result)===null||f===void 0?void 0:f.user:(S=(e=(r=this._presence[n])===null||r===void 0?void 0:r.result)===null||e===void 0?void 0:e.peers)===null||S===void 0?void 0:S[h.data["peer-id"]];return u(b,m)})}uploadFile(n,i,h){return g(this,void 0,void 0,function*(){var s;let t=yield this.getCurrentUser(),l=(s=t===null||t===void 0?void 0:t.user)===null||s===void 0?void 0:s.refresh_token;return Cr(Object.assign(Object.assign({},h),{apiURI:this.config.apiURI,appId:this.config.appId,path:n,file:i,refreshToken:l}))})}deleteFile(n){return g(this,void 0,void 0,function*(){var i;let h=yield this.getCurrentUser(),s=(i=h===null||h===void 0?void 0:h.user)===null||i===void 0?void 0:i.refresh_token;return yield Yr({apiURI:this.config.apiURI,appId:this.config.appId,path:n,refreshToken:s})})}upload(n,i){return g(this,void 0,void 0,function*(){var h;let s=yield this.getCurrentUser(),t=(h=s===null||s===void 0?void 0:s.user)===null||h===void 0?void 0:h.refresh_token,l=n||i.name,u=yield Xr({apiURI:this.config.apiURI,appId:this.config.appId,fileName:l,refreshToken:t});return yield zr(u,i)})}getDownloadUrl(n){return g(this,void 0,void 0,function*(){var i;let h=yield this.getCurrentUser(),s=(i=h===null||h===void 0?void 0:h.user)===null||i===void 0?void 0:i.refresh_token;return yield Qr({apiURI:this.config.apiURI,appId:this.config.appId,path:n,refreshToken:s})})}}var Ms;function Ur(n,i){Ms===null||Ms===void 0||Ms.dispose();let h=Aw(i),s=Pw(i,o),t=gw(qw(n));function l(r){var e;if(r.source!==t.element.contentWindow)return;if(((e=r.data)===null||e===void 0?void 0:e.type)==="close"&&h.isVisible())o()}function u(r){let e=r.shiftKey&&r.ctrlKey&&r.key==="0",S=r.key==="Escape"||r.key==="Esc";if(e)o();else if(S&&h.isVisible())o()}function o(){if(h.isVisible())h.element.style.display="none";else if(h.element.style.display="block",!h.element.contains(t.element))h.element.appendChild(t.element)}function c(){h.element.remove(),s.element.remove(),removeEventListener("keydown",u),removeEventListener("message",l)}function f(){document.body.appendChild(h.element),document.body.appendChild(s.element),addEventListener("keydown",u),addEventListener("message",l),Ms={dispose:c}}return f()}function qw(n){return`${Lh||al?"http://localhost:3000":"https://instantdb.com"}/_devtool?appId=${n}`}function gw(n){let i=document.createElement("iframe");return i.src=n,i.className="instant-devtool-iframe",Object.assign(i.style,{width:"100%",height:"100%",backgroundColor:"white",border:"none"}),{element:i}}function Pw(n,i){let s=document.createElement("button");return s.innerHTML=`
    <svg width="32" height="32" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="512" height="512" fill="black"/>
      <rect x="97.0973" y="91.3297" width="140" height="330" fill="white"/>
    </svg>
  `,s.className="instant-devtool-toggler",Object.assign(s.style,Object.assign(Object.assign({position:"fixed"},Vw(n.position)),{height:"32px",width:"32px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"9010",padding:"0",margin:"0",border:"none",cursor:"pointer"})),s.addEventListener("click",i),{element:s}}function Vw(n){switch(n){case"bottom-left":return{bottom:"24px",left:"24px"};case"bottom-right":return{bottom:"24px",right:"24px"};case"top-right":return{top:"24px",right:"24px"};case"top-left":return{top:"24px",left:"24px"}}}function jw(n){switch(n){case"bottom-left":return{bottom:"24px",right:"24px",left:"60px",top:"72px"};case"bottom-right":return{bottom:"24px",left:"24px",right:"60px",top:"72px"};case"top-right":return{top:"24px",left:"24px",right:"60px",bottom:"72px"};case"top-left":return{top:"24px",right:"24px",left:"60px",bottom:"72px"}}}function Aw(n){let i=document.createElement("div");Object.assign(i.style,Object.assign(Object.assign({position:"fixed"},jw(n.position)),{display:"block",borderRadius:"4px",border:"1px #ccc solid",boxShadow:"0px 0px 8px #00000044",backgroundColor:"#eee",zIndex:"999990"})),i.style.display="none",i.className="instant-devtool-container";function h(){return i.style.display!=="none"}return{element:i,isVisible:h}}var xw={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"};function Dw(){var n;return globalThis.__instantDbStore=(n=globalThis.__instantDbStore)!==null&&n!==void 0?n:{},globalThis.__instantDbStore}function lu(n){let i=n.__adminToken;return n.appId+"_"+(n.websocketURI||"default_ws_uri")+"_"+(n.apiURI||"default_api_uri")+"_"+(i||"client_only")}var uu=Dw();class qr{constructor(n){this.db=n,this.sendMagicCode=(i)=>{return this.db.sendMagicCode(i)},this.signInWithMagicCode=(i)=>{return this.db.signInWithMagicCode(i)},this.signInWithToken=(i)=>{return this.db.signInWithCustomToken(i)},this.createAuthorizationURL=(i)=>{return this.db.createAuthorizationURL(i)},this.signInWithIdToken=(i)=>{return this.db.signInWithIdToken(i)},this.exchangeOAuthCode=(i)=>{return this.db.exchangeCodeForToken(i)},this.issuerURI=()=>{return this.db.issuerURI()},this.signOut=(i={invalidateToken:!0})=>{return this.db.signOut(i)}}}class gr{constructor(n){this.db=n,this.uploadFile=(i,h,s={})=>{return this.db.uploadFile(i,h,s)},this.delete=(i)=>{return this.db.deleteFile(i)},this.upload=(i,h)=>{return this.db.upload(i,h)},this.put=this.upload,this.getDownloadUrl=(i)=>{return this.db.getDownloadUrl(i)}}}class Pr{constructor(n){this.tx=jl(),this._reactor=n,this.auth=new qr(this._reactor),this.storage=new gr(this._reactor)}transact(n){return this._reactor.pushTx(n)}getLocalId(n){return this._reactor.getLocalId(n)}subscribeQuery(n,i,h){return this._reactor.subscribeQuery(n,i,h)}subscribeAuth(n){return this._reactor.subscribeAuth(n)}getAuth(){return this._reactor.getAuth()}subscribeConnectionStatus(n){return this._reactor.subscribeConnectionStatus(n)}joinRoom(n="_defaultRoomType",i="_defaultRoomId"){return{leaveRoom:this._reactor.joinRoom(i),subscribeTopic:(s,t)=>this._reactor.subscribeTopic(i,s,t),subscribePresence:(s,t)=>this._reactor.subscribePresence(n,i,s,t),publishTopic:(s,t)=>this._reactor.publishTopic({roomType:n,roomId:i,topic:s,data:t}),publishPresence:(s)=>this._reactor.publishPresence(n,i,s),getPresence:(s)=>this._reactor.getPresence(n,i,s)}}shutdown(){delete uu[lu(this._reactor.config)],this._reactor.shutdown()}queryOnce(n,i){return this._reactor.queryOnce(n,i)}}function Vr(n,i,h,s){let t=uu[lu(n)];if(t)return t;let l=new Bs(Object.assign(Object.assign(Object.assign({},xw),n),{cardinalityInference:n.schema?!0:!1}),i||Wi,h||Bi,Object.assign(Object.assign({},s||{}),{"@instantdb/core":Ws})),u=new Pr(l);return uu[lu(n)]=u,Iw(n.appId,n.devtool),u}function Iw(n,i){if(typeof window==="undefined"||typeof window.location==="undefined"||typeof document==="undefined")return;if(typeof i==="boolean"&&!i)return;let h=Object.assign({position:"bottom-right",allowedHosts:["localhost"]},typeof i==="object"?i:{});if(!h.allowedHosts.includes(window.location.hostname))return;Ur(n,h)}async function Rs(n,i,h,s,t=!1,l=!0){if(!n||!i)return;if(!Object.keys(i).length)return console.log("InstantDB Error: empty query."),!1;else if(Object.keys(i).length>1)return console.log("InstantDB Error: query has several root keys."),!1;let u=Object.keys(i)[0],o=[];try{if(o=t?(await n.query(i))[u]:(await n.queryOnce(i)).data[u],H(h,Function))h(o)}catch(c){if(H(s,Function))s(c)}return o}function jr(n,i,h){if(i.action=="create")i.id=h();if(i.data||={},!i.action)console.log("Inner error: for DB transaction no action was provided");else if(!i.table)console.log("Inner error: for DB transaction ("+i.action+") no table was provided");else if(!i.id)console.log("Inner error: for DB transaction ("+i.action+") no record ID was provided");else if(i.action=="link"&&(!i.links||!Object.keys(i.links).length))console.log("Inner error: for DB transaction (link) no links were provided");else{let s=n.tx[i.table][i.id];if(i.secret)s=s.ruleParams({knownDocId:i.secret});if(i.action=="create")s=s.update(i.data);if(i.action=="update")s=s.merge(i.data);if(i.action=="delete")s=s.delete();if(i.links&&Object.keys(i.links).length&&eu(i.action,["create","update","link"]))s=s.link(i.links);if(i.links&&Object.keys(i.links).length&&i.action=="unlink")s=s.unlink(i.links);return s}return}async function Us(n,i,h,s,t){if(!n||!i||!H(t,Function))return;let l=i;if(H(l,Array))for(let u=0,o=yh(l),c=o.length;u<c;u++){let f=o[u];f=jr(n,f,t)}else l=jr(n,l,t);try{let u=await n.transact(l);if(H(h,Function))h(u);return!0}catch(u){if(H(s,Function))s(u);return!1}}var Ar=Symbol();class qs{[Z](n=null,i=!0,h=!0){this.connection=n?n.connection:void 0}constructor(n){this[Z](),this.connection=n,si(this,Ar)}listen(n={onauth:void 0,onerror:void 0}){return this.connection.subscribeAuth(function(i){if(i.error){if(H(n.onauth,Function))n.onauth(null);if(H(n.onerror,Function))return n.onerror(i.error.message)}else if(!i.user){if(H(n.onauth,Function))return n.onauth(null)}else if(i.user){if(H(n.onauth,Function))return n.onauth(i.user)}else return console.log("Instant DB Error: something went wrong during listening for auth")})}async send(n={email:"",onsuccess:void 0,onerror:void 0}){if(!n.email){if(H(n.onerror,Function))n.onerror();else console.log("Instant DB Error: empty email for sending a code");return!1}try{let i=await this.connection.auth.sendMagicCode({email:n.email});if(H(n.onsuccess,Function))n.onsuccess(i);return!0}catch(i){if(H(n.onerror,Function))n.onerror(i);return!1}}async login(n={email:"",code:"",onsuccess:void 0,onerror:void 0}){if(!n.email||!n.code){if(H(n.onerror,Function))n.onerror();else console.log("Instant DB Error: empty email or code while login");return!1}try{if(await this.connection.auth.signInWithMagicCode({email:n.email,code:n.code}),H(n.onsuccess,Function))n.onsuccess();return!0}catch(i){if(H(n.onerror,Function))n.onerror(i);return!1}}async logout(n={onerror:void 0,onsuccess:void 0}){try{if(await this.connection.auth.signOut(),H(n.onsuccess,Function))n.onsuccess();return!0}catch(i){if(H(n.onerror,Function))n.onerror(i);return!1}}static{x(this,Ar,"Auth",16)}}var xr=Symbol();class _w{[Z](n=null,i=!0,h=!0){var s;this.folding=n&&(s=n.folding)!==void 0?s:!0,this.uid=n?n.uid:void 0,this.connection=n?n.connection:void 0}constructor(n,i){this[Z](),this.connection=n,this.uid=i,si(this,xr)}async read(n={query:{},onsuccess:void 0,onerror:void 0}){return await Rs(this.connection,n.query,n.onsuccess,n.onerror,!0,this.folding)}async write(n={records:void 0,onsuccess:void 0,onerror:void 0}){return await Us(this.connection,n.records,n.onsuccess,n.onerror,this.uid)}static{x(this,xr,"ServerIDB",16)}}var Dr=Symbol();class ou{[Z](n=null,i=!0,h=!0){var s;this.folding=n&&(s=n.folding)!==void 0?s:!0,this.connection=n?n.connection:void 0,this.uid=n?n.uid:void 0,this.auth=n?n.auth:void 0,this.subscriptions=n&&(s=n.subscriptions)!==void 0?s:{}}constructor(n,i){this[Z](),this.connection=n,this.uid=i,this.auth=new qs(this.connection,this.uid),si(this,Dr)}async read(n={query:{},onsuccess:void 0,onerror:void 0}){return await Rs(this.connection,n.query,n.onsuccess,n.onerror,!1,this.folding)}async write(n={records:void 0,onsuccess:void 0,onerror:void 0}){return await Us(this.connection,n.records,n.onsuccess,n.onerror,this.uid)}subscribe(n={name:"",query:{},onupdate:void 0,onerror:void 0}){if(this.subscriptions[n.name])this.subscriptions[n.name]();return this.subscriptions[n.name]=this.connection.subscribeQuery(n.query,function(i){if(i.error){if(H(n.onerror,Function))return n.onerror(i.error.message)}else if(H(n.onupdate,Function))return n.onupdate(i.data)})}unsubscribe(n=""){if(this.subscriptions[n])return this.subscriptions[n]()}static{x(this,Dr,"ClientIDB",16)}}var Ir=Symbol();class _r{[Z](n=null,i=!0,h=!0){var s;this.db=n?n.db:void 0,this.user=n&&(s=n.user)!==void 0?s:void 0,this.todos=n&&(s=n.todos)!==void 0?s:[]}constructor(){if(this[Z](),Zi.appId)this.connect(Zi.appId);si(this,Ir)}connect(n){var i=this;return this.db=new ou(Vr({appId:n}),M),this.db.auth.listen({onauth:function(h){if(i.user=h,q(),h==null)return;return Zi.appId=n,i.db.subscribe({name:"user.todos",query:{$users:{$:{where:{id:h.id}},todos:{}}},onupdate:function(s){return i.todos=s.$users[0].todos,q()}})},onerror:function(h){return console.log(h)}})}send(n){return this.db.auth.send({email:n})}login(n,i){return this.db.auth.login({email:n,code:i})}logout(){var n;return this.db=void 0,n=Zi.appId,delete Zi.appId,this.db.unsubscribe("user.todos"),this.db.auth.logout()}toggle(n){return this.todos[n].completed=!this.todos[n].completed,this.db.write({records:{table:"todos",action:"update",id:this.todos[n].id,data:{completed:this.todos[n].completed}},onerror:function(i){return console.log(i)}})}create(n){let i={text:n,completed:!1};return this.todos.push(i),this.db.write({records:{table:"todos",action:"create",data:i,links:{user:this.user.id}},onerror:function(h){return console.log(h)}})}delete(n){let i=this.todos[n];return this.todos.slice(n,1),this.db.write({records:{table:"todos",action:"delete",id:i.id},onerror:function(h){return console.log(h)}})}static{x(this,Ir,"App",16)}}var $=new _r;Es(),Hi(),an();var $w=Symbol.for("#beforeReconcile"),$r=Symbol.for("#placeChild"),kw=Symbol.for("#afterVisit"),pw=Symbol.for("#afterReconcile"),kr=Symbol(),pr=Symbol(),ar=Symbol(),n0=Symbol(),i0=Symbol(),aw=Symbol();class gs extends Zn{[Z](n=null,i=!0,h=!0){var s;super[Z](...arguments),this.appId=n&&(s=n.appId)!==void 0?s:"ed1679e7-7a85-4d3f-9842-4ed0b9de8644"}async connect(){return await $.connect(this.appId)}render(){var n=this,i,h,s,t=this._ns_||"",l,u,o,c,f,r,e,S;return i=this,i[$w](),(h=s=1,i[kr]===1)||(h=s=0,i[kr]=1),(!h||s&2)&&i.flagSelf$("mmjt6d-af"),(l=i[pr])||(i[pr]=l=J("div",i,`mmjt6d-ag ${t}`,null)),h||l[$r]("AppId"),(o=c=1,u=i[ar])||(o=c=0,i[ar]=u=J("input",i,`mmjt6d-ah input ${t}`,null)),f=i[n0]||(i[n0]=u.bind$("data",[this,"appId"])),o||!u.setup||u.setup(c),u[kw](c),(e=S=1,r=i[i0])||(e=S=0,i[i0]=r=J("button",i,`mmjt6d-ai button ${t}`,null)),e||r.on$("click",{$_:[function(b,m){return n.connect(b)}]},this),e||r[$r]("Connect"),i[pw](s),i}static{x(this,aw,"Connect",2),pn("connect-mmjt6d-aj",this,{name:"Connect"})}}Tn.register("mmjt6d",`.mmjt6d-af:not(#_):not(#_) {display: grid;
place-content: center;
height: 100vh;}

.mmjt6d-ag:not(#_):not(#_) {text-align: center;
font-size: 20px;}

.mmjt6d-ah:not(#_):not(#_) {width: 340px;
text-align: center;
margin-top: 10px;}

.mmjt6d-ai:not(#_):not(#_) {width: 100px;
margin-left: auto;
margin-right: auto;
margin-top: 10px;}

connect-mmjt6d-aj { display:block; }`);Es(),Hi(),an();var nd=Symbol.for("#beforeReconcile"),Mi=Symbol.for("##up"),Wn=Symbol.for("#placeChild"),h0=Symbol.for("#afterVisit"),id=Symbol.for("#afterReconcile"),s0=Symbol(),t0=Symbol(),l0=Symbol(),u0=Symbol(),o0=Symbol(),c0=Symbol(),f0=Symbol(),r0=Symbol(),e0=Symbol(),m0=Symbol(),S0=Symbol(),b0=Symbol(),E0=Symbol(),v0=Symbol(),w0=Symbol(),d0=Symbol(),T0=Symbol(),hd=Symbol();class Ps extends Zn{[Z](n=null,i=!0,h=!0){var s;super[Z](...arguments),this.step=n&&(s=n.step)!==void 0?s:1,this.email=n&&(s=n.email)!==void 0?s:"",this.code=n&&(s=n.code)!==void 0?s:""}async send(){if(await $.send(this.email))return this.step=2}async login(){let n;return n=await $.login(this.email,this.code)}render(){var n=this,i,h,s,t,l,u,o,c,f,r,e,S=this._ns_||"",b,m,E,w,v,F,T,L,N,K,O,C,Y,En,A,on;if(f=this,f[nd](),(r=e=1,f[s0]===1)||(r=e=0,f[s0]=1),(!r||e&2)&&f.flagSelf$("z52g5ok-af"),(b=f[t0])||(f[t0]=b=J("div",f,`${S}`,null)),h=s=t=i=null,this.step==1)i="z52g5ok-ah",(m=E=1,h=f[l0])||(m=E=0,f[l0]=h=J("div",null,`z52g5ok-ai ${S}`,null)),m||(h[Mi]=b),m||h[Wn]("Email"),(w=v=1,s=f[u0])||(w=v=0,f[u0]=s=J("input",null,`z52g5ok-aj input ${S}`,null)),w||(s[Mi]=b),F=s[o0]||(s[o0]=s.bind$("data",[this,"email"])),w||!s.setup||s.setup(v),s[h0](v),(T=L=1,t=f[c0])||(T=L=0,f[c0]=t=J("button",null,`z52g5ok-ak button ${S}`,null)),T||(t[Mi]=b),T||t.on$("click",{$_:[function(G,Q){return n.send(G)}]},this),T||t[Wn]("Send code");if(f[f0]=b[Wn](h,0,f[f0]),f[r0]=b[Wn](s,0,f[r0]),f[e0]=b[Wn](t,0,f[e0]),b.flags.toggle("z52g5ok-ah",!!i),(N=f[m0])||(f[m0]=N=J("div",f,`${S}`,null)),u=o=c=l=null,this.step==2)l="z52g5ok-am",(K=O=1,u=f[S0])||(K=O=0,f[S0]=u=J("div",null,`z52g5ok-an ${S}`,null)),K||(u[Mi]=N),K||u[Wn]("Code"),(C=Y=1,o=f[b0])||(C=Y=0,f[b0]=o=J("input",null,`z52g5ok-ao input ${S}`,null)),C||(o[Mi]=N),En=o[E0]||(o[E0]=o.bind$("data",[this,"code"])),C||!o.setup||o.setup(Y),o[h0](Y),(A=on=1,c=f[v0])||(A=on=0,f[v0]=c=J("button",null,`z52g5ok-ap button ${S}`,null)),A||(c[Mi]=N),A||c.on$("click",{$_:[function(G,Q){return n.login(G)}]},this),A||c[Wn]("Login");return f[w0]=N[Wn](u,0,f[w0]),f[d0]=N[Wn](o,0,f[d0]),f[T0]=N[Wn](c,0,f[T0]),N.flags.toggle("z52g5ok-am",!!l),f[id](e),f}static{x(this,hd,"Login",2),pn("login-z52g5ok-aq",this,{name:"Login"})}}Tn.register("z52g5ok",`.z52g5ok-af:not(#_):not(#_) {display: grid;
place-content: center;
height: 100vh;}

.z52g5ok-ah:not(#_):not(#_) {display: flex;
flex-direction: column;}

.z52g5ok-ai:not(#_):not(#_) {text-align: center;
font-size: 20px;}

.z52g5ok-aj:not(#_):not(#_) {width: 250px;
text-align: center;
margin-top: 10px;}

.z52g5ok-ak:not(#_):not(#_) {width: 100px;
margin-left: auto;
margin-right: auto;
margin-top: 10px;}

.z52g5ok-am:not(#_):not(#_) {display: flex;
flex-direction: column;}

.z52g5ok-an:not(#_):not(#_) {text-align: center;
font-size: 20px;}

.z52g5ok-ao:not(#_):not(#_) {width: 140px;
text-align: center;
margin-top: 10px;
margin-left: auto;
margin-right: auto;}

.z52g5ok-ap:not(#_):not(#_) {width: 100px;
margin-left: auto;
margin-right: auto;
margin-top: 10px;}

login-z52g5ok-aq { display:block; }`);Hi(),an();var sd=Symbol.for("#beforeReconcile"),N0=Symbol.for("##up"),td=Symbol.for("#appendChild"),Vs=Symbol.for("#placeChild"),ld=Symbol.for("#afterVisit"),ud=Symbol.for("#afterReconcile"),F0=Symbol(),L0=Symbol(),K0=Symbol(),O0=Symbol(),y0=Symbol(),G0=Symbol(),C0=Symbol(),Y0=Symbol(),X0=Symbol(),z0=Symbol(),Q0=Symbol(),H0=Symbol(),Z0=Symbol(),J0=Symbol(),od=Symbol();class js extends Zn{get $newtodo(){let n=J("input",null,`input ${this._ns_||""} $newtodo`,null);return Object.defineProperty(this,"$newtodo",{value:n}),n}create(){return $.create(this.$newtodo.value),this.$newtodo.value=""}render(){var n=this,i,h,s,t=this._ns_||"",l,u,o,c,f,r,e,S,b,m,E,w,v,F,T,L,N,K,O,C,Y,En,A,on,G;i=this,i[sd](),(h=s=1,i[F0]===1)||(h=s=0,i[F0]=1),(!h||s&2)&&i.flagSelf$("z1bwdcjs-af"),(l=i[L0])||(i[L0]=l=J("div",i,`z1bwdcjs-ag ${t}`,null)),(u=i[K0])||(i[K0]=(u=this.$newtodo,u[N0]=l,u)),h||l[td](u),(c=f=1,o=i[O0])||(c=f=0,i[O0]=o=J("button",l,`z1bwdcjs-ai button ${t}`,null)),c||o.on$("click",{$_:[function(Q,cn){return n.create(Q)}]},this),c||o[Vs]("Add Todo"),(r=i[y0])||(i[y0]=r=Qc(0,i)),e=0,S=r.$;for(let Q=0,cn=yh($.todos),vn=cn.length;Q<vn;Q++){let fn=cn[Q];(m=E=1,b=S[e])||(m=E=0,S[e]=b=J("div",r,`z1bwdcjs-aj ${t}`,null)),m||(b[N0]=r),(v=F=1,w=b[G0])||(v=F=0,b[G0]=w=J("input",b,`${t}`,null)),v||(w.type="checkbox"),T=fn.completed,T===b[C0]||(w.checked=b[C0]=T),L=b[Y0]||(b[Y0]={$_:[function(Ri,Bn,Ui){return $.toggle(Ui)},null]}),L.$_[1]=Q,v||w.on$("change",L,this),(N=b[X0])||(b[X0]=N=J("div",b,`z1bwdcjs-al ${t}`,null)),K=fn.text,K===b[Q0]&&m||(b[z0]=N[Vs](b[Q0]=K,128,b[z0])),(C=Y=1,O=b[H0])||(C=Y=0,b[H0]=O=J("div",b,`z1bwdcjs-am ${t}`,null)),En=b[Z0]||(b[Z0]={$_:[function(Ri,Bn,Ui){return $.delete(Ui)},null]}),En.$_[1]=Q,C||O.on$("click",En,this),C||O[Vs]("❌"),e++}return r[ld](e),(on=G=1,A=i[J0])||(on=G=0,i[J0]=A=J("button",i,`z1bwdcjs-an button ${t}`,null)),on||A.on$("click",{$_:[function(Q,cn){return $.logout(Q)}]},this),on||A[Vs]("Logout"),i[ud](s),i}static{x(this,od,"Todos",2),pn("todos-z1bwdcjs-ao",this,{name:"Todos"})}}Tn.register("z1bwdcjs",`.z1bwdcjs-af:not(#_):not(#_) {display: grid;
place-content: center;
height: 100vh;
position: relative;}

.z1bwdcjs-ag:not(#_):not(#_) {display: flex;
flex-direction: row;
margin-bottom: 20px;}

.z1bwdcjs-ai:not(#_):not(#_) {margin-left: 10px;}

.z1bwdcjs-aj:not(#_):not(#_) {display: flex;
flex-direction: row;}

.z1bwdcjs-al:not(#_):not(#_) {margin-left: 10px;}

.z1bwdcjs-am:not(#_):not(#_) {margin-left: 10px;
cursor: pointer;}

.z1bwdcjs-an:not(#_):not(#_) {position: absolute;
top: 10px;
right: 10px;}

todos-z1bwdcjs-ao { display:block; }`);Tn.register("z1d8wxvu",`
.button:not(._0) {padding-left: 10px;
padding-right: 10px;
padding-top: 5px;
padding-bottom: 5px;
background-color: hsla(213.33,96.92%,87.25%,100%);
border: 1px solid hsla(224.28,76.33%,48.04%,100%);
cursor: pointer;}
.button:is(:hover,.\\@hover):not(._0) {background-color: hsla(211.70,96.36%,78.43%,100%);}
.button:is(:focus,.\\@focus):not(._0) {outline: none;}
.input:not(._0) {border: 1px solid hsla(211.70,96.36%,78.43%,100%);
padding-left: 5px;
padding-right: 5px;}
.input:is(:focus,.\\@focus):not(._0) {outline: none;
border: 1px solid hsla(211.70,96.36%,78.43%,100%);}`);var cd=Symbol.for("#beforeReconcile"),Ds=Symbol.for("##up"),Is=Symbol.for("#afterVisit"),cu=Symbol.for("#placeChild"),fd=Symbol.for("#afterReconcile"),W0=Symbol(),B0=Symbol(),M0=Symbol(),R0=Symbol(),U0=Symbol(),q0=Symbol(),g0=Symbol(),ii,Kh=Nc(),P0=Symbol(),As,xs,rd=Symbol();class V0 extends Zn{render(){var n,i,h,s,t,l,u,o,c,f,r,e;if(s=this,s[cd](),(t=l=1,s[W0]===1)||(t=l=0,s[W0]=1),n=null,!$.db)(u=o=1,n=s[B0])||(u=o=0,s[B0]=n=kn(gs,null,null,null)),u||(n[Ds]=s),u||!n.setup||n.setup(o),n[Is](o);if(s[M0]=s[cu](n,0,s[M0]),i=null,$.user==null)(c=f=1,i=s[R0])||(c=f=0,s[R0]=i=kn(Ps,null,null,null)),c||(i[Ds]=s),c||!i.setup||i.setup(f),i[Is](f);if(s[U0]=s[cu](i,0,s[U0]),h=null,$.user)(r=e=1,h=s[q0])||(r=e=0,s[q0]=h=kn(js,null,null,null)),r||(h[Ds]=s),r||!h.setup||h.setup(e),h[Is](e);return s[g0]=s[cu](h,0,s[g0]),s[fd](l),s}static{x(this,rd,"App",2),pn("app-sio8xr-aj",this,{name:"App"})}}kt(((As=xs=1,ii=Kh[P0])||(As=xs=0,ii=Kh[P0]=ii=kn(V0,null,null,null)),As||(ii[Ds]=Kh._),As||Kh.sym||!ii.setup||ii.setup(xs),Kh.sym||ii[Is](xs),ii));Tn.register("sio8xr","app-sio8xr-aj { display:block; }");
