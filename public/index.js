var q=Symbol.for("#__init__"),Ze=Symbol.for("#__initor__"),QS=Symbol.for("#__inited__"),Dh=Symbol.for("#__hooks__"),xy=Symbol.for("#__patch__"),ZS=Symbol.for("#has"),gS=Symbol.for("#meta"),JS=Symbol.for("imba"),Dy=Symbol.for("#__mixin__"),WS=Symbol.for("#matcher"),py=Symbol.for("#L"),_y=Symbol.for("#appendChild"),ky=Symbol.for("#afterVisit"),$y=Symbol.for("#beforeReconcile"),ay=Symbol.for("#afterReconcile"),oy=Symbol.for("##up");var Wt={IsExtension:1,IsTag:2,HasDescriptors:4,HasSuperCalls:8,HasConstructor:16,HasFields:32,HasMixins:64,HasInitor:128,HasDecorators:256,IsObjectExtension:512},Oh=new Map,BS=globalThis[JS]||={counter:0,classes:Oh};function ph(i,h={}){return Oh.has(i)||Oh.set(i,{symbol:Symbol(i.name),parent:Object.getPrototypeOf(i.prototype)?.constructor,for:i,uses:null,inits:null,id:BS.counter++,...h}),Oh.get(i)}function ge(i,h){return i===h||h?.[WS]?.(i)}function H(i,h){return typeof h==="string"?typeof i===h:h?.[Symbol.hasInstance]?.(i)}function Je(i,h){return h?.[ZS]?.(i)??h?.includes?.(i)??h?.has?.(i)??!1}function ki(i){return i?.toIterable?.()||i}function Bt(i,h,t,s){let l,u=arguments.length,e=i.length,r=u<3?h:s===null?s=Object.getOwnPropertyDescriptor(h,t):s;while(e>0)if(l=i[--e])r=(u<3?l(r):u>3?l(h,t,r):l(h,t))||r;return u>3&&r&&Object.defineProperty(h,t,r),r}function RS(i,h){if(!i||!h)return!1;if(i.get)return h.get===i.get;if(i.set)return h.set===i.set;if(i.value)return i.value===h.value}function We(i,h,t,s={}){let l=i.constructor;if(!t&&h){if(t=Object.getOwnPropertyDescriptors(h),delete t.constructor,t[q])console.warn(`Cannot define plain fields when extending class ${l.name}`),delete t[q]}let u=ph(l);if(u&&u.augments){let e=new Map;for(let r of Object.keys(t)){let f=Object.getOwnPropertyDescriptor(i,r);for(let m of u.augments){let n=e.get(m);n||e.set(m,n={});let S=Object.getOwnPropertyDescriptor(m.prototype,r);if(S&&!RS(f,S))console.warn("wont extend",r,S,f);else n[r]=t[r]}}for(let[r,f]of e)if(Object.keys(f).length)We(r.prototype,null,f)}return Object.defineProperties(i,t),i}function Be(i,h){let t=ph(i),s=ph(h);if(s.parent){if(!(i.prototype instanceof s.parent))throw new Error(`Mixin ${h.name} has superclass not present in target class`)}if(!s.augments){s.augments=new Set;let u=s.ref=Symbol(h.name),e=Object[Symbol.hasInstance];h.prototype[u]=!0,Object.defineProperty(h,Symbol.hasInstance,{value:function(r){return this===h?r&&!!r[u]:e.call(this,r)}})}if(i.prototype[s.ref])return i;if(s.uses)for(let u of s.uses)Be(i,u);s.augments.add(i),t.uses||=[],t.uses.push(h);let l=Object.getOwnPropertyDescriptors(h.prototype);if(delete l.constructor,l[q])t.inits||=[],t.inits.push(h.prototype[q]),delete l[q];if(Object.defineProperties(i.prototype,l),h?.mixed instanceof Function)h.mixed(i);return i}var mh={cache:{},self:null,target:null,proxy:new Proxy({},{apply:(i,h,...t)=>{return mh.target[h].apply(mh.self,t)},get:(i,h)=>{return Reflect.get(mh.target,h,mh.self)},set:(i,h,t,s)=>{return Reflect.set(mh.target,h,t,mh.self)}})};function zi(i,h,t,s,l=null){let u=Object.getPrototypeOf(i.prototype),e=s&Wt.HasMixins,r;if(e)Oh.set(i,Oh.get(u.constructor)),u=Object.getPrototypeOf(u);if(l){let m=s&Wt.IsObjectExtension?l:l.prototype,n=ph(i);if(n.uses){if(l===m)console.warn("Cannot extend object with mixins");for(let S of n.uses)Be(l,S)}if(s&Wt.HasSuperCalls)mh.cache[h]=Object.create(Object.getPrototypeOf(m),Object.getOwnPropertyDescriptors(m));return We(m,i.prototype),l}let f=u?.constructor;if(r=ph(i,{symbol:h}),Object.defineProperty(i,gS,{value:r,enumerable:!1,configurable:!0}),t&&i.name!==t)Object.defineProperty(i,"name",{value:t,configurable:!0});if(r.flags=s,s&Wt.HasConstructor)i.prototype[Ze]=h;if(r.uses)for(let m of r.uses)m.mixes?.(i);if(f?.inherited instanceof Function)f.inherited(i);return i}function $i(i,h){if(i[Ze]===h)i[QS]?.(),i[Dh]&&i[Dh].inited(i)}var lt=Symbol.for("#__init__"),MS=Symbol.for("#__initor__"),Iy=Symbol.for("#__inited__"),iN=Symbol.for("#__hooks__"),hN=Symbol.for("#__patch__"),tN=Symbol.for("#has"),US=Symbol.for("#meta"),Re=Symbol.for("imba"),sN=Symbol.for("#__mixin__"),lN=Symbol.for("#matcher"),uN=Symbol.for("#L"),eN=Symbol.for("#appendChild"),rN=Symbol.for("#afterVisit"),fN=Symbol.for("#beforeReconcile"),mN=Symbol.for("#afterReconcile"),nN=Symbol.for("##up");var Rt={IsExtension:1,IsTag:2,HasDescriptors:4,HasSuperCalls:8,HasConstructor:16,HasFields:32,HasMixins:64,HasInitor:128,HasDecorators:256,IsObjectExtension:512},Bh=new Map,qS=globalThis[Re]||(globalThis[Re]={counter:0,classes:Bh});function bt(i,h={}){var t;return Bh.has(i)||Bh.set(i,{symbol:Symbol(i.name),parent:(t=Object.getPrototypeOf(i.prototype))==null?void 0:t.constructor,for:i,uses:null,inits:null,id:qS.counter++,...h}),Bh.get(i)}function PS(i,h){if(!i||!h)return!1;if(i.get)return h.get===i.get;if(i.set)return h.set===i.set;if(i.value)return i.value===h.value}function gf(i,h,t,s={}){let l=i.constructor;!t&&h&&(t=Object.getOwnPropertyDescriptors(h),delete t.constructor,t[lt]&&(console.warn(`Cannot define plain fields when extending class ${l.name}`),delete t[lt]));let u=bt(l);if(u&&u.augments){let e=new Map;for(let r of Object.keys(t)){let f=Object.getOwnPropertyDescriptor(i,r);for(let m of u.augments){let n=e.get(m);n||e.set(m,n={});let S=Object.getOwnPropertyDescriptor(m.prototype,r);S&&!PS(f,S)?console.warn("wont extend",r,S,f):n[r]=t[r]}}for(let[r,f]of e)Object.keys(f).length&&gf(r.prototype,null,f)}return Object.defineProperties(i,t),i}function Jf(i,h){let t=bt(i),s=bt(h);if(s.parent&&!(i.prototype instanceof s.parent))throw new Error(`Mixin ${h.name} has superclass not present in target class`);if(!s.augments){s.augments=new Set;let u=s.ref=Symbol(h.name),e=Object[Symbol.hasInstance];h.prototype[u]=!0,Object.defineProperty(h,Symbol.hasInstance,{value:function(r){return this===h?r&&!!r[u]:e.call(this,r)}})}if(i.prototype[s.ref])return i;if(s.uses)for(let u of s.uses)Jf(i,u);s.augments.add(i),t.uses||(t.uses=[]),t.uses.push(h);let l=Object.getOwnPropertyDescriptors(h.prototype);return delete l.constructor,l[lt]&&(t.inits||(t.inits=[]),t.inits.push(h.prototype[lt]),delete l[lt]),Object.defineProperties(i.prototype,l),(h==null?void 0:h.mixed)instanceof Function&&h.mixed(i),i}var Sh={cache:{},self:null,target:null,proxy:new Proxy({},{apply:(i,h,...t)=>Sh.target[h].apply(Sh.self,t),get:(i,h)=>Reflect.get(Sh.target,h,Sh.self),set:(i,h,t,s)=>Reflect.set(Sh.target,h,t,Sh.self)})};function y(i,h,t,s,l=null){var u;let e=Object.getPrototypeOf(i.prototype),r=s&Rt.HasMixins,f;if(r&&(Bh.set(i,Bh.get(e.constructor)),e=Object.getPrototypeOf(e)),l){let n=s&Rt.IsObjectExtension?l:l.prototype,S=bt(i);if(S.uses){l===n&&console.warn("Cannot extend object with mixins");for(let d of S.uses)Jf(l,d)}return s&Rt.HasSuperCalls&&(Sh.cache[h]=Object.create(Object.getPrototypeOf(n),Object.getOwnPropertyDescriptors(n))),gf(n,i.prototype),l}let m=e==null?void 0:e.constructor;if(f=bt(i,{symbol:h}),Object.defineProperty(i,US,{value:f,enumerable:!1,configurable:!0}),t&&i.name!==t&&Object.defineProperty(i,"name",{value:t,configurable:!0}),f.flags=s,s&Rt.HasConstructor&&(i.prototype[MS]=h),f.uses)for(let n of f.uses)(u=n.mixes)==null||u.call(n,i);return(m==null?void 0:m.inherited)instanceof Function&&m.inherited(i),i}var bs=Symbol.for("#__listeners__");var VS=Symbol(),Wf=class{static for(i){return new Proxy({},new this(i))}constructor(i){this.getter=i}get target(){return this.getter()}get(i,h){return this.target[h]}set(i,h,t){return this.target[h]=t,!0}},jS=Wf;(()=>{y(Wf,VS,"LazyProxy",16)})();function AS(i,h={}){return new Proxy(h,new jS(i))}function Mt(i){let h=typeof i;if(h=="number")return i;if(h=="string"){if(/^\d+fps$/.test(i))return 1000/parseFloat(i);if(/^([-+]?[\d\.]+)s$/.test(i))return parseFloat(i)*1000;if(/^([-+]?[\d\.]+)ms$/.test(i))return parseFloat(i)}return null}function uu(i,h,t){if(!i)return;let s=Object.getOwnPropertyDescriptor(i,h);return s||i==t?s||void 0:uu(Reflect.getPrototypeOf(i),h,t)}var Me=function(i,h,t){let s,l,u;for(;(s=t)&&(t=t.next);)(l=t.listener)&&(t.path&&l[t.path]?u=h?l[t.path].apply(l,h):l[t.path]():u=h?l.apply(t,h):l.call(t)),t.times&&--t.times<=0&&(s.next=t.next,t.listener=null)};function hh(i,h,t,s){let l,u,e;return l=i[bs]||(i[bs]={}),u=l[h]||(l[h]={}),e=u.tail||(u.tail=u.next={}),e.listener=t,e.path=s,u.tail=e.next={},e}function vi(i,h,t){let s=hh(i,h,t);return s.times=1,s}function Ks(i,h,t,s){if(!t)return;let l,u,e=i[bs];if(!!e&&(l=e[h])){for(;(u=l)&&(l=l.next);)if(l==t||l.listener==t){u.next=l.next,l.listener=null;break}}}function th(i,h,t=null){let s;(s=i[bs])&&(s[h]&&Me(h,t,s[h]),s.all&&Me(h,[h,t],s.all))}var xS=Symbol(),Bf=class{emit(i,...h){return th(this,i,h)}on(i,...h){return hh(this,i,...h)}once(i,...h){return vi(this,i,...h)}un(i,...h){return Ks(this,i,...h)}},eu=Bf;(()=>{y(Bf,xS,"Emitter",0)})();function rl(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function DS(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var Ue=Symbol.for("#__init__"),qe=Symbol.for("#schedule"),Al=Symbol.for("#frames"),Ut=Symbol.for("#interval"),Lh=Symbol.for("#stage"),Kh=Symbol.for("#scheduled"),qt=Symbol.for("#version"),pS=Symbol.for("#fps"),Pe=Symbol.for("#ticker"),_S=globalThis.requestAnimationFrame||function(i){return globalThis.setTimeout(i,16.666666666666668)};var kS=Symbol(),Rf=class{constructor(i=null){this[Ue](i)}[Ue](i=null,h=!0,t=!0){var s;this.owner=i&&(s=i.owner)!==void 0?s:null,this.target=i&&(s=i.target)!==void 0?s:null,this.active=i&&(s=i.active)!==void 0?s:!1,this.value=i&&(s=i.value)!==void 0?s:void 0,this.skip=i&&(s=i.skip)!==void 0?s:0,this.last=i&&(s=i.last)!==void 0?s:0}tick(i,h){return this.last=this.owner[Al],this.target.tick(this,h),1}update(i,h){let t=this.active,s=i.value;return this.value!=s&&(this.deactivate(),this.value=s),(this.value||t||h)&&this.activate(),this}queue(){this.owner.add(this)}activate(){return this.value===!0?this.owner.on("commit",this):this.value===!1||typeof this.value=="number"&&(this.value/16.666666666666668<=2?this.owner.on("raf",this):this[Ut]=globalThis.setInterval(this.queue.bind(this),this.value)),this.active=!0,this}deactivate(){return this.value===!0&&this.owner.un("commit",this),this.owner.un("raf",this),this[Ut]&&(globalThis.clearInterval(this[Ut]),this[Ut]=null),this.active=!1,this}},$S=Rf;(()=>{y(Rf,kS,"Scheduled",16)})();var aS=Symbol(),Mf=class{constructor(){var i=this;this.id=Symbol(),this.queue=[],this.stage=-1,this[Lh]=-1,this[Al]=0,this[Kh]=!1,this[qt]=0,this.listeners={},this.intervals={},this.commit=function(){return i.add("commit"),i},this[pS]=0,this.$promise=null,this.$resolve=null,this[Pe]=function(h){return i[Kh]=!1,i.tick(h)}}touch(){return this[qt]++}get version(){return this[qt]}add(i,h=!1){return(h||this.queue.indexOf(i)==-1)&&this.queue.push(i),this[Kh]||this[qe](),this}get committingΦ(){return this.queue.indexOf("commit")>=0}get syncingΦ(){return this[Lh]==1}listen(i,h){let t=this.listeners[i],s=!t;return t||(t=this.listeners[i]=new Set),t.add(h),i=="raf"&&s&&this.add("raf"),this}unlisten(i,h){var t;let s=this.listeners[i];return s&&s.delete(h),i=="raf"&&s&&s.size==0&&(t=this.listeners.raf,delete this.listeners.raf),this}on(i,h){return this.listen(i,h)}un(i,h){return this.unlisten(i,h)}get promise(){var i=this;return this.$promise||(this.$promise=new Promise(function(h){return i.$resolve=h}))}tick(i){var h=this;let t=this.queue,s=this[Al]++;if(this.ts||(this.ts=i),this.dt=i-this.ts,this.ts=i,this.queue=[],this[Lh]=1,this[qt]++,t.length)for(let l=0,u=DS(t),e=u.length;l<e;l++){let r=u[l];typeof r=="string"&&this.listeners[r]?this.listeners[r].forEach(function(f){if(rl(f.tick,Function))return f.tick(h,r);if(rl(f,Function))return f(h,r)}):rl(r,Function)?r(this.dt,this):r.tick&&r.tick(this.dt,this)}return this[Lh]=this[Kh]?0:-1,this.$promise&&(this.$resolve(this),this.$promise=this.$resolve=null),this.listeners.raf&&this.add("raf"),this}[qe](){return this[Kh]||(this[Kh]=!0,this[Lh]==-1&&(this[Lh]=0),_S(this[Pe])),this}schedule(i,h){var t,s;return h||(h=i[t=this.id]||(i[t]={value:!0})),(h[s=this.id]||(h[s]=new $S({owner:this,target:i}))).update(h,!0)}unschedule(i,h={}){h||(h=i[this.id]);let t=h&&h[this.id];return t&&t.active&&t.deactivate(),this}},oS=Mf;(()=>{y(Mf,aS,"Scheduler",16)})();var a=new oS;function W(){return a.add("commit").promise}function cS(i,h){return globalThis.setTimeout(function(){i(),W()},h)}function IS(i,h){return globalThis.setInterval(function(){i(),W()},h)}var{clearInterval:ib,clearTimeout:hb}=globalThis,Tt=globalThis.imba||(globalThis.imba={});Tt.commit=W;Tt.setTimeout=cS;Tt.setInterval=IS;Tt.clearInterval=ib;Tt.clearTimeout=hb;var Gs={on:function(i,h){return hh(this,i,h)},inited:function(i){return th(this,"inited",[i])}};function Uf(){return!0}var tb=Symbol(),fl,SN=new(fl=class{},(()=>{y(fl,tb,"Env",0)})(),fl);function sb(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Pt=Symbol.for("#idler"),_h=Symbol.for("#resolve"),lb=Symbol(),qf=class extends Set{constructor(){super(),this[Pt]=Promise.resolve(this)}emit(i,...h){return th(this,i,h)}on(i,...h){return hh(this,i,...h)}once(i,...h){return vi(this,i,...h)}un(i,...h){return Ks(this,i,...h)}add(i){var h=this;if(sb(i,Function)&&(i=i()),!this.has(i)){let t=this.size==0;super.add(i),t&&(this[Pt]=this[_h]=null,this.emit("busy",this)),this.emit("add",i,this);let s=function(){return h.delete(i)};i.then(s,s)}return i}delete(i){return super.delete(i)?(this.emit("delete",i,this),this.size==0&&(this[_h]&&(this[_h](!0),this[_h]=null),this.emit("idle",this)),!0):!1}get idle(){var i=this;return this[Pt]||(this[Pt]=new Promise(function(h){return i.size==0?h(!0):i[_h]=h}))}get idleΦ(){return this.size==0}then(i,h){return this.idle.then(i,h)}},ub=qf;(()=>{y(qf,lb,"Queue",24)})();var bN=Symbol.for("#L");var Ve=Symbol.for("#toStringDeopt"),je=Symbol.for("#symbols"),Ae=Symbol.for("#batches"),xe=Symbol.for("#extras"),De=Symbol.for("#stacks"),eb=Symbol(),Pf=class{constructor(i){this.dom=i,this.string=""}contains(i){return this.dom.classList.contains(i)}has(i){return this.dom.classList.contains(i)}add(i){return this.contains(i)?this:(this.string+=(this.string?" ":"")+i,this.dom.classList.add(i),this)}remove(i){if(!this.contains(i))return this;let h=new RegExp("(^|\\s)"+i+"(?=\\s|$)","g");return this.string=this.string.replace(h,""),this.dom.classList.remove(i),this}toggle(i,h){return h===void 0&&(h=!this.contains(i)),h?this.add(i):this.remove(i)}incr(i,h=0){var t=this;let s=this.stacks,l=s[i]||0;return l<1&&this.add(i),h>0&&setTimeout(function(){return t.decr(i)},h),s[i]=Math.max(l,0)+1}decr(i){let h=this.stacks,t=h[i]||0;return t==1&&this.remove(i),h[i]=Math.max(t,1)-1}reconcile(i,h){let t=this[je],s=this[Ae],l=!0;if(!t)t=this[je]=[i],s=this[Ae]=[h||""],this.toString=this.valueOf=this[Ve];else{let u=t.indexOf(i),e=h||"";u==-1?(t.push(i),s.push(e)):s[u]!=e?s[u]=e:l=!1}l&&(this[xe]=" "+s.join(" "),this.sync())}valueOf(){return this.string}toString(){return this.string}[Ve](){return this.string+(this[xe]||"")}sync(){return this.dom.flagSync$()}get stacks(){return this[De]||(this[De]={})}},Vf=Pf;(()=>{y(Pf,eb,"Flags",16)})();var pe=Symbol.for("#__init__"),ml=Symbol.for("#getRenderContext"),rb=Symbol.for("#getDynamicContext"),ii={context:null},fb=Symbol(),jf=class{constructor(i=null){this[pe](i)}[pe](i=null,h=!0,t=!0){var s;this.stack=i&&(s=i.stack)!==void 0?s:[]}push(i){return this.stack.push(i)}pop(i){return this.stack.pop()}},mb=jf;(()=>{y(jf,fb,"Renderer",16)})();var ds=new mb,nb=Symbol(),ru=class extends Map{constructor(i,h=null){super(),this._=i,this.sym=h}pop(){return ii.context=null}[ml](i){let h=this.get(i);return h||this.set(i,h=new ru(this._,i)),ii.context=h}[rb](i,h){return this[ml](i)[ml](h)}run(i){return this.value=i,ii.context==this&&(ii.context=null),this.get(i)}cache(i){return this.set(this.value,i),i}},Ys=ru;(()=>{y(ru,nb,"RenderContext",16)})();function Af(i,h=Symbol(),t=i){return ii.context=i[h]||(i[h]=new Ys(t,h))}function xf(){let i=ii.context,h=i||new Ys(null);return globalThis.DEBUG_IMBA&&!i&&ds.stack.length>0&&console.trace("detected unmemoized nodes in",ds.stack.slice(0),"see https://imba.io",h),i&&(ii.context=null),h}function _e(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function Sb(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var ut=Symbol.for("#parent"),ke=Symbol.for("#closestNode"),bb=Symbol.for("#parentNode"),db=Symbol.for("#context"),Df=Symbol.for("##inited"),nl=Symbol.for("#getRenderContext"),wb=Symbol.for("#getDynamicContext"),$e=Symbol.for("#insertChild"),dt=Symbol.for("#appendChild"),Sl=Symbol.for("#replaceChild"),ae=Symbol.for("#removeChild"),Ui=Symbol.for("#insertInto"),oe=Symbol.for("#insertIntoDeopt"),kh=Symbol.for("#removeFrom"),ce=Symbol.for("#removeFromDeopt"),Gh=Symbol.for("#replaceWith"),Ie=Symbol.for("#replaceWithDeopt"),bl=Symbol.for("#placeholderNode"),vb=Symbol.for("#attachToParent"),Eb=Symbol.for("#detachFromParent"),ir=Symbol.for("#placeChild"),Tb=Symbol.for("#beforeReconcile"),yb=Symbol.for("#afterReconcile"),Nb=Symbol.for("#afterVisit"),zb=Symbol.for("#visitContext"),pf=Symbol.for("#__init__"),_f=Symbol.for("##parent"),dl=Symbol.for("##up"),hr=Symbol.for("##context"),nh=Symbol.for("#domNode"),Vt=Symbol.for("##placeholderNode"),tr=Symbol.for("#forNode"),sr=Symbol.for("#domDeopt"),jt=Symbol.for("##visitContext"),Fb=Symbol.for("#isRichElement"),lr=Symbol.for("#src"),ss=Symbol.for("#htmlNodeName"),Ob=Symbol.for("#getSlot"),dN=Symbol.for("#ImbaElement"),ur=Symbol.for("#cssns"),Lb=Symbol.for("#cssid"),kf=window.Event,wN=window.UIEvent,vN=window.FocusEvent,Kb=window.MouseEvent,Gb=window.PointerEvent,Yb=window.KeyboardEvent,Wi=window.CustomEvent,$f=window.Node,er=window.Comment,Xb=window.Text,ti=window.Element,EN=window.HTMLElement,TN=window.HTMLHtmlElement,Cb=window.HTMLSelectElement,Hb=window.HTMLInputElement,Qb=window.HTMLTextAreaElement,Zb=window.HTMLButtonElement,gb=window.HTMLOptionElement,yN=window.HTMLScriptElement,NN=window.SVGElement,zN=window.DocumentFragment,FN=window.ShadowRoot,Jb=window.Document,ON=window.Window,LN=window.customElements,rr={};function af(i,h,t){if(!i)return t[h]=null;if(t[h]!==void 0)return t[h];let s=Object.getOwnPropertyDescriptor(i,h);return s!==void 0||i==SVGElement?t[h]=s||null:af(Reflect.getPrototypeOf(i),h,t)}var xl={},Dl={},Wb={},Bb={};function wl(){return globalThis.document}var Rb={get(i,h){let t=i,s;for(;t&&s==null;)(t=t[ut])&&(s=t[h]);return s},set(i,h,t){let s=i,l;for(;s&&l==null;){if(uu(s,h,Element))return s[h]=t,!0;s=s[ut]}return!0}},Mb=Symbol(),Ub=class{get flags(){return this.documentElement.flags}emit(...i){return this.documentElement.emit(...i)}};(()=>{y(Ub,Mb,"Document",1,Document)})();Node.prototype[pf]=function(){return this};var qb=Symbol(),Pb=class{get[ut](){return this[_f]||this.parentNode||this[dl]}get[ke](){return this}get[bb](){var i;return(i=this[ut])==null?void 0:i[ke]}get[db](){return this[hr]||(this[hr]=new Proxy(this,Rb))}[Df](){return this}[nl](i){return Af(this,i)}[wb](i,h){return this[nl](i)[nl](h)}[$e](i,h){return i[Ui](this,h)}[dt](i){return i[Ui](this,null)}[Sl](i,h){let t=this[$e](i,h);return this[ae](h),t}[ae](i){return i[kh](this)}[Ui](i,h=null){return h?i.insertBefore(this,h):i.appendChild(this),this}[oe](i,h){return h?i.insertBefore(this[nh]||this,h):i.appendChild(this[nh]||this),this}[kh](i){return i.removeChild(this)}[ce](i){return i.removeChild(this[nh]||this)}[Gh](i,h){return h[Sl](i,this)}[Ie](i,h){return h[Sl](i,this[nh]||this)}get[bl](){let i;return this[Vt]||(this[Vt]=(i=globalThis.document.createComment("placeholder"),i[tr]=this,i))}set[bl](i){let h=this[Vt];this[Vt]=i,i[tr]=this,h&&h!=i&&h.parentNode&&h[Gh](i)}[vb](){let i=this[nh],h=i&&i.parentNode;return i&&h&&i!=this&&(this[nh]=null,this[Ui](h,i),i[kh](h)),this}[Eb](){this[sr]!=!0&&(this[sr]=!0,!0)&&(this[Gh]=this[Ie],this[kh]=this[ce],this[Ui]=this[oe],this[dl]||(this[dl]=this[ut]));let i=this[bl];return this.parentNode&&i!=this&&(i[Ui](this.parentNode,this),this[kh](this.parentNode)),this[nh]=i,this}[ir](i,h,t){let s=typeof i;if(s==="undefined"||i===null){if(t&&_e(t,Comment))return t;let l=globalThis.document.createComment("");return t?t[Gh](l,this):l[Ui](this,null)}if(i===t)return i;if(s!=="object"){let l,u=i;return t?_e(t,Text)?(t.textContent=u,t):(l=globalThis.document.createTextNode(u),t[Gh](l,this),l):(this.appendChild(l=globalThis.document.createTextNode(u)),l)}else return i[Ui]?t?t[Gh](i,this):i[Ui](this,null):this[ir](String(i),h,t)}};(()=>{y(Pb,qb,"Node",1,Node)})();var Vb=Symbol(),jb=class{log(...i){return console.log(...i)}get hiddenΦ(){var i,h;let t=globalThis.getComputedStyle(this);return t.display=="none"||t.visibility=="hidden"?!0:this.offsetParent||this===globalThis.document.body?!1:(h=(i=this.parentElement)==null?void 0:i.hiddenΦ)!=null?h:!0}get detachedΦ(){return!globalThis.document.documentElement.contains(this)}get unobstructedΦ(){let i=this.getBoundingClientRect(),h=window.visualViewport,t=i.left+i.width*0.5,s=i.top+i.height*0.5;if(h.width>t&&t>0&&h.height>s&&s>0){let l=globalThis.document.elementFromPoint(t,s);return!!(l&&(l.contains(this)||this.contains(l)))}return!1}get focusΦ(){return globalThis.document.activeElement==this}get focinΦ(){return this.contains(globalThis.document.activeElement)}emit(i,h,t={}){var s,l,u;h!=null&&((s=t.detail)!=null||(t.detail=h)),(l=t.bubbles)!=null||(t.bubbles=!0),(u=t.cancelable)!=null||(t.cancelable=!0);let e=new CustomEvent(i,t);t.original&&(e.originalEvent=t.original);let r=this.dispatchEvent(e);return e}text$(i){return this.textContent=i,this}[Tb](){return this}[yb](){return this}[Nb](){this[jt]&&(this[jt]=null)}get[zb](){return this[jt]||(this[jt]={})}get flags(){return this.$flags||(this.$flags=new Vf(this),this.flag$==Element.prototype.flag$&&(this.flags$ext=this.className),this.flagDeopt$()),this.$flags}flag$(i){let h=this.flags$ns;this.className=h?h+(this.flags$ext=i):this.flags$ext=i}flagDeopt$(){var i=this;this.flag$=this.flagExt$,this.flagSelf$=function(h){return i.flagSync$(i.flags$own=h)}}flagExt$(i){return this.flagSync$(this.flags$ext=i)}flagSelf$(i){return this.flagDeopt$(),this.flagSelf$(i)}flagSync$(){return this.className=(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||"")}set$(i,h){let t=uu(this,i,Element);!t||!t.set?this.setAttribute(i,h):this[i]=h}get richValue(){return this.value}set richValue(i){this.value=i}};(()=>{y(jb,Vb,"Element",1,Element)})();Element.prototype.setns$=Element.prototype.setAttributeNS;Element.prototype[Fb]=!0;function J(i,h,t,s){let l=globalThis.document.createElement(i);return t&&(l.className=t),s!==null&&l.text$(s),h&&h[dt]&&h[dt](l),l}var Ab=Symbol(),xb=class{set$(i,h){var t;let s=rr[t=this.nodeName]||(rr[t]={}),l=af(this,i,s);!l||!l.set?this.setAttribute(i,h):this[i]=h}flag$(i){let h=this.flags$ns;this.setAttribute("class",h?h+(this.flags$ext=i):this.flags$ext=i)}flagSelf$(i){var h=this;return this.flag$=function(t){return h.flagSync$(h.flags$ext=t)},this.flagSelf$=function(t){return h.flagSync$(h.flags$own=t)},this.flagSelf$(i)}flagSync$(){return this.setAttribute("class",(this.flags$ns||"")+(this.flags$ext||"")+" "+(this.flags$own||"")+" "+(this.$flags||""))}};(()=>{y(xb,Ab,"SVGElement",1,SVGElement)})();var Db=Symbol(),pb=class{set src(i){if(this[lr]!=i&&(this[lr]=i,!0)){if(i&&i.adoptNode)i.adoptNode(this);else if(i&&i.type=="svg"){if(i.attributes)for(let h=i.attributes,t=0,s=Object.keys(h),l=s.length,u,e;t<l;t++)u=s[t],e=h[u],this.setAttribute(u,e);this.innerHTML=i.content}}}};(()=>{y(pb,Db,"SVGSVGElement",1,SVGSVGElement)})();function yt(i,h,t,s,l){let u=globalThis.document.createElementNS("http://www.w3.org/2000/svg",i);return t&&(u.className.baseVal=t),h&&h[dt]&&h[dt](u),s&&(u.textContent=s),u}function ws(i){return globalThis.document.createComment(i)}function fr(i){return globalThis.document.createTextNode(i)}var vs=globalThis.navigator,_b=vs&&vs.vendor||"",mr=vs&&vs.userAgent||"",kb=_b.indexOf("Apple")>-1||mr.indexOf("CriOS")>=0||mr.indexOf("FxiOS")>=0,Es=!kb,nr=new Map,$b=Symbol(),of=class extends HTMLElement{connectedCallback(){return Es?this.parentNode.removeChild(this):this.parentNode.connectedCallback()}disconnectedCallback(){if(!Es)return this.parentNode.disconnectedCallback()}},ab=of;(()=>{y(of,$b,"CustomHook",0)})();window.customElements.define("i-hook",ab);function ob(i,h){let t=nr.get(h);if(!t){t={};let s=h.prototype,l=[s];for(;(s=s&&Object.getPrototypeOf(s))&&s.constructor!=i.constructor;)l.unshift(s);for(let u=0,e=Sb(l),r=e.length;u<r;u++){let f=e[u],m=Object.getOwnPropertyDescriptors(f);Object.assign(t,m)}nr.set(h,t)}return t}function Xs(i,h,t,s,l){let u;typeof i!="string"&&i&&i.nodeName&&(i=i.nodeName);let e=Dl[i]||i;if(xl[i]){let r=xl[i],f=r.prototype[ss];if(f&&Es)u=globalThis.document.createElement(f,{is:e});else if(r.create$&&f){u=globalThis.document.createElement(f),u.setAttribute("is",e);let m=ob(u,r);Object.defineProperties(u,m),u.__slots={},u.appendChild(globalThis.document.createElement("i-hook"))}else r.create$?(u=r.create$(u),u.__slots={}):console.warn("could not create tag "+i)}else u=globalThis.document.createElement(Dl[i]||i);return u[_f]=h,u[pf](),u[Df](),s!==null&&u[Ob]("__").text$(s),(t||u.flags$ns)&&u.flag$(t||""),u}function Cs(i,h,t={}){Wb[i]=Bb[i]=h,h.nodeName=i;let s=i,l=h.prototype;if(i.indexOf("-")==-1&&(s=""+i+"-tag",Dl[i]=s),t.cssns){let u=(l._ns_||l[ur]||"")+" "+(t.cssns||"");l._ns_=u.trim()+" ",l[ur]=t.cssns}if(t.cssid){let u=(l.flags$ns||"")+" "+t.cssid;l[Lb]=t.cssid,l.flags$ns=u.trim()+" "}return l[ss]&&!t.extends&&(t.extends=l[ss]),t.extends?(l[ss]=t.extends,xl[i]=h,Es&&window.customElements.define(s,h,{extends:t.extends})):window.customElements.define(s,h),h}var cb=globalThis.imba||(globalThis.imba={});cb.document=globalThis.document;function $h(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function vl(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var ls=Symbol.for("#parent"),Sr=Symbol.for("#closestNode"),Ib=Symbol.for("#isRichElement"),i1=Symbol.for("#afterVisit"),h1=Symbol.for("#getRenderContext"),br=Symbol.for("#appendChild"),dr=Symbol.for("#removeChild"),wr=Symbol.for("#replaceChild"),qi=Symbol.for("#insertInto"),At=Symbol.for("#replaceWith"),vr=Symbol.for("#insertChild"),xt=Symbol.for("#removeFrom"),Er=Symbol.for("#placeChild"),t1=Symbol.for("#registerFunctionalSlot"),s1=Symbol.for("#getFunctionalSlot"),Tr=Symbol.for("#getSlot"),pl=Symbol.for("##parent"),bh=Symbol.for("##up"),yr=Symbol.for("##flags"),l1=Symbol.for("#domFlags"),bi=Symbol.for("#end"),Nr=Symbol.for("#textContent"),Dt=Symbol.for("#textNode"),El=Symbol.for("#functionalSlots");var u1=Symbol(),cf=class{constructor(){this.childNodes=[]}log(...i){}hasChildNodes(){return!1}set[ls](i){this[pl]=i}get[ls](){return this[pl]||this[bh]}get[Sr](){return this[ls][Sr]}get[Ib](){return!0}get flags(){return this[yr]||(this[yr]=new Vf(this))}flagSync$(){return this}[i1](){return this}[h1](i){return Af(this,i)}},Ts=cf;(()=>{y(cf,u1,"Fragment",16)})();var e1=0,r1=Symbol(),If=class extends Ts{constructor(i,h){super(...arguments),this[bh]=h,this.parentNode=null,this[l1]=i,this.childNodes=[],this[bi]=ws("slot"+e1++),h&&h[br](this)}get[ls](){return this[pl]||this.parentNode||this[bh]}set textContent(i){this[Nr]=i}get textContent(){return this[Nr]}hasChildNodes(){for(let i=0,h=vl(this.childNodes),t=h.length;i<t;i++){let s=h[i];if($h(s,Ts)&&s.hasChildNodes())return!0;if(!$h(s,er)){if($h(s,$f))return!0}}return!1}text$(i){return this[Dt]?this[Dt].textContent=i:this[Dt]=this[Er](i),this[Dt]}appendChild(i){return this.parentNode&&i[qi](this.parentNode,this[bi]),this.childNodes.push(i)}[br](i){var h;return this.parentNode?i[qi](this.parentNode,this[bi]):(h=i[bh])!=null||(i[bh]=this[bh]||this),this.childNodes.push(i)}insertBefore(i,h){this.parentNode&&this.parentNode[vr](i,h);let t=this.childNodes.indexOf(h);return t>=0&&this.childNodes.splice(t,0,i),i}[dr](i){this.parentNode&&this.parentNode[dr](i);let h=this.childNodes.indexOf(i);h>=0&&this.childNodes.splice(h,1)}[wr](i,h){this.parentNode&&this.parentNode[wr](i,h);let t=this.childNodes.indexOf(h);return this.childNodes[t]=i,i}[qi](i,h){let t=this.parentNode;if(this.parentNode!=i&&(this.parentNode=i,!0)){this[bi]&&(h=this[bi][qi](i,h));for(let s=0,l=vl(this.childNodes),u=l.length;s<u;s++)l[s][qi](i,h)}return this}[At](i,h){let t=i[qi](h,this[bi]);return this[xt](h),t}[vr](i,h){if(this.parentNode&&this.insertBefore(i,h||this[bi]),h){let t=this.childNodes.indexOf(h);t>=0&&this.childNodes.splice(t,0,i)}else this.childNodes.push(i);return i}[xt](i){for(let h=0,t=vl(this.childNodes),s=t.length;h<s;h++)t[h][xt](i);return this[bi]&&this[bi][xt](i),this.parentNode=null,this}[Er](i,h,t){let s=this.parentNode,l=typeof i;if(l==="undefined"||i===null){if(t&&$h(t,er))return t;let u=ws("");if(t){let e=this.childNodes.indexOf(t);return this.childNodes.splice(e,1,u),s&&t[At](u,s),u}return this.childNodes.push(u),s&&u[qi](s,this[bi]),u}if(i===t)return i;if(l!=="object"){let u,e=i;if(t){if($h(t,Xb))return t.textContent=e,t;{u=fr(e);let r=this.childNodes.indexOf(t);return this.childNodes.splice(r,1,u),s&&t[At](u,s),u}}else return this.childNodes.push(u=fr(e)),s&&u[qi](s,this[bi]),u}else if(t){let u=this.childNodes.indexOf(t);return this.childNodes.splice(u,1,i),s&&t[At](i,s),i}else return this.childNodes.push(i),s&&i[qi](s,this[bi]),i}},f1=If;(()=>{y(If,r1,"VirtualFragment",16)})();function _l(i,h){let t=new f1(i,null);return t[bh]=h,t}var m1=Symbol(),n1=class{[t1](i){let h=this[El]||(this[El]={});return h[i]||(h[i]=_l(0,this))}[s1](i,h){let t=this[El];return t&&t[i]||this[Tr](i,h)}[Tr](i,h){var t;return i=="__"&&!this.render||!this.__slots?this:(t=this.__slots)[i]||(t[i]=_l(0,this))}};(()=>{y(n1,m1,"Node",1,$f)})();function S1(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var b1=Symbol.for("#afterVisit"),pt=Symbol.for("#insertInto"),zr=Symbol.for("#appendChild"),d1=Symbol.for("#replaceWith"),Tl=Symbol.for("#removeFrom"),w1=Symbol.for("#domFlags"),v1=Symbol.for("##parent"),ai=Symbol.for("#end"),E1=Symbol.for("#removeChild"),T1=Symbol.for("#insertChild"),y1=Symbol(),N1=class extends Ts{constructor(i,h){super(...arguments),this[w1]=i,this[v1]=h,i&256||(this[ai]=ws("list")),this.$=this.childNodes,this.length=0,h&&h[zr](this)}hasChildNodes(){return this.length!=0}[b1](i){let h=this.length;if(this.length=i,h==i)return;let t=this.parentNode;if(!t)return;let s=this.childNodes,l=this[ai];if(h>i)for(;h>i;)t[E1](s[--h]);else if(i>h)for(;i>h;)t[T1](s[h++],l);this.length=i}[pt](i,h){this.parentNode=i,this[ai]&&this[ai][pt](i,h),h=this[ai];for(let t=0,s=S1(this.childNodes),l=s.length;t<l;t++){let u=s[t];if(t==this.length)break;u[pt](i,h)}return this}[zr](i){}[d1](i,h){let t=i[pt](h,this[ai]);return this[Tl](h),t}[Tl](i){let h=this.length;for(;h>0;)this.childNodes[--h][Tl](i);this[ai]&&i.removeChild(this[ai]),this.parentNode=null}};(()=>{y(N1,y1,"IndexedTagFragment",16)})();function Fr(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var yl=Symbol.for("#appendChild"),_t=Symbol.for("#insertChild"),z1=Symbol.for("#replaceWith"),kt=Symbol.for("#insertInto"),Nl=Symbol.for("#removeFrom"),F1=Symbol.for("#afterVisit"),$t=Symbol.for("#domFlags"),Or=Symbol.for("##parent"),oi=Symbol.for("#end"),Lr=Symbol.for("#removeChild"),O1=Symbol(),i0=class extends Ts{constructor(i,h){super(...arguments),this[$t]=i,this[Or]=h,this.changes=new Map,this.dirty=!1,this.array=this.childNodes,this.$=new Ys(this,Symbol()),i&256||(this[oi]=ws("map")),h&&h[yl](this)}[yl](i){if(this.parentNode)return this.parentNode[_t](i,this[oi])}hasChildNodes(){return this.childNodes.length!=0}push(i,h){if(!(this[$t]&1)){this.array.push(i),this[yl](i);return}let t=this.array[h];if(t!==i){this.dirty=!0;let s=this.array.indexOf(i),l=this.changes.get(i);s===-1?(this.array.splice(h,0,i),this.insertChild(i,h,s)):s===h+1?(t&&this.changes.set(t,-1),this.array.splice(h,1)):(s>=0&&this.array.splice(s,1),this.array.splice(h,0,i),this.moveChild(i,h,s)),l==-1&&this.changes.delete(i)}}insertChild(i,h,t){let s=this.parentNode;if(s)if(h>0){let l=this.array[h-1];s[_t](i,l.nextSibling)}else s[_t](i,this.childNodes[h+1]||this[oi])}moveChild(i,h,t){return this.insertChild(i,h,t)}removeChild(i,h){i.parentNode&&i[Nl](i.parentNode)}[_t](i,h){}[z1](i,h){let t=i[kt](h,this[oi]);return this[Nl](h),t}[kt](i,h){this[Or]=i;let t=this.parentNode;if(i!=t){this.parentNode=i;for(let s=0,l=Fr(this.array),u=l.length;s<u;s++)l[s][kt](i,h);this[oi]&&this[oi][kt](i,h)}return this}[Nl](i){for(let h=0,t=Fr(this.array),s=t.length;h<s;h++){let l=t[h];i[Lr](l)}return this[oi]&&i[Lr](this[oi]),this.parentNode=null}[F1](i){var h=this;if(!(this[$t]&1)){this[$t]|=1;return}if(this.dirty&&(this.changes.forEach(function(t,s){if(t==-1)return h.removeChild(s)}),this.changes.clear(),this.dirty=!1),this.array.length>i)for(;this.array.length>i;){let t=this.array.pop();this.removeChild(t)}}},L1=i0;(()=>{y(i0,O1,"KeyedTagFragment",16)})();function h0(i,h){return new L1(i,h)}function Kr(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var ys=Symbol.for("#__init__"),K1=Symbol.for("##inited"),G1=Symbol.for("#afterVisit"),Y1=Symbol.for("#beforeReconcile"),X1=Symbol.for("#afterReconcile"),Gr=Symbol.for("#__hooks__"),Yh=Symbol.for("#autorender"),at=Symbol.for("##visitContext"),C1=Symbol(),zl,H1=new(zl=class{constructor(i=null){this[ys](i)}[ys](i=null,h=!0,t=!0){var s;this.items=i&&(s=i.items)!==void 0?s:[],this.current=i&&(s=i.current)!==void 0?s:null,this.lastQueued=i&&(s=i.lastQueued)!==void 0?s:null,this.tests=i&&(s=i.tests)!==void 0?s:0}flush(){let i=null;for(;i=this.items.shift();){if(!i.parentNode||i.hydratedΦ)continue;let h=this.current;this.current=i,i.__F|=1024,i.connectedCallback(),this.current=h}}queue(i){var h=this;let t=this.items.length,s=0,l=this.lastQueued;this.lastQueued=i;let{DOCUMENT_POSITION_PRECEDING:u,DOCUMENT_POSITION_FOLLOWING:e}=Node;if(t){let r=this.items.indexOf(l),f=r,m=function(S,d){return h.tests++,S.compareDocumentPosition(d)};(r==-1||l.nodeName!=i.nodeName)&&(f=r=0);let n=this.items[f];for(;n&&m(n,i)&e;)n=this.items[++f];if(f!=r)n?this.items.splice(f,0,i):this.items.push(i);else{for(;n&&m(n,i)&u;)n=this.items[--f];f!=r&&(n?this.items.splice(f+1,0,i):this.items.unshift(i))}}else this.items.push(i),this.current||globalThis.queueMicrotask(this.flush.bind(this))}},(()=>{y(zl,C1,null,16)})(),zl);var Q1=Symbol(),t0=class extends HTMLElement{constructor(){super(),this.flags$ns&&(this.flag$=this.flagExt$),this.setup$(),this.build()}setup$(){return this.__slots={},this.__F=0}[ys](){return this.__F|=3,this}[K1](){if(this[Gr])return this[Gr].inited(this)}flag$(i){this.className=this.flags$ext=i}build(){return this}awaken(){return this}mount(){return this}unmount(){return this}rendered(){return this}dehydrate(){return this}hydrate(){return this.autoschedule=!0,this}tick(i,h){return this.commit()}visit(){return this.commit()}commit(){return this.renderΦ?(this.__F|=256,this.render&&this.render(),this.rendered(),this.__F=(this.__F|512)&-257&-8193):(this.__F|=8192,this)}get autoschedule(){return(this.__F&64)!=0}set autoschedule(i){i?this.__F|=64:this.__F&=-65}set autorender(i){let h=this[Yh]||(this[Yh]={});h.value=i,this.mountedΦ&&a.schedule(this,h)}get renderΦ(){return!this.suspendedΦ}get mountingΦ(){return(this.__F&16)!=0}get mountedΦ(){return(this.__F&32)!=0}get awakenedΦ(){return(this.__F&8)!=0}get renderedΦ(){return(this.__F&512)!=0}get suspendedΦ(){return(this.__F&4096)!=0}get renderingΦ(){return(this.__F&256)!=0}get scheduledΦ(){return(this.__F&128)!=0}get hydratedΦ(){return(this.__F&2)!=0}get ssrΦ(){return(this.__F&1024)!=0}get scheduler(){return a}schedule(){return a.on("commit",this),this.__F|=128,this}unschedule(){return a.un("commit",this),this.__F&=-129,this}async suspend(i=null){let h=this.flags.incr("@suspended");return this.__F|=4096,Kr(i,Function)&&(await i(),this.unsuspend()),this}unsuspend(){return this.flags.decr("@suspended")==0&&(this.__F&=-4097,this.commit()),this}[G1](){if(this.visit(),this[at])return this[at]=null}[Y1](){return this.__F&1024&&(this.__F=this.__F&-1025,this.classList.remove("_ssr_"),this.flags$ext&&this.flags$ext.indexOf("_ssr_")==0&&(this.flags$ext=this.flags$ext.slice(5)),this.__F&512||(this.innerHTML="")),globalThis.DEBUG_IMBA&&ds.push(this),this[at]&&(this[at]=null),this}[X1](){return globalThis.DEBUG_IMBA&&ds.pop(this),this}connectedCallback(){let i=this.__F,h=i&1,t=i&8;if(!h&&!(i&1024)){H1.queue(this);return}if(i&48)return;this.__F|=16,h||this[ys](),i&2||(this.flags$ext=this.className,this.__F|=2,this.hydrate(),this.commit()),t||(this.awaken(),this.__F|=8),th(this,"mount",[this]);let s=this.mount();return s&&Kr(s.then,Function)&&s.then(a.commit),i=this.__F=(this.__F|32)&-17,i&64&&this.schedule(),this[Yh]&&a.schedule(this,this[Yh]),this}disconnectedCallback(){if(this.__F=this.__F&-49,this.__F&128&&this.unschedule(),th(this,"unmount",[this]),this.unmount(),this[Yh])return a.unschedule(this,this[Yh])}},qh=t0;(()=>{y(t0,Q1,"Component",16)})();function Z1(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Yr=Symbol.for("#__init__"),g1={cm:1,mm:1,Q:1,pc:1,pt:1,px:1,em:1,ex:1,ch:1,rem:1,vw:1,vh:1,vmin:1,vmax:1,s:1,ms:1,fr:1,"%":1,in:1,turn:1,grad:1,rad:1,deg:1,Hz:1,kHz:1},Xr={prefix:1,suffix:1,content:1},fu={rose:[[356,100,97],[356,100,95],[353,96,90],[353,96,82],[351,95,71],[350,89,60],[347,77,50],[345,83,41],[343,80,35],[342,75,30]],pink:[[327,73,97],[326,78,95],[326,85,90],[327,87,82],[329,86,70],[330,81,60],[333,71,51],[335,78,42],[336,74,35],[336,69,30]],fuchsia:[[289,100,98],[287,100,95],[288,96,91],[291,93,83],[292,91,73],[292,84,61],[293,69,49],[295,72,40],[295,70,33],[297,64,28]],purple:[[270,100,98],[269,100,95],[269,100,92],[269,97,85],[270,95,75],[271,91,65],[271,81,56],[272,72,47],[273,67,39],[274,66,32]],violet:[[250,100,98],[251,91,95],[251,95,92],[252,95,85],[255,92,76],[258,90,66],[262,83,58],[263,70,50],[263,69,42],[264,67,35]],indigo:[[226,100,97],[226,100,94],[228,96,89],[230,94,82],[234,89,74],[239,84,67],[243,75,59],[245,58,51],[244,55,41],[242,47,34]],blue:[[214,100,97],[214,95,93],[213,97,87],[212,96,78],[213,94,68],[217,91,60],[221,83,53],[224,76,48],[226,71,40],[224,64,33]],sky:[[204,100,97],[204,94,94],[201,94,86],[199,95,74],[198,93,60],[199,89,48],[200,98,39],[201,96,32],[201,90,27],[202,80,24]],cyan:[[183,100,96],[185,96,90],[186,94,82],[187,92,69],[188,86,53],[189,94,43],[192,91,36],[193,82,31],[194,70,27],[196,64,24]],teal:[[166,76,97],[167,85,89],[168,84,78],[171,77,64],[172,66,50],[173,80,40],[175,84,32],[175,77,26],[176,69,22],[176,61,19]],emerald:[[152,81,96],[149,80,90],[152,76,80],[156,72,67],[158,64,52],[160,84,39],[161,94,30],[163,94,24],[163,88,20],[164,86,16]],green:[[138,76,97],[141,84,93],[141,79,85],[142,77,73],[142,69,58],[142,71,45],[142,76,36],[142,72,29],[143,64,24],[144,61,20]],lime:[[78,92,95],[80,89,89],[81,88,80],[82,85,67],[83,78,55],[84,81,44],[85,85,35],[86,78,27],[86,69,23],[88,61,20]],yellow:[[55,92,95],[55,97,88],[53,98,77],[50,98,64],[48,96,53],[45,93,47],[41,96,40],[35,92,33],[32,81,29],[28,73,26]],amber:[[48,100,96],[48,96,89],[48,97,77],[46,97,65],[43,96,56],[38,92,50],[32,95,44],[26,90,37],[23,83,31],[22,78,26]],orange:[[33,100,96],[34,100,92],[32,98,83],[31,97,72],[27,96,61],[25,95,53],[21,90,48],[17,88,40],[15,79,34],[15,75,28]],red:[[0,86,97],[0,93,94],[0,96,89],[0,94,82],[0,91,71],[0,84,60],[0,72,51],[0,74,42],[0,70,35],[0,63,31]],warmer:[[60,9,98],[60,5,96],[20,6,90],[24,6,83],[24,5,64],[25,5,45],[33,5,32],[30,6,25],[12,6,15],[24,10,10]],warm:[[0,0,98],[0,0,96],[0,0,90],[0,0,83],[0,0,64],[0,0,45],[0,0,32],[0,0,25],[0,0,15],[0,0,9]],gray:[[0,0,98],[240,5,96],[240,6,90],[240,5,84],[240,5,65],[240,4,46],[240,5,34],[240,5,26],[240,4,16],[240,6,10]],cool:[[210,20,98],[220,14,96],[220,13,91],[216,12,84],[218,11,65],[220,9,46],[215,14,34],[217,19,27],[215,28,17],[221,39,11]],cooler:[[210,40,98],[210,40,96],[214,32,91],[213,27,84],[215,20,65],[215,16,47],[215,19,35],[215,25,27],[217,33,17],[222,47,11]]},J1=new RegExp("^("+Object.keys(fu).join("|")+")(\\d+(?:\\.\\d+)?)$"),W1=/^([xyz])$/,B1=/^([tlbr]|size|[whtlbr]|[mps][tlbrxy]?|[rcxy]?[gs])$/,R1=`*,::before,::after {
box-sizing: border-box;
border-width: 0;
border-style: solid;
border-color: currentColor;
}`,M1=Symbol(),s0=class{constructor(i=null){this[Yr](i)}[Yr](i=null,h=!0,t=!0){var s;this.entries=i&&(s=i.entries)!==void 0?s:{}}register(i,h){let t=this.entries[i];t?t&&(t.css=h,t.node&&(t.node.textContent=h)):(t=this.entries[i]={sourceId:i,css:h},this.entries.resets||this.register("resets",R1),t.node=globalThis.document.createElement("style"),t.node.setAttribute("data-id",i),t.node.textContent=t.css,globalThis.document.head.appendChild(t.node))}toString(){return Object.values(this.entries).map(function(i){return i.css}).join(`

`)}toValue(i,h,t,s=null){let l;Xr[t]&&(i=String(i));let u=typeof i;if(u=="number"){if(h||(W1.test(t)?h="px":B1.test(t)?h="u":t=="rotate"&&(h="turn",i=(i%1).toFixed(4))),h)return g1[h]?i+h:h=="u"?i*4+"px":"calc(var(--u_"+h+",1px) * "+i+")"}else if(u=="string"){if(t&&Xr[t]&&i[0]!='"'&&i[0]!="'"&&(i.indexOf('"')>=0?i.indexOf("'")==-1&&(i="'"+i+"'"):i='"'+i+'"'),l=i.match(J1)){let e=fu[l[1]][parseInt(l[2])],r="100%";if(typeof s=="number"?r=s+"%":typeof s=="string"&&(r=s),e)return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+r+")"}}else if(i&&Z1(i.toStyleString,Function))return i.toStyleString();return i}parseDimension(i){if(typeof i=="string"){let[h,t,s]=i.match(/^([-+]?[\d\.]+)(%|\w+)$/);return[parseFloat(t),s]}else if(typeof i=="number")return[i]}},U1=s0;(()=>{y(s0,M1,"Styles",16)})();var mu=new U1,KN=Object.keys(fu);var q1=Symbol(),P1=class{css$(i,h,t){return this.style[i]=h}css$var(i,h,t,s,l=null){let u=mu.toValue(h,t,s,l);this.style.setProperty(i,u)}};(()=>{y(P1,q1,"Element",1,ti)})();function V1(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Cr=Symbol.for("#insertInto"),Hr=Symbol.for("#removeFrom");function nu(i,h,t={}){let s=h||globalThis.document.body,l=i;if(V1(i,Function)){let u=i,e=t.tick||(t.tick=function(){let r=t.context||(t.context=new Ys(s,null)),f=ii.context;ii.context=r;let m=i(r,t);return ii.context==r&&(ii.context=f),t.node!=m&&(t.node&&globalThis.imba.unmount(t.node),m?((t.node=m)[Cr](s),m.tick==qh.prototype.tick&&(m.tick=t.tick,m.scheduledΦ),vi(m,"unmount",function(){if(t.node==m)return t.node=null,a.unlisten("commit",t.tick)})):(t.node=m,a.unlisten("commit",t.tick))),m});return a.listen("commit",e),e()}else l.__F|=64;return l[Cr](s),l}function j1(i){return i&&i[Hr]&&i.parentNode&&i[Hr](i.parentNode),i}var l0=globalThis.imba||(globalThis.imba={});l0.mount=nu;l0.unmount=j1;function Ji(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function ah(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var et=Symbol.for("##onchange"),wt=Symbol.for("#afterVisit"),rt=Symbol.for("##oninput"),us=Symbol.for("##onclick"),vt=Symbol.for("##bound"),sh=Symbol.for("##visitContext");function u0(){return globalThis.imba.uses_dom_bind=!0,!0}var A1={INPUT:!0,SELECT:!0,TEXTAREA:!0,BUTTON:!0},kl=function(i){return Ji(i,Array)||i&&Ji(i.has,Function)},Su=function(i,h){return i==h?!0:Ji(i,Array)?i.indexOf(h)>=0:i&&Ji(i.has,Function)?i.has(h):i&&Ji(i.contains,Function)?i.contains(h):!1},bu=function(i,h){if(Ji(i,Array))return i.push(h);if(i&&Ji(i.add,Function))return i.add(h)},du=function(i,h){if(Ji(i,Array)){let t=i.indexOf(h);if(t>=0)return i.splice(t,1)}else if(i&&Ji(i.delete,Function))return i.delete(h)};function x1(i){function h(){return i[0]?i[0][i[1]]:void 0}function t(s){return i[0]?i[0][i[1]]=s:null}return{get:h,set:t}}var D1=Symbol(),p1=class{getRichValue(){return this.value}setRichValue(i){return this.value=i}bind$(i,h){let t=h||[];return i=="data"&&!this[vt]&&A1[this.nodeName]&&(this[vt]=!0,this[et]&&this.addEventListener("change",this[et]=this[et].bind(this)),this[rt]&&this.addEventListener("input",this[rt]=this[rt].bind(this),{capture:!0}),this[us]&&this.addEventListener("click",this[us]=this[us].bind(this),{capture:!0})),Object.defineProperty(this,i,Ji(t,Array)?x1(t):t),t}};(()=>{y(p1,D1,"Element",1,ti)})();Object.defineProperty(ti.prototype,"richValue",{get:function(){return this.getRichValue()},set:function(i){return this.setRichValue(i)}});var _1=Symbol(),k1=class{[et](i){let h=this.data,t=this.$$value;this.$$value=void 0;let s=this.getRichValue();if(this.multiple){if(t)for(let l=0,u=ah(t),e=u.length;l<e;l++){let r=u[l];s.indexOf(r)==-1&&du(h,r)}for(let l=0,u=ah(s),e=u.length;l<e;l++){let r=u[l];(!t||t.indexOf(r)==-1)&&bu(h,r)}}else this.data=s[0];return W(),this}getRichValue(){var i;if(this.$$value)return this.$$value;i=[];for(let h=0,t=ah(this.selectedOptions),s=t.length;h<s;h++){let l=t[h];i.push(l.richValue)}return this.$$value=i}syncValue(){let i=this.data;if(this.multiple){let h=[];for(let t=0,s=ah(this.options),l=s.length;t<l;t++){let u=s[t],e=u.richValue,r=Su(i,e);u.selected=r,r&&h.push(e)}this.$$value=h}else for(let h=0,t=ah(this.options),s=t.length;h<s;h++){let l=t[h].richValue;if(l==i){this.$$value=[l],this.selectedIndex=h;break}}}[wt](){if(this.syncValue(),this[sh])return this[sh]=null}};(()=>{y(k1,_1,"HTMLSelectElement",1,Cb)})();var $1=Symbol(),a1=class{setRichValue(i){return this.$$value=i,this.value=i}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}};(()=>{y(a1,$1,"HTMLOptionElement",1,gb)})();var o1=Symbol(),c1=class{setRichValue(i){return this.$$value=i,this.value=i}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}[rt](i){return this.data=this.value,W()}[wt](){let i=this.data;if(i==null&&(i=""),this[vt]&&this.value!=i&&(this.value=i),this[sh])return this[sh]=null}};(()=>{y(c1,o1,"HTMLTextAreaElement",1,Qb)})();var I1=Symbol(),id=class{[rt](i){let h=this.type;if(!(h=="checkbox"||h=="radio")&&!(h=="number"&&Number.isNaN(this.valueAsNumber)))return this.$$value=void 0,this.data=this.richValue,W()}[et](i){let h=this.data,t=this.richValue;if(this.type=="checkbox"||this.type=="radio"){let s=this.checked;kl(h)?s?bu(h,t):du(h,t):this.data=s?t:!1}return W()}setRichValue(i){this.$$value!==i&&(this.$$value=i,this.value!==i&&(this.value=i))}getRichValue(){if(this.$$value!==void 0)return this.$$value;let i=this.value,h=this.type;if(h=="range"||h=="number"){let t=this.valueAsNumber;Number.isNaN(t)&&(t=Number(i.replace(/\,/,".")+0)),Number.isNaN(t)&&(t=null),i=t}else h=="checkbox"&&(i==null||i==="on")&&(i=!0);return i}[wt](){if(this[vt]){let i=this.type;if(i=="checkbox"||i=="radio"){let h=this.data;h===!0||h===!1||h==null?this.checked=!!h:this.checked=Su(h,this.richValue)}else this.richValue=this.data}this[sh]&&(this[sh]=null)}};(()=>{y(id,I1,"HTMLInputElement",1,Hb)})();var hd=Symbol(),td=class{get checked(){return this.$checked}set checked(i){i!=this.$checked&&(this.$checked=i,this.flags.toggle("checked",!!i))}setRichValue(i){return this.$$value=i,this.value=i}getRichValue(){return this.$$value!==void 0?this.$$value:this.value}[us](i){let h=this.data,t=this.checked,s=this.richValue;return kl(h)?t?du(h,s):bu(h,s):this.$$value==null?this.data=!t:this.data=t?null:s,this[wt](),W()}[wt](){if(this[vt]){let i=this.data,h=this.$$value==null?!0:this.$$value;kl(i)?this.checked=Su(i,h):this.checked=i==h}this[sh]&&(this[sh]=null)}};(()=>{y(td,hd,"HTMLButtonElement",1,Zb)})();function sd(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function Qr(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var ld=Symbol.for("#getSlot"),ud=Symbol.for("#container"),ed=Symbol.for("#afterVisit"),oh=Symbol.for("#__init__"),ot=Symbol.for("#listeners"),Yi=Symbol.for("#slot"),rd=Symbol.for("#parent"),ei=Symbol.for("##container"),Fl=Symbol.for("#domTarget"),Zr=Symbol.for("#insertInto"),fd=Symbol.for("#removeFrom"),md=Symbol.for("#teleport"),nd=Symbol.for("#self"),Sd=Symbol.for("#target"),bd=Symbol(),e0=class extends qh{constructor(){super(...arguments),super[oh]||this[oh]()}[oh](i=null,h=!0,t=!0){h&&super[oh]&&super[oh](...arguments),this.to=i?i.to:void 0}build(){return this[ot]=[],this.win=globalThis,this.doc=globalThis.document}setup(){return this.setAttribute("style","display:none !important;")}[ld](i,h){return this[Yi]||(this[Yi]=_l(0,this[rd])),this[Yi]}get[ud](){if(!this[ei]){let i=this.className;this[ei]=this.doc.createElement("div"),this[ei].className=i,this[ei].style.cssText="display:contents !important;"}return this[ei]}get domTarget(){return this[Fl]||(this[Fl]=sd(this.to,ti)?this.to:this.closest(this.to)||this.doc.querySelector(this.to))}get eventTarget(){return this.domTarget}get style(){return this[ei]?this[ei].style:super.style}get classList(){return this[ei]?this[ei].classList:super.classList}get className(){return this[ei]?this[ei].className:super.className}set className(i){this[ei]?this[ei].className=i:super.className=i}[ed](){if(this.mountedΦ&&this[Yi]&&!this[Yi].parentNode)return this[Yi][Zr](this.target)}mount(){for(let h=0,t=Qr(this[ot]),s=t.length;h<s;h++){let[l,u,e]=t[h];this.eventTarget.addEventListener(l,u,e)}let i=this.domTarget;return this[Yi]&&this[Yi][Zr](i),this}unmount(){for(let i=0,h=Qr(this[ot]),t=h.length;i<t;i++){let[s,l,u]=h[i];this.eventTarget.removeEventListener(s,l,u)}return this[Yi]&&this[Yi][fd](this.domTarget),this[Fl]=null,this}addEventListener(i,h,t={}){var s;if(h[md]=this,h[nd]=this,this[ot].push([i,h,t]),this.mountedΦ&&((s=this.eventTarget)==null?void 0:s.addEventListener))return this.eventTarget.addEventListener(i,h,t)}},r0=e0;(()=>{y(e0,bd,"TeleportHook",24)})();var dd=Symbol(),f0=class extends r0{get domTarget(){return this.doc.body}get eventTarget(){return this.win}addEventListener(i,h,t={}){return h[Sd]=this.domTarget.parentNode,super.addEventListener(...arguments)}on$resize(i,h,t,s){return this.addEventListener("resize",t,s),t}},wd=f0;(()=>{y(f0,dd,"GlobalHook",8)})();globalThis.customElements&&(globalThis.customElements.define("i-teleport",r0),globalThis.customElements.define("i-global",wd));function Fi(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}function vd(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Qi=Symbol.for("#__init__"),es=Symbol.for("#insertInto"),rs=Symbol.for("#removeFrom"),Ed=Symbol.for("#all"),ch=Symbol.for("#phase"),Pi=Symbol.for("#nodes"),Td=Symbol.for("#sizes"),Xh=Symbol.for("#linked"),gr=Symbol.for("#mode"),Jr=Symbol.for("#enabled"),yd=Symbol.for("#easer"),Ch=Symbol.for("#group"),Ol=Symbol.for("#_easer_"),Nd=Symbol(),m0=class extends eu{constructor(){super(...arguments),super[Qi]||this[Qi]()}[Qi](i=null,h=!0,t=!0){var s;h&&super[Qi]&&super[Qi](...arguments),this.selectors=i&&(s=i.selectors)!==void 0?s:{}}addSelectors(i,h){var t;return((t=this.selectors)[h]||(t[h]=[])).push(...i),!0}getSelectors(...i){let h=[];for(let t=0,s=Fi(i),l=s.length;t<l;t++){let u=s[t];this.selectors[u]&&h.push(...this.selectors[u])}return h&&h.length?h.join(","):null}nodesForBase(i,h="transition"){let t=[i],s=(this.selectors[h]||[]).join(",");if(s=="")return t;let l=i.querySelectorAll(s);for(let u=0,e=Fi(l),r=e.length;u<r;u++){let f=e[u];f.closest("._ease_")==i&&t.push(f)}return t[Ed]=l,t}nodesWithSize(i,h="in"){let t=this.getSelectors("_off_sized","_"+h+"_sized");return t?i.filter(function(s){return s.matches(t)}):[]}},zd=m0;(()=>{y(m0,Nd,"Transitions",16)})();var $l=new zd,Fd=globalThis.imba||(globalThis.imba={});Fd.transitions=$l;var Od=Symbol(),Ld=class extends eu{[Qi](i=null,h=!0,t=!0){var s;h&&super[Qi]&&super[Qi](...arguments),this.flushingΦ=i&&(s=i.flushingΦ)!==void 0?s:!1,this.mutations=i&&(s=i.mutations)!==void 0?s:[]}constructor(i){super(),super[Qi]||this[Qi](),this.callback=i}insert(i,h,t){return this.mutations.push({target:i,addedNodes:[h],removedNodes:[],nextSibling:t})}remove(i,h){return this.mutations.push({target:i,addedNodes:[],removedNodes:[h]})}flush(){let i=this.mutations.slice(0);if(!i.length)return this;this.mutations=[],vd(this.callback,Function)&&this.callback(i),this.emit("start",this,i),this.flushingΦ=!0;for(let h of Fi(i)){for(let t of Fi(h.addedNodes))t[es](h.target,h.nextSibling);for(let t of Fi(h.removedNodes))t[rs](h.target)}return this.flushingΦ=!1,this.emit("end",this,i)}};(()=>{y(Ld,Od,"EaseGroup",16)})();var Kd=Symbol(),n0=class extends eu{constructor(i){super(),this.dom=i,this[ch]=null,this[Pi]=[],this[Td]=new Map}log(...i){}get flags(){return this.dom.flags}link(i){return this[Xh]||(this[Xh]=new Set),this[Xh].add(i)}unlink(i){return this[Xh].delete(i)}flag(i){for(let h=0,t=Fi(this[Pi]),s=t.length;h<s;h++)t[h].flags.add(i);return this}unflag(i){for(let h=0,t=Fi(this[Pi]),s=t.length;h<s;h++)t[h].flags.remove(i);return this}commit(){return this.dom.offsetWidth}enable(i){return i&&(this[gr]=i),this[Jr]!=!0&&(this[Jr]=!0,!0)?(this.dom[es]=this[es].bind(this),this.dom[rs]=this[rs].bind(this),this.flags.add("_ease_")):this}disable(){return this.flags.remove("_ease_"),!0}set phase(i){var h,t,s,l,u,e,r,f,m,n,S,d,v,b,w,T,E,N,z,F,O,L,Y,g;let C=this[ch];this[ch]!=i&&(this[ch]=i,!0)&&(C&&this.unflag("@"+C),i&&this.flag("@"+i),i||(this.unflag("@out"),this.unflag("@in"),this.unflag("@off"),this[Pi]=null),i=="enter"&&C=="leave"&&((t=(h=this.dom)==null?void 0:h.emit)==null||t.call(h,"outcancel"),(l=(s=this.dom)==null?void 0:s.transitionΞoutΞcancel)==null||l.call(s,this)),i=="leave"&&C=="enter"&&((e=(u=this.dom)==null?void 0:u.emit)==null||e.call(u,"incancel"),(f=(r=this.dom)==null?void 0:r.transitionΞinΞcancel)==null||f.call(r,this)),i=="enter"&&((n=(m=this.dom)==null?void 0:m.emit)==null||n.call(m,"in"),(d=(S=this.dom)==null?void 0:S.transitionΞin)==null||d.call(S,this)),i=="leave"&&((b=(v=this.dom)==null?void 0:v.emit)==null||b.call(v,"out"),(T=(w=this.dom)==null?void 0:w.transitionΞout)==null||T.call(w,this)),C=="leave"&&!i&&((N=(E=this.dom)==null?void 0:E.emit)==null||N.call(E,"outend"),(F=(z=this.dom)==null?void 0:z.transitionΞoutΞend)==null||F.call(z,this)),C=="enter"&&!i&&((L=(O=this.dom)==null?void 0:O.emit)==null||L.call(O,"inend"),(g=(Y=this.dom)==null?void 0:Y.transitionΞinΞend)==null||g.call(Y,this)))}get phase(){return this[ch]}get leavingΦ(){return this.phase=="leave"}get enteringΦ(){return this.phase=="enter"}get idleΦ(){return this.phase==null}track(i){var h=this;let t={before:wl().getAnimations()};return this.commit(),i(),this.commit(),t.after=wl().getAnimations(),t.fresh=t.after.filter(function(s){return t.before.indexOf(s)==-1}),t.deep=t.fresh.filter(function(s){let l;return!!((l=s.effect.target)&&l.closest("._ease_")!=h.dom)}),t.own=t.fresh.filter(function(s){return t.deep.indexOf(s)==-1}),t.own.length?t.finished=new Promise(function(s){let l=new Set(t.own),u=function(){if(l.delete(this),l.size==0)return s()};for(let e=0,r=Fi(t.own),f=r.length;e<f;e++){let m=r[e];m[yd]=h,m.addEventListener("finish",u,{once:!0}),m.addEventListener("cancel",u,{once:!0})}}):t.finished=Promise.resolve(!0),t}getAnimatedNodes(){let i=$l.nodesForBase(this.dom);return this[Xh]&&(i=i.concat(Array.from(this[Xh]))),i}getNodeSizes(i="in",h=this[Pi]){let t=$l.nodesWithSize(h,i),s=new Map;for(let l=0,u=Fi(t),e=u.length;l<e;l++){let r=u[l],f=window.getComputedStyle(r);s.set(r,{width:f.width,height:f.height})}return s}applyNodeSizes(i){for(let[h,t]of Fi(i))h.style.width=t.width,h.style.height=t.height;return i}clearNodeSizes(i){if(i){for(let[h,t]of Fi(i))h.style.removeProperty("width"),h.style.removeProperty("height");return i}}[es](i,h){var t,s,l=this;if(this[Ch]&&!this[Ch].flushingΦ)return this[Ch].insert(i,this.dom,h),this.dom;let u;if(this.enteringΦ)return this.dom;let e=function(){if(u&&l.clearNodeSizes(u),l.enteringΦ)return l.phase=null};if(this.leavingΦ)return this.track(function(){return l.phase="enter",l.unflag("@off"),l.unflag("@out")}).finished.then(e,function(f){return l.log("error cancel leave",f)}),this.dom;let r=wl().contains(i);return h?this.dom.nextSibling!=h&&i.insertBefore(this.dom,h):this.dom.parentNode!=i&&i.appendChild(this.dom),this[Pi]=this.getAnimatedNodes(),this.flag("_instant_"),this.unflag("@out"),this.commit(),u=this[Pi].sized=this.getNodeSizes("in"),(s=(t=this.dom)==null?void 0:t.transitionΞinΞinit)==null||s.call(t,this),this.flag("@off"),this.flag("@in"),this.flag("@enter"),this.commit(),this.unflag("_instant_"),this.track(function(){return l.phase="enter",l.applyNodeSizes(u),l.unflag("@off"),l.unflag("@in")}).finished.then(e,function(f){return l.clearNodeSizes(u),l.log("cancelled insert into",f)}),this.dom}[rs](i){var h=this;if(this[Ch]&&!this[Ch].flushingΦ){this[Ch].remove(i,this.dom);return}if(this.leavingΦ)return;let t,s=function(){if(h.phase=="leave")return h.dom.emit("easeoutend",{}),i.removeChild(h.dom),h.phase=null};if(this.enteringΦ&&this[gr]!="forward"){let u=this.track(function(){return h.flag("@off"),h.flag("@in"),h.unflag("@out"),h.phase="leave",h.clearNodeSizes(h[Pi].sized)});this.log("cancel enter anims own",u.own,u),u.finished.then(s,function(e){return h.log("error cancel entering",e)});return}this[Pi]=this.getAnimatedNodes(),t=this.getNodeSizes("out"),this.applyNodeSizes(t),this.flag("@leave");let l=this.track(function(){return h.phase="leave",h.flag("@off"),h.flag("@out"),h.clearNodeSizes(t)});if(!l.own.length){s();return}l.finished.then(s,function(){return!0})}},Gd=n0;(()=>{y(n0,Kd,"Easer",16)})();var Yd=Symbol(),Xd=class{transitionΞinΞinit(i){return!0}transitionΞin(i){return!0}transitionΞinΞend(i){return!0}transitionΞinΞcancel(i){return!0}transitionΞout(i){return!0}transitionΞoutΞend(i){return!0}transitionΞoutΞcancel(i){return!0}get ease(){return this[Ol]||(this[Ol]=new Gd(this))}set ease(i){var h,t;if(i==!1){(t=(h=this[Ol])==null?void 0:h.disable)==null||t.call(h);return}this.ease.enable(i)}};(()=>{y(Xd,Yd,"Element",1,Element)})();function wu(){return globalThis.imba.uses_events_keyboard=!0,!0}var Cd=Symbol(),Hd=class{αesc(){return this.keyCode==27}αtab(){return this.keyCode==9}αenter(){return this.keyCode==13}αspace(){return this.keyCode==32}αup(){return this.keyCode==38}αdown(){return this.keyCode==40}αleft(){return this.keyCode==37}αright(){return this.keyCode==39}αdel(){return this.keyCode==8||this.keyCode==46}αkey(i){if(typeof i=="string")return this.key==i;if(typeof i=="number")return this.keyCode==i}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αmod(){let i=globalThis.navigator.platform;return/^(Mac|iPhone|iPad|iPod)/.test(i||"")?!!this.metaKey:!!this.ctrlKey}};(()=>{y(Hd,Cd,"KeyboardEvent",1,Yb)})();function Hs(){return globalThis.imba.uses_events_mouse=!0,!0}var Qd=Symbol(),Zd=class{αleft(){return this.button==0}αmiddle(){return this.button==1}αright(){return this.button==2}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αmod(){let i=globalThis.navigator.platform;return/^(Mac|iPhone|iPad|iPod)/.test(i||"")?!!this.metaKey:!!this.ctrlKey}};(()=>{y(Zd,Qd,"MouseEvent",1,Kb)})();function Ci(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function Ll(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var gd=Symbol.for("#extendType"),Jd=Symbol.for("#modifierState"),ct=Symbol.for("#sharedModifierState"),Wr=Symbol.for("#onceHandlerEnd"),Br=Symbol.for("#extendDescriptors"),D=Symbol.for("#context"),Ns=Symbol.for("#defaultPrevented"),al=Symbol.for("#stopPropagation"),Rr=Symbol.for("#self"),Wd=Symbol.for("#target"),Bd=Symbol.for("#teleport");wu();Hs();var Rd=Symbol(),Md=class{[gd](i){var h,t;let s=i[Br]||(i[Br]=(h=Object.getOwnPropertyDescriptors(i.prototype),t=h.constructor,delete h.constructor,h));return Object.defineProperties(this,s)}};(()=>{y(Md,Rd,"CustomEvent",1,CustomEvent)})();var Ud=Symbol(),qd=class{get original(){return this.originalEvent||this}get[Jd](){var i,h;return(i=this[D])[h=this[D].step]||(i[h]={})}get[ct](){var i,h;return(i=this[D].handler)[h=this[D].step]||(i[h]={})}[Wr](i){return vi(this[D],"end",i)}αsel(i){return!!this.target.matches(String(i))}αclosest(i){return!!this.target.closest(String(i))}αprevent(){return this[Ns]=!0,this.preventDefault(),!0}αtrap(){return this[al]=!0,this.stopImmediatePropagation(),this[Ns]=!0,this.preventDefault(),!0}αfocin(i){var h;let t=this[D].element;return t=Ci(i,Element)?i:i?t.closest(i):t,(h=t==null?void 0:t.contains)==null?void 0:h.call(t,globalThis.document.activeElement)}αlog(...i){return console.info(...i),!0}αtrusted(){return!!this.isTrusted}αuntrusted(){return!this.isTrusted}αif(i){return!!i}αwait(i=250){return new Promise(function(h){return setTimeout(h,Mt(i))})}αself(){return this.target==this[D].element}αcooldown(i=250){let h=this[ct];return h.active?!1:(h.active=!0,h.target=this[D].element,h.target.flags.incr("cooldown"),this[Wr](function(){return setTimeout(function(){return h.target.flags.decr("cooldown"),h.active=!1},Mt(i))}),!0)}αthrottle(i=250,h="throttled"){let t=this[ct];return t.active?(t.next&&t.next(!1),new Promise(function(s){return t.next=function(l){return t.next=null,s(l)}})):(t.active=!0,t.el||(t.el=this[D].element),h&&t.el.flags.incr(h),vi(this[D],"end",function(){let s=Mt(i);return t.interval=setInterval(function(){t.next?t.next(!0):(clearInterval(t.interval),h&&t.el.flags.decr(h),t.active=!1)},s)}),!0)}αdebounce(i=250){let h=this[ct],t=this;return h.queue||(h.queue=[]),h.queue.push(h.last=t),new Promise(function(s){return setTimeout(function(){return h.last==t?(t.debounced=h.queue,h.last=null,h.queue=[],s(!0)):s(!1)},Mt(i))})}αflag(i,h){let{element:t,step:s,state:l,id:u,current:e}=this[D],r=Ci(h,Element)?h:h?t.closest(h):t;if(!r)return!0;this[D].commit=!0,l[s]=u,r.flags.incr(i);let f=Date.now();return vi(e,"end",function(){let m=Date.now()-f,n=Math.max(250-m,0);return setTimeout(function(){return r.flags.decr(i)},n)}),!0}αbusy(i){return this.αflag("busy",i)}αoutside(){let{handler:i}=this[D];if(i&&i[Rr])return!i[Rr].parentNode.contains(this.target)}async αpost(i,h={}){return await globalThis.fetch(i,{method:"POST",...h})}async αfetch(i,h={}){return await globalThis.fetch(i,h)}};(()=>{y(qd,Ud,"Event",1,Event)})();var Pd=Symbol(),Vd=class{αself(){let i=this[D].element;return this.type=="focusout"?this.relatedTarget&&!i.contains(this.relatedTarget):this.type=="focusin"?!this.relatedTarget||!i.contains(this.relatedTarget):this.target==i}};(()=>{y(Vd,Pd,"FocusEvent",1,FocusEvent)})();function S0(){return globalThis.imba.uses_events=!0,!0}var jd=Symbol(),b0=class{constructor(i,h){this.params=i,this.closure=h}getHandlerForMethod(i,h){return i?i[h]?i:this.getHandlerForMethod(i.parentNode,h):null}abortCurrentHandlers(){var i;if(this.currentEvents)for(let h of Ll(this.currentEvents))h.aborted=!0,(i=h==null?void 0:h.resolver)==null||i.call(h,!0);return this}emit(i,...h){return th(this,i,h)}on(i,...h){return hh(this,i,...h)}once(i,...h){return vi(this,i,...h)}un(i,...h){return Ks(this,i,...h)}get passiveΦ(){return this.params.passive}get captureΦ(){return this.params.capture}get silentΦ(){return this.params.silent}get globalΦ(){return this.params.global}async handleEvent(i){if(this.disabled)return;let h=this[Wd]||i.currentTarget,t=this.params,s=null,l=t.silence||t.silent;this.count||(this.count=0),this.state||(this.state={});let u=this.lastState={element:h,event:i,modifiers:t,handler:this,id:++this.count,step:-1,state:this.state,commit:null,called:!1,current:null,aborted:!1};if(u.current=u,i.handle$mod&&i.handle$mod.apply(u,t.options||[])==!1)return;let e=Event[this.type+"$handle"]||Event[i.type+"$handle"]||this.guard;if(!(e&&e.apply(u,t.options||[])==!1)){this.currentEvents||(this.currentEvents=new Set),this.currentEvents.add(u);for(let r=0,f=Object.keys(t),m=f.length,n,S;r<m&&(n=f[r],S=t[n],!u.aborted);r++){if(u.step++,n[0]=="_")continue;n.indexOf("~")>0&&(n=n.split("~")[0]);let d=null,v=[i,u],b,w=null,T,E=!1,N=typeof n=="string";if(n[0]=="$"&&n[1]=="_"&&Ci(S[0],Function))i[D]=u,n=S[0],u.called=!0,n.passive||(u.commit=!0),v=[i,u].concat(S.slice(1)),w=h;else if(Ci(S,Array)){v=S.slice(),d=v;for(let z=0,F=Ll(v),O=F.length;z<O;z++){let L=F[z];if(typeof L=="string"&&L[0]=="~"&&L[1]=="$"){let Y=L.slice(2).split("."),g=u[Y.shift()]||i;for(let C=0,Si=Ll(Y),li=Si.length;C<li;C++){let Ki=Si[C];g=g?g[Ki]:void 0}v[z]=g}}}if(typeof n=="string"&&(T=n.match(/^(emit|flag|mod|moved|pin|fit|refit|map|remap|css)-(.+)$/))&&(d||(d=v=[]),v.unshift(T[2]),n=T[1]),n=="trap")i[al]=!0,i.stopImmediatePropagation(),i[Ns]=!0,i.preventDefault();else if(n=="stop")i[al]=!0,i.stopImmediatePropagation();else if(n=="prevent")i[Ns]=!0,i.preventDefault();else if(n=="commit")u.commit=!0;else if(n=="once")h.removeEventListener(i.type,this);else{if(n=="options"||n=="silence"||n=="silent")continue;if(n=="emit"){let z=v[0],F=v[1];u.called=!0;let O=new CustomEvent(z,{bubbles:!0,detail:F});O.originalEvent=i;let L=(this[Bd]||h).dispatchEvent(O)}else if(typeof n=="string"){n[0]=="!"&&(E=!0,n=n.slice(1));let z="α"+n,F=i[z];F||(F=this.type&&Event[this.type+"$"+n+"$mod"]),F||(F=i[n+"$mod"]||Event[i.type+"$"+n]||Event[n+"$mod"]),Ci(F,Function)?(n=F,w=u,v=d||[],i[z]&&(w=i,i[D]=u)):n[0]=="_"?(n=n.slice(1),w=this.closure):w=this.getHandlerForMethod(h,n)}}try{Ci(n,Function)?b=n.apply(w||h,v):w&&(b=w[n].apply(w,v)),b&&Ci(b.then,Function)&&b!=a.$promise&&(u.commit&&!l&&a.commit(),b=await b)}catch(z){s=z;break}if(E&&b===!0||!E&&b===!1)break;u.value=b}if(th(u,"end",u),u.commit&&!l&&a.commit(),this.currentEvents.delete(u),this.currentEvents.size==0&&this.emit("idle"),s!=null){if(this.type!="error"){let r=Ci(s,Error)?s.message:s,f=new CustomEvent("error",{detail:r,bubbles:!0,cancelable:!0});f.error=s,f.originalEvent=i;let m=h.dispatchEvent(f);if(f.defaultPrevented)return}throw s}return u}}},Mr=b0;(()=>{y(b0,jd,"EventHandler",16)})();var Ad=Symbol(),xd=class{on$(i,h,t){let s="on$"+i,l=h.capture||!1,u=h.passive,e,r=l;return u&&(r={passive:u,capture:l}),Ci(this[s],Function)?(this[s].length>2&&(e=new Mr(h,t)),e=this[s](h,t,e,r)):(e=new Mr(h,t),this.addEventListener(i,e,r)),e}on$error(i,h,t,s){var l;return(l=i.options)!=null&&l.length&&(t.guard=function(...u){let e=this.event.error;return!!u.find(function(r){return Ci(e,r)})}),this.addEventListener("error",t,s),t}};(()=>{y(xd,Ad,"Element",1,Element)})();function Dd(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var pd=Symbol(),Kl,vu=new(Kl=class{get iosΦ(){let i=globalThis.navigator.platform||"";return!!(i.match(/iPhone|iPod|iPad/)||i=="MacIntel"&&globalThis.navigator.maxTouchPoints>2)}},(()=>{y(Kl,pd,null,0)})(),Kl);function Eu(i,h){let t=h;return Dd(i,Element)?i:typeof i=="string"?i=="this"||i==""?t:i=="up"?t.parentNode:i=="op"?t.offsetParent:t.closest(i)||t.querySelector(i)||globalThis.document.querySelector(i):null}function Rh(i){if(typeof i=="string"){let[h,t,s]=i.match(/^([-+]?[\d\.]+)(%|\w+)$/);return[parseFloat(t),s]}else if(typeof i=="number")return[i]}function ol(i,h=1){let t=1/h;return Math.round(i*t)/t}function _d(i,h,t){return h>t?Math.max(t,Math.min(h,i)):Math.min(t,Math.max(h,i))}function Ur(i,h,t,s,l=0.1){let[u,e]=Rh(t),[r,f]=Rh(s),[m,n]=Rh(l);return e=="%"&&(u=(h-i)*(u/100)),f=="%"&&(r=(h-i)*(r/100)),n=="%"&&(m=(r-u)*(m/100)),function(S,d){let v=(S-i)/(h-i),b=u+(r-u)*v;return l&&(b=ol(b,m)),d&&(b=_d(b,u,r)),b}}Hs();var kd=Symbol(),$d=class{αprimary(){return!!this.isPrimary&&(this.pointerType!="mouse"||this.button==0)}αsecondary(){return!this.isPrimary&&this.button!=0}αmouse(){return this.pointerType=="mouse"}αpen(){return this.pointerType=="pen"}αtouch(){return this.pointerType=="touch"}αpressure(i=0.5){return this.pressure>=i}αlock(){return!0}};(()=>{y($d,kd,"PointerEvent",1,Gb)})();function Hh(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var qr=Symbol.for("#capture"),Xi=Symbol.for("#step"),ad=Symbol.for("#cancel"),Gl=Symbol.for("#reframe"),Pr=Symbol.for("#mods"),Yl=Symbol.for("#dx"),Xl=Symbol.for("#dy"),ci=Symbol.for("#context"),zs=Symbol.for("#locked"),d0=Symbol.for("#teardown"),Vr=Symbol.for("#x"),jr=Symbol.for("#y"),od=Symbol.for("#pinTarget");var Ar=null,cd=Symbol(),w0=class{constructor(i,h,t){this.phase="init",this.events=[],this.originalEvent=i,this.handler=h,this.target=this.currentTarget=t,this[Pr]={}}set event(i){this.events.push(i)}get ctrlKey(){return this.originalEvent.ctrlKey}get altKey(){return this.originalEvent.altKey}get shiftKey(){return this.originalEvent.shiftKey}get metaKey(){return this.originalEvent.metaKey}get isPrimary(){return this.originalEvent.isPrimary}get pointerType(){return this.originalEvent.pointerType}get start(){return this.originalEvent}get originalTarget(){return this.originalEvent.target}get event(){return this.events[this.events.length-1]}get elapsed(){return this.event.timeStamp-this.events[0].timeStamp}get type(){return this.event.type}get pointerId(){return this.originalEvent.pointerId}get pressure(){return this.event.pressure}get clientX(){return this.event.clientX}get clientY(){return this.event.clientY}get offsetX(){return this.event.offsetX}get offsetY(){return this.event.offsetY}get activeΦ(){return this.phase!="ended"}get endedΦ(){return this.phase=="ended"}get dx(){return this[Yl]==null?this.event.x-this.start.x:this[Yl]}get dy(){return this[Xl]==null?this.event.y-this.start.y:this[Xl]}get dr(){return Math.sqrt(this.dx*this.dx+this.dy*this.dy)}stopImmediatePropagation(){return this.cancelBubble=!0,this.event.stopImmediatePropagation(),this}stopPropagation(){return this.cancelBubble=!0,this.event.stopPropagation(),this}preventDefault(){return this.defaultPrevented=!0,this.event.preventDefault()}emit(i,...h){return th(this,i,h)}on(i,...h){return hh(this,i,...h)}once(i,...h){return vi(this,i,...h)}un(i,...h){return Ks(this,i,...h)}αflag(i,h){let{element:t}=this[ci],s=Date.now(),l=Hh(h,ti)?h:h?t.closest(h):t;return this[Xi].setup!=!0&&(this[Xi].setup=!0,!0)&&(l.flags.incr(i),vi(this,"end",function(){return l.flags.decr(i)})),!0}αlock(){return this[qr](),!0}[qr](){if(this[zs]!=!0&&(this[zs]=!0,!0))return this[ci].element.setPointerCapture(this.pointerId)}get[Xi](){var i,h;return(i=this[Pr])[h=this[ci].step]||(i[h]={})}[ad](){return this[d0]()}αmoved(i,h){let t=this[Xi],{element:s,state:l,event:u}=this[ci];if(!t.setup){let n=i||4;typeof i=="string"&&i.match(/^(up|down|left|right|x|y)$/)&&(t.dir=i,n=h||4),typeof h=="string"&&h.match(/^(up|down|left|right|x|y)$/)&&(t.dir=h),t.setup=!0;let[S,d]=Rh(n);t.threshold=S,t.sy=S,t.x0=this.x,t.y0=this.y,t.dir||(t.dir="dist"),t.x=t.left=t.right=t.y=t.up=t.down=t.dist=0,d&&d!="px"&&console.warn("only px threshold allowed in @touch.moved")}if(t.active)return!0;if(t.cancelled)return!1;let e=t.threshold,r=this.x-t.x0,f=this.y-t.y0;t.x=Math.max(t.x,Math.abs(r)),t.y=Math.max(t.y,Math.abs(f)),t.left=Math.max(t.left,-r),t.right=Math.max(t.right,r),t.up=Math.max(t.up,-f),t.down=Math.max(t.down,f),t.dist=Math.max(t.dist,Math.sqrt(r*r+f*f));let m=t[t.dir];if(m>e&&m>=t.x&&m>=t.y){t.active=!0;let n=l.pinTarget;return s.flags.incr("@move"),n&&n.flags.incr("@move"),this.preventDefault(),vi(this,"end",function(){return n&&n.flags.decr("@move"),s.flags.decr("@move")}),!0}else if(t.x>e||t.y>e)return t.cancelled=!0,!1;return!1}αhold(i=250){var h=this;let t=this[Xi],s=this[ci].element;if(t.cancelled)return!1;if(t.setup&&!t.active){let l=this.clientX,u=this.clientY,e=l-t.x,r=u-t.y;Math.sqrt(e*e+r*r)>5&&!t.cancelled&&(clearTimeout(t.timeout),t.cancelled=!0)}if(t.setup!=!0&&(t.setup=!0,!0)){t.active=!1,t.x=this.clientX,t.y=this.clientY;let l;return t.timeout=setTimeout(function(){return t.active=!0,h.preventDefault(),s.flags.incr("@hold"),l&&l(!0),l=null},i),vi(this,"end",function(){return t.active&&s.flags.decr("@hold"),clearTimeout(t.timeout),l&&l(!1),l=null}),new Promise(function(u){return l=u})}return t.active}αsync(i,h="x",t="y"){let s=this[Xi];return s.setup!=!0&&(s.setup=!0,!0)?(s.x=i[h]||0,s.y=i[t]||0,s.tx=this.x,s.ty=this.y):(h&&(i[h]=s.x+(this.x-s.tx)),t&&(i[t]=s.y+(this.y-s.ty))),this[ci].commit=!0,!0}αapply(i,h="x",t="y"){return h&&(i[h]=this.x),t&&(i[t]=this.y),this[ci].commit=!0,!0}αcss(i="x",h="y"){let t=this[Xi];if(t.setup!=!0&&(t.setup=!0,!0))t.el=this[ci].element,t.x=t.el[Vr]||0,t.y=t.el[jr]||0,t.tx=this.x,t.ty=this.y;else{let s=t.el[Vr]=t.x+(this.x-t.tx),l=t.el[jr]=t.y+(this.y-t.ty);i&&t.el.style.setProperty("--x",s+"px"),h&&t.el.style.setProperty("--y",l+"px")}return!0}αend(){return this.phase=="ended"}αshift(){return!!this.shiftKey}αalt(){return!!this.altKey}αctrl(){return!!this.ctrlKey}αmeta(){return!!this.metaKey}αprimary(){return!!this.isPrimary&&(this.pointerType!="mouse"||this.originalEvent.button==0)}αmouse(){return this.pointerType=="mouse"}αpen(){return this.pointerType=="pen"}αtouch(){return this.pointerType=="touch"}αpressure(i=0.5){return this.pressure>=i}αlog(...i){return console.info(...i),!0}αleft(){return this.originalEvent.button==0}αmiddle(){return this.originalEvent.button==1}αright(){return this.originalEvent.button==2}αround(i=1,h=i){return this.x=ol(this.x,i),this.y=ol(this.y,h),!0}[Gl](...i){let h=this[Xi];if(h.setup!=!0&&(h.setup=!0,!0)){let t=this.target,s=i.length,l=i[0],u=0,e="100%",r=0,f=typeof l;f=="number"||f=="string"&&/^([-+]?\d[\d\.]*)(%|\w+)$/.test(l)||Hh(l,Array)?l=null:f=="string"&&(l=="this"||l==""?l=t:l=="up"?l=t.parentNode:l=="op"?l=t.offsetParent:l=t.closest(l)||t.querySelector(l)),l==null&&(s++,i.unshift(l=t)),s==2?r=i[1]:s>2&&([u,e,r=0]=i.slice(1));let m=l.getBoundingClientRect();Hh(u,Array)||(u=[u,u]),Hh(e,Array)||(e=[e,e]),Hh(r,Array)||(r=[r,r]),h.rect=m,h.x=Ur(m.left,m.right,u[0],e[0],r[0]),h.y=Ur(m.top,m.bottom,u[1],e[1],r[1]),this.x0=this.x=h.x(this.x,h.clamp),this.y0=this.y=h.y(this.y,h.clamp)}else{let t=this.x=h.x(this.x,h.clamp),s=this.y=h.y(this.y,h.clamp);this[Yl]=t-this.x0,this[Xl]=s-this.y0}return!0}αfit(...i){return this[Xi].clamp=!0,this[Gl](...i)}αreframe(...i){return this[Gl](...i)}αpin(...i){var h;let t=this[Xi];if(t.setup!=!0&&(t.setup=!0,!0)){let s=Eu(i[0],this.target);Hh(s,ti)||i.unshift(s=this.target);let l=i[1]||0,u=(h=i[2])!=null?h:i[2]=l,e=s.getBoundingClientRect();t.x=this.clientX-(e.left+e.width*l),t.y=this.clientY-(e.top+e.height*u),s&&(this[od]=s,s.flags.incr("_touch_"),vi(this,"end",function(){return s.flags.decr("_touch_")}))}return this.x-=t.x,this.y-=t.y,!0}},Id=w0;(()=>{y(w0,cd,"Touch",16)})();var iw=Symbol(),hw=class{on$touch(i,h,t,s){return t.type="touch",this.addEventListener("pointerdown",t,{passive:!1}),vu.iosΦ&&globalThis.parent!=globalThis&&Ar!=!0&&(Ar=!0,!0)&&globalThis.parent.postMessage("setupTouchFix"),t}};(()=>{y(hw,iw,"Element",1,ti)})();if(globalThis.parent==globalThis&&vu.iosΦ){let i=function(h){if(h.data=="setupTouchFix")return globalThis.addEventListener("touchmove",function(){return!1},{passive:!1}),globalThis.removeEventListener("message",i)};globalThis.addEventListener("message",i)}kf.touch$handle=function(){let i=this.event,h=this.element,t=this.state.pointerId,s=this.modifiers,l=this.handler,u=vu.iosΦ;if(this.current=this.state,t!=null)return t==i.pointerId;if(s.ctrl&&!i.ctrlKey||s.alt&&!i.altKey||s.meta&&!i.metaKey||s.shift&&!i.shiftKey||s.if&&!s.if[0]||s.self&&i.target!=h||s.primary&&!i.isPrimary||s.pen&&i.pointerType!="pen"||s.mouse&&i.pointerType!="mouse"||s.touch&&i.pointerType!="touch"||s.sel&&!i.target.matches(String(s.sel[0])))return;let e=this.state=l.state=this.current=new Id(i,l,h);t=e.pointerId;let r=function(b){return b.preventDefault(),!1},f=null,m=Symbol(),n=function(b){let{clientX:w,clientY:T}=e,E=b.clientX,N=b.clientY;(e[zs]||e.defaultPrevented)&&(b.pointerId==e.pointerId||w==E&&T==N)&&(b.preventDefault(),b.stopPropagation()),n&&(globalThis.removeEventListener("click",n,{capture:!0}),n=null)},S=function(b){if(!(e.type=="touchmove"&&b.changedTouches[0].identifier!=t)&&(e.defaultPrevented||e[zs]))return b.preventDefault()},d=function(b){let w=b.type,T=e.phase;if(b.pointerId&&e.pointerId!=b.pointerId||b[m])return;b[m]=!0;let E=w=="pointerup"||w=="pointercancel";if(b.pressure==0&&b.pointerType=="mouse"&&w=="pointermove"&&e.originalEvent.pressure>0)return f(b);w=="pointercancel"?(e.x=e.clientX,e.y=e.clientY):(e.x=b.clientX,e.y=b.clientY),e.event=b,E&&(e.phase="ended");try{l.handleEvent(e)}catch{}if(T=="init"&&!E&&(e.phase="active"),E&&f)return f(b)},v=!1;return f=function(b){if(!v&&(v=!0,h.flags.decr("_touch_"),e.phase!="ended"&&(e.phase="ended",e.x=e.clientX,e.y=e.clientY,l.handleEvent(e)),e.emit("end"),s.passive||--l.prevents==0&&h.style.removeProperty("touch-action"),l.state={},globalThis.removeEventListener("pointermove",d,{passive:!!s.passive}),globalThis.removeEventListener("pointerup",d),globalThis.removeEventListener("pointercancel",d),setTimeout(function(){if(n&&(globalThis.removeEventListener("click",n,{capture:!0}),n=null),u&&S)return globalThis.removeEventListener("touchend",S),globalThis.removeEventListener("touchmove",S,{passive:!1}),S=null},100),!s.passive))return globalThis.document.removeEventListener("selectstart",r,{capture:!0})},e[d0]=f,s.passive||(l.prevents||(l.prevents=0),l.prevents++,h.style.setProperty("touch-action","none"),h.offsetWidth),h.flags.incr("_touch_"),globalThis.addEventListener("pointermove",d,{passive:!!s.passive}),globalThis.addEventListener("pointerup",d),globalThis.addEventListener("pointercancel",d),globalThis.addEventListener("click",n,{capture:!0}),u&&!s.passive&&(globalThis.addEventListener("touchend",S),globalThis.addEventListener("touchmove",S,{passive:!1})),s.passive||globalThis.document.addEventListener("selectstart",r,{capture:!0}),d(i),!1};function v0(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}function xr(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var tw=Symbol.for("#context"),sw=Symbol.for("#extendType");var Dr=new(globalThis.WeakMap||Map),Cl={threshold:[0]},lw={};kf.intersect$handle=function(){let i=this.event.detail.observer;return this.modifiers._observer==i};var uw=Symbol(),E0=class extends Wi{αin(){return this.delta>=0&&this.entry.isIntersecting}αout(){return this.delta<0}αcss(i="ratio"){return this.target.style.setProperty("--ratio",this.ratio),!0}αflag(i,h){let{state:t,step:s}=this[tw],l=Eu(h||"",this.target);return this.isIntersecting&&!t[s]?(l.flags.incr(i),t[s]=!0):t[s]&&!this.isIntersecting&&(l.flags.decr(i),t[s]=!1),!0}},ew=E0;(()=>{y(E0,uw,"IntersectionEvent",0)})();function rw(i,h){return function(t,s){let l=s.prevRatios||(s.prevRatios=new WeakMap);for(let u=0,e=v0(t),r=e.length;u<r;u++){let f=e[u],m=l.get(f.target)||0,n=f.intersectionRatio,S={entry:f,ratio:n,from:m,delta:n-m,observer:s},d=new Wi(i,{bubbles:!1,detail:S});d[sw](ew),d.entry=f,d.isIntersecting=f.isIntersecting,d.delta=S.delta,d.ratio=S.ratio,l.set(f.target,n),f.target.dispatchEvent(d)}}}function pr(i=Cl){let h=i.threshold.join("-")+i.rootMargin;!i.root&&Cl.root&&(i.root||(i.root=Cl.root));let t=i.root||lw,s=Dr.get(t);return s||Dr.set(t,s={}),s[h]||(s[h]=new IntersectionObserver(rw("intersect",h),i))}var fw=Symbol(),mw=class{on$intersect(i,h,t,s){let l;if(i.options){let u=[],e={threshold:u};for(let r=0,f=v0(i.options),m=f.length;r<m;r++){let n=f[r];xr(n,ti)||xr(n,Jb)?e.root=n:typeof n=="number"?u.push(n):typeof n=="string"?e.rootMargin=n:typeof n=="object"&&Object.assign(e,n)}if(u.length==1){let r=u[0];if(r>1)for(u[0]=0;u.length<r;)u.push(u.length/(r-1))}u.length==0&&u.push(0),l=pr(e)}else l=pr();return i._observer=l,l.observe(this),this.addEventListener("intersect",t,s),t}};(()=>{y(mw,fw,"Element",1,ti)})();function nw(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var _r=Symbol.for("#width"),kr=Symbol.for("#height"),Sw=Symbol.for("#extendType");var It=null,bw=Symbol(),T0=class extends Wi{αcss(i="1elw",h="1elh",t="",s=""){var l;let u=(l=this.entry)==null?void 0:l.target;if(t=="px"&&(s=t,t=""),u&&u.offsetParent){let e=Rh(i),r=Rh(h),f=Eu(t,u),m=e?"--u_"+e[1]:"--"+i,n=r?"--u_"+r[1]:"--"+h,S=e?this.width/e[0]:this.width,d=r?this.height/r[0]:this.height;f.style.setProperty(m,S+s),f.style.setProperty(n,d+s)}return!0}get width(){var i;return(i=this[_r])!=null?i:this[_r]=this.entry.target.offsetWidth}get height(){var i;return(i=this[kr])!=null?i:this[kr]=this.entry.target.offsetHeight}},dw=T0;(()=>{y(T0,bw,"ResizeEvent",0)})();function ww(){return globalThis.ResizeObserver||It||(console.warn(":resize not supported in this browser"),It={observe:function(){return!0}}),globalThis.imbaResizeObserver=It||(It=new ResizeObserver(function(i){for(let h=0,t=nw(i),s=t.length;h<s;h++){let l=t[h],u=new Wi("resize",{bubbles:!1,detail:l});u.entry=l,u.rect=l.contentRect,u[Sw](dw),l.target.dispatchEvent(u);let e=new Wi("resized",{bubbles:!0,detail:l});l.target.dispatchEvent(e)}}))}var vw=Symbol(),Ew=class{on$resize(i,h,t,s){return ww().observe(this),this.addEventListener("resize",t,s),t}};(()=>{y(Ew,vw,"Element",1,ti)})();var Tw=Symbol.for("#extendType"),yw=Symbol.for("#options");var Nw=Symbol(),y0=class extends Wi{},zw=y0;(()=>{y(y0,Nw,"MutationEvent",0)})();var Fw=Symbol(),Ow=class{on$mutate(i,h,t,s){var l=this;t.observer||(t.observer=new MutationObserver(function(e){let r=new Wi("mutate",{bubbles:!!i.bubble,detail:e});return r[Tw](zw),l.dispatchEvent(r)}));let u=t[yw]={};return i.subtree&&(u.subtree=!0),i.childList&&(u.childList=!0),i.attributes&&(u.attributes=!0),!u.attributes&&!u.childList&&(u.childList=!0),t.observer.observe(this,u),this.addEventListener("mutate",t,s),t}};(()=>{y(Ow,Fw,"Element",1,ti)})();var Hl,$r=Symbol();function Lw(){if(!Hl)return Hl=function(i){if(i[$r])return;i[$r]=!0;let h=globalThis.document.activeElement;if(h&&h.matches("input,textarea")){let t=new Wi("selection",{detail:{start:h.selectionStart,end:h.selectionEnd}});return h.dispatchEvent(t)}},globalThis.document.addEventListener("selectionchange",Hl)}var Kw=Symbol(),Gw=class{on$selection(i,h,t,s){return Lw(),this.addEventListener("selection",t,s),t}};(()=>{y(Gw,Kw,"Element",1,ti)})();var ar=Symbol.for("#string"),or=Symbol.for("#html"),Bi={win:{sep:"+",name:"win",order:["meta","ctrl","mod","alt","option","shift"].reverse(),labels:{option:"alt",mod:"ctrl",meta:"win"}},mac:{sep:"",name:"mac",order:["ctrl","alt","option","shift","mod","command"].reverse(),labels:{left:"→",up:"↑",down:"↓",right:"←",plus:"+",tab:"⇥",meta:"⌘",mod:"⌘",ctrl:"⌃",option:"⌥",alt:"⌥",del:"⌦",shift:"⇧",enter:"↩",esc:"⎋",backspace:"⌫"}}};Bi.auto=Bi.win;(globalThis.navigator.platform||"").match(/iPhone|iPod|iPad|Mac/)&&(Bi.auto=Bi.mac);var Ql={};function N0(i,h="auto"){let t=""+i+":"+h;if(Ql[t])return Ql[t];let s=Bi[h]||Bi.win,l=i.split(" ").map(function(u){return u.split("+").sort(function(e,r){return s.order.indexOf(r)-s.order.indexOf(e)}).map(function(e){let r=s.labels[e]||e;return r=r[0].toUpperCase()+(r.slice(1)||"")})});return Ql[t]=l}function Yw(i,h){let t=N0(i,h),s=Bi[h]||Bi.win;return t[ar]||(t[ar]=t.map(function(l){return l.join(s.sep)}).join(" "))}function Xw(i,h){let t=N0(i,h),s=Bi[h]||Bi.win;return t[or]||(t[or]=t.map(function(l){return"<kbd>"+l.map(function(u){return"<kbd>"+u+"</kbd>"}).join("")+"</kbd>"}).join(" "))}var ih={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},cr={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Ir={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},hf={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},st;for(Zi=1;Zi<20;++Zi)ih[111+Zi]="f"+Zi;var Zi;for(Zi=0;Zi<=9;++Zi)ih[Zi+96]=Zi.toString();function Zl(i,h,t){if(i.addEventListener){i.addEventListener(h,t,!1);return}i.attachEvent("on"+h,t)}function gl(i,h,t){if(i.removeEventListener){i.removeEventListener(h,t,!1);return}i.detachEvent("on"+h,t)}function tf(i){if(i.type=="keypress"){var h=String.fromCharCode(i.which);return i.shiftKey||(h=h.toLowerCase()),h}return ih[i.which]?ih[i.which]:cr[i.which]?cr[i.which]:String.fromCharCode(i.which).toLowerCase()}function Cw(i,h){return i.sort().join(",")===h.sort().join(",")}function Hw(i){var h=[];return i.shiftKey&&h.push("shift"),i.altKey&&h.push("alt"),i.ctrlKey&&h.push("ctrl"),i.metaKey&&h.push("meta"),h}function Qw(i){if(i.preventDefault){i.preventDefault();return}i.returnValue=!1}function Zw(i){if(i.stopPropagation){i.stopPropagation();return}i.cancelBubble=!0}function cl(i){return i=="shift"||i=="ctrl"||i=="alt"||i=="meta"}function gw(){if(!st){st={};for(var i in ih)i>95&&i<112||ih.hasOwnProperty(i)&&(st[ih[i]]=i)}return st}function Jw(i,h,t){return t||(t=gw()[i]?"keydown":"keypress"),t=="keypress"&&h.length&&(t="keydown"),t}function Ww(i){return i==="+"?["+"]:(i=i.replace(/\+{2}/g,"+plus"),i.split("+"))}function sf(i,h){var t,s,l,u=[];for(t=Ww(i),l=0;l<t.length;++l)s=t[l],hf[s]&&(s=hf[s]),h&&h!="keypress"&&Ir[s]&&(s=Ir[s],u.push("shift")),cl(s)&&u.push(s);return h=Jw(s,u,h),{key:s,modifiers:u,action:h}}function z0(i,h){return i===null||i===document?!1:i===h?!0:z0(i.parentNode,h)}function hi(i){var h=this;if(i=i||document,!(h instanceof hi))return new hi(i);h.handleKeyEvent=n,h.target=i,h._callbacks={},h._directMap={};var t={},s,l=!1,u=!1,e=!1;function r(b){b=b||{};var w=!1,T;for(T in t){if(b[T]){w=!0;continue}t[T]=0}w||(e=!1)}function f(b,w,T,E,N,z){var F,O,L=[],Y=T.type;if(!h._callbacks[b])return[];for(Y=="keyup"&&cl(b)&&(w=[b]),F=0;F<h._callbacks[b].length;++F)if(O=h._callbacks[b][F],!(!E&&O.seq&&t[O.seq]!=O.level)&&Y==O.action&&(Y=="keypress"&&!T.metaKey&&!T.ctrlKey||Cw(w,O.modifiers))){var g=!E&&O.combo==N,C=E&&O.seq==E&&O.level==z;(g||C)&&h._callbacks[b].splice(F,1),L.push(O)}return L}function m(b,w,T,E){h.stopCallback(w,w.target||w.srcElement,T,E)||b(w,T)===!1&&(Qw(w),Zw(w))}h._handleKey=function(b,w,T){var E=f(b,w,T),N,z={},F=0,O=!1;for(N=0;N<E.length;++N)E[N].seq&&(F=Math.max(F,E[N].level));for(N=0;N<E.length;++N){if(E[N].seq){if(E[N].level!=F)continue;O=!0,z[E[N].seq]=1,m(E[N].callback,T,E[N].combo,E[N].seq);continue}O||m(E[N].callback,T,E[N].combo)}var L=T.type=="keypress"&&u;T.type==e&&!cl(b)&&!L&&r(z),u=O&&T.type=="keydown"};function n(b){typeof b.which!="number"&&(b.which=b.keyCode);var w=tf(b);if(w){if(b.type=="keyup"&&l===w){l=!1;return}h.handleKey(w,Hw(b),b)}}function S(){clearTimeout(s),s=setTimeout(r,1000)}function d(b,w,T,E){t[b]=0;function N(Y){return function(){e=Y,++t[b],S()}}function z(Y){m(T,Y,b),E!=="keyup"&&(l=tf(Y)),setTimeout(r,10)}for(var F=0;F<w.length;++F){var O=F+1===w.length,L=O?z:N(E||sf(w[F+1]).action);v(w[F],L,E,b,F)}}function v(b,w,T,E,N){h._directMap[b+":"+T]=w,b=b.replace(/\s+/g," ");var z=b.split(" "),F;if(z.length>1){d(b,z,w,T);return}F=sf(b,T),h._callbacks[F.key]=h._callbacks[F.key]||[],f(F.key,F.modifiers,{type:F.action},E,b,N),h._callbacks[F.key][E?"unshift":"push"]({callback:w,modifiers:F.modifiers,action:F.action,seq:E,level:N,combo:b})}h._bindMultiple=function(b,w,T){for(var E=0;E<b.length;++E)v(b[E],w,T)},h.enable=function(){Zl(i,"keypress",n),Zl(i,"keydown",n),Zl(i,"keyup",n)},h.disable=function(){gl(i,"keypress",n),gl(i,"keydown",n),gl(i,"keyup",n)},h.enable()}hi.prototype.bind=function(i,h,t){var s=this;return i=i instanceof Array?i:[i],s._bindMultiple.call(s,i,h,t),s};hi.prototype.unbind=function(i,h){var t=this;return t.bind.call(t,i,function(){},h)};hi.prototype.trigger=function(i,h){var t=this;return t._directMap[i+":"+h]&&t._directMap[i+":"+h]({},i),t};hi.prototype.reset=function(){var i=this;return i._callbacks={},i._directMap={},i};hi.prototype.stopCallback=function(i,h){var t=this;return(" "+h.className+" ").indexOf(" mousetrap ")>-1||z0(h,t.target)?!1:h.tagName=="INPUT"||h.tagName=="SELECT"||h.tagName=="TEXTAREA"||h.isContentEditable};hi.prototype.handleKey=function(){var i=this;return i._handleKey.apply(i,arguments)};hi.addKeycodes=function(i){for(var h in i)i.hasOwnProperty(h)&&(ih[h]=i[h]);st=null};hi.init=function(){var i=hi(document);for(var h in i)h.charAt(0)!=="_"&&(hi[h]=function(t){return function(){return i[t].apply(i,arguments)}}(h))};function Jh(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}function Bw(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Jl=Symbol.for("#updateHotKeys"),Rw=Symbol.for("#context"),Mw=Symbol.for("#inInput"),Il=Symbol.for("#inEditable"),Uw=Symbol.for("#hotkeyTarget"),F0=Symbol.for("#hotkeyCombos"),Wh=Symbol.for("#hotkeyHandlers"),dh=Symbol.for("#combos"),qw=Symbol.for("#extendType"),iu=Symbol.for("#target"),lf=Symbol.for("#defaultPrevented"),Pw=Symbol.for("#stopPropagation"),Vw=Symbol.for("#visit"),uf=Symbol.for("#key"),jw;try{jw=(globalThis.navigator.platform||"").match(/iPhone|iPod|iPad|Mac/)}catch{}var hu={esc:!0},Aw=Symbol(),O0=class extends Wi{αfocus(i){let h=this[Rw].element,t=h.ownerDocument;return i&&(h=h.querySelector(i)||h.closest(i)||t.querySelector(i)),h==t.body?t.activeElement!=t.body&&t.activeElement.blur():h.focus(),!0}αlocal(){return!0}αrepeat(){return!0}},xw=O0;(()=>{y(O0,Aw,"HotkeyEvent",0)})();var Dw=function(i,h,t){return h.tagName=="INPUT"&&(t=="down"||t=="up")?!1:h.tagName=="INPUT"||h.tagName=="SELECT"||h.tagName=="TEXTAREA"?hu[t]?(i[Mw]=!0,i[Il]=!0,!1):!0:h.contentEditable&&(h.contentEditable=="true"||h.contentEditable=="plaintext-only")?hu[t]?(i[Il]=!0,!1):!0:!1},pw=Symbol(),L0=class{constructor(){this.combos={"*":{}},this.identifiers={},this.labels={},this.handler=this.handle.bind(this),this.mousetrap=null,this.hothandler=this.handle.bind(this)}addKeycodes(i){return hi.addKeycodes(i)}trigger(i){var h,t;return(t=(h=this.mousetrap)==null?void 0:h.trigger)==null?void 0:t.call(h,i)}register(i,h={}){return this.mousetrap||(this.mousetrap=hi(globalThis.document),this.mousetrap.stopCallback=Dw),this.combos[i]||(this.combos[i]=!0,this.mousetrap.bind(i,this.handler)),(h.capture||h.force)&&(hu[i]=!0),this}comboIdentifier(i){var h;return(h=this.identifiers)[i]||(h[i]=i.replace(/\+/g,"_").replace(/\ /g,"-").replace(/\*/g,"all").replace(/\|/g," "))}humanize(i,h="auto"){return Yw(i,h)}htmlify(i,h="auto"){return Xw(i,h)}matchCombo(i){return!0}handleEvent(i){var h,t;return(t=(h=this.mousetrap)==null?void 0:h.handleKeyEvent)==null?void 0:t.call(h,i)}handle(i,h){var t;let s=i.target&&i.target[Uw]||i.target||globalThis.document.body,l=Array.from(globalThis.document.querySelectorAll("[data-hotkey]")),u=s.ownerDocument,e=s,r=[];for(;e&&e!=u&&e.hotkeys!==!0;)e=e.parentNode;l=l.reverse().filter(function(d){let v=d[F0],b=v&&v[h],w=v&&v["*"];if(!(b||w))return!1;let T=d[Wh],E=d;for(;E&&E!=u;){if(E.hotkeys===!1)return!1;if(E.hotkeys===!0&&!E.contains(s)){let N=!0;for(let z=0,F=Jh(T),O=F.length;z<O;z++){let L=F[z];(L[dh][h]||L[dh]["*"])&&L.globalΦ&&(N=!1)}if(N)return!1}E=E.parentNode}return!0});let f=globalThis.document.activeElement;if(l.length>1){let d=l.filter(function(b){return f.contains(b)});d.length&&(l=d);let v=l.filter(function(b){try{return!b.hiddenΦ}catch{}});v.length>0&&(l=v)}if(!l.length)return;let m={combo:h,originalEvent:i,targets:l},n=new Wi("hotkey",{bubbles:!0,detail:m});n[qw](xw),n.originalEvent=i,n.hotkey=h,s.dispatchEvent(n);for(let d=0,v=Jh(l),b=v.length;d<b;d++){let w=v[d];for(let T=0,E=Jh(w[Wh]),N=E.length;T<N;T++){let z=E[T];if(z[dh][h]||z[dh]["*"]){if(z.params.local&&!z[iu].contains(s)||z.params.unobstructed&&!w.unobstructedΦ)continue;if(!i[Il]||z.captureΦ||z.params.force){let F=z[iu];(e&&(e.contains(F)||F.contains(e))||z.globalΦ)&&r.push(z)}}}}let S=[];for(let d=0,v=Jh(r),b=v.length;d<b;d++){let w=v[d],T;(!i.repeat||w.params.repeat)&&(T=w.handleEvent(n));let E=w.lastState||{};if(S.push(E),(!w.passiveΦ&&E.called||n[lf])&&((t=i==null?void 0:i.preventDefault)==null||t.call(i)),!(w.passiveΦ||E.called==!1&&!n[Pw]&&!n[lf]))break}return S}},_w=L0;(()=>{y(L0,pw,"HotKeyManager",16)})();var kw=new _w,K0=function(i,h){let t=h.element;Bw(t,ti)&&(t.matches("input,textarea,select,option")?t.focus():t.click())};K0.passive=!0;var $w=Symbol(),aw=class{on$hotkey(i,h,t,s){var l=this;return this[Wh]||(this[Wh]=[]),this[Wh].push(t),t[iu]=this,i.$_||(i.$_=[K0]),i[Vw]=function(){return l[Jl]()},this[Jl](),t}[Jl](){let i={};for(let h=0,t=Jh(this[Wh]),s=t.length;h<s;h++){let l=t[h],u=l.params,e=u.options[0];if(l[uf]!=e&&(l[uf]=e,!0)){l[dh]={};for(let r=0,f=Jh(e.split("|")),m=f.length;r<m;r++){let n=f[r];kw.register(n,u),l[dh][n]=!0}}Object.assign(i,l[dh])}return this[F0]=i,this.dataset.hotkey=Object.keys(i).join(" "),this}};(()=>{y(aw,$w,"Element",1,ti)})();var Mh=typeof Reflect=="object"?Reflect:null,ef=Mh&&typeof Mh.apply=="function"?Mh.apply:function(i,h,t){return Function.prototype.apply.call(i,h,t)},fs;Mh&&typeof Mh.ownKeys=="function"?fs=Mh.ownKeys:Object.getOwnPropertySymbols?fs=function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:fs=function(i){return Object.getOwnPropertyNames(i)};function ow(i){console&&console.warn&&console.warn(i)}var G0=Number.isNaN||function(i){return i!==i};function Z(){Z.init.call(this)}Z.EventEmitter=Z;Z.prototype._events=void 0;Z.prototype._eventsCount=0;Z.prototype._maxListeners=void 0;var rf=10;function Qs(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(Z,"defaultMaxListeners",{enumerable:!0,get:function(){return rf},set:function(i){if(typeof i!="number"||i<0||G0(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");rf=i}});Z.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Z.prototype.setMaxListeners=function(i){if(typeof i!="number"||i<0||G0(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this};function Y0(i){return i._maxListeners===void 0?Z.defaultMaxListeners:i._maxListeners}Z.prototype.getMaxListeners=function(){return Y0(this)};Z.prototype.emit=function(i){for(var h=[],t=1;t<arguments.length;t++)h.push(arguments[t]);var s=i==="error",l=this._events;if(l!==void 0)s=s&&l.error===void 0;else if(!s)return!1;if(s){var u;if(h.length>0&&(u=h[0]),u instanceof Error)throw u;var e=new Error("Unhandled error."+(u?" ("+u.message+")":""));throw e.context=u,e}var r=l[i];if(r===void 0)return!1;if(typeof r=="function")ef(r,this,h);else for(var f=r.length,m=Z0(r,f),t=0;t<f;++t)ef(m[t],this,h);return!0};function X0(i,h,t,s){var l,u,e;if(Qs(t),u=i._events,u===void 0?(u=i._events=Object.create(null),i._eventsCount=0):(u.newListener!==void 0&&(i.emit("newListener",h,t.listener?t.listener:t),u=i._events),e=u[h]),e===void 0)e=u[h]=t,++i._eventsCount;else if(typeof e=="function"?e=u[h]=s?[t,e]:[e,t]:s?e.unshift(t):e.push(t),l=Y0(i),l>0&&e.length>l&&!e.warned){e.warned=!0;var r=new Error("Possible EventEmitter memory leak detected. "+e.length+" "+String(h)+" listeners added. Use emitter.setMaxListeners() to increase limit");r.name="MaxListenersExceededWarning",r.emitter=i,r.type=h,r.count=e.length,ow(r)}return i}Z.prototype.addListener=function(i,h){return X0(this,i,h,!1)};Z.prototype.on=Z.prototype.addListener;Z.prototype.prependListener=function(i,h){return X0(this,i,h,!0)};function cw(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function C0(i,h,t){var s={fired:!1,wrapFn:void 0,target:i,type:h,listener:t},l=cw.bind(s);return l.listener=t,s.wrapFn=l,l}Z.prototype.once=function(i,h){return Qs(h),this.on(i,C0(this,i,h)),this};Z.prototype.prependOnceListener=function(i,h){return Qs(h),this.prependListener(i,C0(this,i,h)),this};Z.prototype.removeListener=function(i,h){var t,s,l,u,e;if(Qs(h),s=this._events,s===void 0)return this;if(t=s[i],t===void 0)return this;if(t===h||t.listener===h)--this._eventsCount===0?this._events=Object.create(null):(delete s[i],s.removeListener&&this.emit("removeListener",i,t.listener||h));else if(typeof t!="function"){for(l=-1,u=t.length-1;u>=0;u--)if(t[u]===h||t[u].listener===h){e=t[u].listener,l=u;break}if(l<0)return this;l===0?t.shift():Iw(t,l),t.length===1&&(s[i]=t[0]),s.removeListener!==void 0&&this.emit("removeListener",i,e||h)}return this};Z.prototype.off=Z.prototype.removeListener;Z.prototype.removeAllListeners=function(i){var h,t,s;if(t=this._events,t===void 0)return this;if(t.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):t[i]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete t[i]),this;if(arguments.length===0){var l=Object.keys(t),u;for(s=0;s<l.length;++s)u=l[s],u!=="removeListener"&&this.removeAllListeners(u);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(h=t[i],typeof h=="function")this.removeListener(i,h);else if(h!==void 0)for(s=h.length-1;s>=0;s--)this.removeListener(i,h[s]);return this};function H0(i,h,t){var s=i._events;if(s===void 0)return[];var l=s[h];return l===void 0?[]:typeof l=="function"?t?[l.listener||l]:[l]:t?iv(l):Z0(l,l.length)}Z.prototype.listeners=function(i){return H0(this,i,!0)};Z.prototype.rawListeners=function(i){return H0(this,i,!1)};Z.listenerCount=function(i,h){return typeof i.listenerCount=="function"?i.listenerCount(h):Q0.call(i,h)};Z.prototype.listenerCount=Q0;function Q0(i){var h=this._events;if(h!==void 0){var t=h[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Z.prototype.eventNames=function(){return this._eventsCount>0?fs(this._events):[]};function Z0(i,h){for(var t=new Array(h),s=0;s<h;++s)t[s]=i[s];return t}function Iw(i,h){for(;h+1<i.length;h++)i[h]=i[h+1];i.pop()}function iv(i){for(var h=new Array(i.length),t=0;t<h.length;++t)h[t]=i[t].listener||i[t];return h}function Wl(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Bl=Symbol.for("#getQueryParam"),ff=Symbol.for("#setQueryParam"),mf=Symbol.for("#query"),hv=Symbol(),ft=class{static parse(i,h){return Wl(i,ft)?i:new ft(i,h)}constructor(i,h){this.router=h,this.parse(i)}parse(i){var h;let t;return Wl(i,URL)||(i=new URL(i,this.router.origin)),(t=(h=this.router)==null?void 0:h.aliases[i.pathname])&&(i.pathname=t),this.url=i,this}get activeΦ(){return this.router.location==this}reparse(){return this.parse(this.url)}get searchParams(){return this.url.searchParams}search(){let i=this.searchParams?this.searchParams.toString():"";return i?"?"+i:""}update(i){if(Wl(i,Object))for(let h=0,t=Object.keys(i),s=t.length,l,u;h<s;h++)l=t[h],u=i[l],this.searchParams.set(l,u);else typeof i=="string"&&this.parse(i);return this}clone(){return new ft(this.url.href,this.router)}equals(i){return this.toString()==String(i)}get href(){return this.url.href}get path(){return this.url.href.slice(this.url.origin.length)}get pathname(){return this.url.pathname}get query(){return this[mf]||(this[mf]=new Proxy({},{get:this[Bl].bind(this),set:this[ff].bind(this)}))}toString(){return this.href}[Bl](i,h){return this.searchParams.get(h)}[ff](i,h,t){var s;let l=(s=this[Bl](i,h))!=null?s:"";return t=t!=null?t:"",l!=t&&(t==null||t==""?this.searchParams.delete(h):this.searchParams.set(h,t),this.activeΦ&&(this.router.history.replaceState({},null,this.path),this.router.touch())),!0}},ms=ft;(()=>{y(ft,hv,"Location",16)})();function nf(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function tv(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}function Tu(){return function(){return!0}}var sv=Symbol(),mt=class{constructor(i,h=""){this.store=i||{},this.cache={raw:{},rich:{}},this.ns=h,this.local=i==globalThis.sessionStorage,this.children=new Map}serialize(i,h){return JSON.stringify(i)}deserialize(i,h){return JSON.parse(i)}getItem(i){let h=String(this.ns)+":"+i;if(nf(this.store,mt))return this.store.getItem(h);if(this.local&&this.cache.rich[h]!=null)return this.cache.rich[h];let t=this.store.getItem(h);if(t!=null)return this.cache.raw[h]==t?this.cache.rich[h]:(this.cache.raw[h]=t,this.cache.rich[h]=this.deserialize(t,h))}setItem(i,h){var t,s;let l=String(this.ns)+":"+i;if(nf(this.store,mt))return this.store.setItem(l,h);let u=this.cache.rich[l],e=typeof h;if(this.local&&(this.cache.rich[l]=h),u!==h||e=="object"){let r=this.store.getItem(l);if(h==null)return this.store.removeItem(l),t=this.cache.rich[l],delete this.cache.rich[l],s=this.cache.raw[l],delete this.cache.raw[l],W();{let f=this.serialize(h,l);if(this.cache.rich[l]=h,this.cache.raw[l]=f,r!=f)return this.store.setItem(l,f),W()}}}removeItem(i){var h;let t=String(this.ns)+":"+i;return h=this.cache[t],delete this.cache[t],this.store.removeItem(t)}get(i,h,t){return this.getItem(h)}set(i,h,t,s){return this.setItem(h,t),!0}apply(i,h,[t]){let s=this.children.get(t);return s||this.children.set(t,s=new Proxy(Tu(),new mt(this,t))),s}deleteProperty(i,h){return this.removeItem(h),!0}ownKeys(i){let h=["prototype"],t=this.ns+":";for(let s=0,l=tv(Object.keys(this.store)),u=l.length;s<u;s++){let e=l[s];e.indexOf(t)==0&&h.push(e.slice(t.length))}return h}},g0=mt;(()=>{y(mt,sv,"Storage",16)})();var J0=new Proxy(Tu(),new g0(globalThis.localStorage)),lv=new Proxy(Tu(),new g0(globalThis.sessionStorage));function uv(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var Ih=Symbol.for("#states"),Sf=new WeakMap,ev=Symbol(),W0=class{static from(i,h){return h?new this(i,h):null}constructor(i,h,t=!1){Sf.set(this,i),this.path=h.path,this.data=h.data||{},this.index=h.index,this.type=h.type,this.local=t}get history(){return Sf.get(this)}get next(){return this.history.at(this.index+1)}get prev(){return this.history.at(this.index-1)}toJSON(){return{path:this.path,data:this.data,index:this.index,type:this.type}}save(){return this.history.cache[this.index]=this,this}toString(){return""+this.history.id+"|"+this.index}},Rl=W0;(()=>{y(W0,ev,"State",16)})();var rv=Symbol(),B0=class{constructor(i){this.router=i,this.store=lv("router"),this[Ih]=[],this.cache={},this.index=-1;let h=globalThis.history.state,t;if(typeof h=="string"){let s=h.split("|");this.id=parseInt(s[0]),this.index=parseInt(s[1]),this.cache=this.store(this.id)}else this.id=this.store.id=(this.store.id||0)+1,this.cache=this.store(this.id);this.index==-1&&this.replaceState({initial:!0},null,i.path)}get length(){return this.cache.length}get state(){return this.at(this.index)}get states(){let i=this.length,h=0;for(;h<i;)this.at(h++);return this[Ih]}get currentStates(){return this.states.slice(0,this.length)}get next(){return this.state.next}get prev(){return this.state.prev}slice(i,h=this.length){let t=[];for(;i<h;)t.push(this.at(i++));return t}at(i){var h;if(!(i>=this.length))return(h=this[Ih])[i]||(h[i]=Rl.from(this,this.cache[i]))}buildState(i,h,t=!0){let s={data:i,index:this.index+1,path:h||this.router.path,type:t?"push":"replace"};return new Rl(this,s,!0)}pushState(i,h,t,s=!0){return uv(i,Rl)||(i=this.buildState(i,t,s)),this.index=i.index,this.cache[this.index]=i,this[Ih][this.index]=i,this[Ih].length=this.cache.length=Math.max(i.index+1,0),globalThis.history[s?"pushState":"replaceState"](String(i),h||null,i.path),this}replaceState(i,h,t){return this.pushState(i,h,t,!1)}},fv=B0;(()=>{y(B0,rv,"History",16)})();var mv=Symbol(),R0=class{constructor(i,h,t,s){this.params=s,this.router=i,h&&(this.location=ms.parse(h),this.original=this.location.clone()),this.referrer=t}get apply(){return this.params.apply||[]}get revert(){return this.params.revert||[]}get state(){return this.params.state}get mode(){return this.params.mode}redirect(i){var h,t;return(t=(h=this.location)==null?void 0:h.update)==null||t.call(h,i),this}get path(){var i;return(i=this.location)==null?void 0:i.path}get url(){var i,h;return(h=(i=this.location)==null?void 0:i.toString)==null?void 0:h.call(i)}set path(i){this.location.path=i}abort(i=!1){return this.aborted=!0,i&&(this.forceAbort=i),this}match(i){return this.location?this.router.route(i).match(this.path):null}},bf=R0;(()=>{y(R0,mv,"Request",16)})();function df(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var Fs=Symbol.for("#routes"),Ml=Symbol.for("#match"),nv=Symbol.for("#symbol"),wf=Symbol.for("#matches"),Ul=new Map,ql={},vf={},Sv=/.*/;function bv(i){if(!Ul.has(i)){let h=new Map;return Ul.set(i,h),h}return Ul.get(i)}function dv(i,h){let t=bv(i);if(!t.has(h)){let s=Object.create(i);return Object.assign(s,h),t.set(h,s),s}return t.get(h)}var wv=Symbol(),M0=class{},vv=M0;(()=>{y(M0,wv,"Match",0)})();function Ev(i){if(ql[i])return ql[i];let h=ql[i]={url:i},t=i.indexOf("?"),s=i.indexOf("#");if(s>=0&&(h.hash=i.slice(s+1),i=h.url=i.slice(0,s)),t>=0){let l=h.query=i.slice(t+1);i=i.slice(0,t),h.query=vf[l]||(vf[l]=new URLSearchParams(l))}return h.path=i,h}var Tv=Symbol(),U0=class{constructor(i){this.router=i,this.fullPath="",this[Fs]={},this[Ml]=new vv,this[Ml].path=""}route(i){var h;return(h=this[Fs])[i]||(h[i]=new zv(this.router,i,this))}match(){return this[Ml]}resolve(i){return"/"}},yv=U0;(()=>{y(U0,Tv,"RootRoute",16)})();var Nv=Symbol(),yu=class{constructor(i,h,t){this.parent=t||i.rootRoute,this.router=i,this.status=200,this.path=h,this[nv]=Symbol(),this[wf]={},this[Fs]={}}route(i){var h;return(h=this[Fs])[i]||(h[i]=new yu(this.router,i,this))}get fullPath(){return""+this.parent.fullPath+"/"+this.$path}load(i){return this.router.queue.add(i)}set path(i){var h=this;if(this.$path==i)return;if(this.raw=i,this.$path=i,this.groups=[],this.cache={},this.dynamic=!1,i.indexOf("?")>=0){let s=i.split("?");i=s.shift(),this.query={};for(let l=0,u=df(s.join("?").split("&")),e=u.length;l<e;l++){let r=u[l];if(!r)continue;let[f,m]=r.split("=");f[0]=="!"&&(this.dynamic=!0,f=f.slice(1),m=!1),m===""&&(m=!1),m&&m[0]==":"&&(this.dynamic=!0),this.query[f]=m||m!==!1}}if(i=i.replace(/\:(\w+|\*)(\.)?/g,function(s,l,u){h.dynamic=!0,l!="*"&&h.groups.push(l);let e=h.router.matchers[l]||(u?"([^/#.?]+)":"([^/#?]+)");return u?""+e+".":e}),i==""&&this.query)return;if(i=="*")return this.regex=Sv,this;i="^"+i;let t=i[i.length-1];(t=="$"||t=="/")&&(i=i.slice(0,-1)+"(?=/?[#?]|/?$)"),t!="/"&&t!="$"&&i!="^/"&&(i=i+"(?=[/#?]|$)"),this.regex=new RegExp(i)}match(i=this.router.path){var h,t,s;let l,u=this.parent.match(i);if(!u)return null;let e=Ev(i),r=e.url,f="";if(u.path&&e.path.indexOf(u.path)==0&&(f=u.path+"/",r=r.slice(f.length)),l=this.regex?r.match(this.regex):[""]){let m=f+l[0],n=[this.$path],S={};if(this.groups.length)for(let b=0,w=df(l),T=w.length,E;b<T;b++){let N=w[b];(E=this.groups[b-1])&&(S[E]=N,n.push(N))}if(this.query)for(let b=this.query,w=0,T=Object.keys(b),E=T.length,N,z;w<E;w++){N=T[w],z=b[N];let F=N,O=(t=(h=e.query)==null?void 0:h.get)==null?void 0:t.call(h,N);if(z===!1){if(O)return null;n.push("1");continue}if(z[0]==":"&&(F=z.slice(1),z=!0),z==!0&&O||z==O)S[F]=O,n.push(O);else return null}let d=n.join("*");S=(s=this[wf])[d]||(s[d]=S);let v=dv(u,S);return v.path=m,v}return null}resolve(i=this.router.path){if(this.raw[0]=="/"&&!this.dynamic)return this.raw.replace(/\$/g,"");let h=this.parent.match(i),t=this.parent.resolve(i),s;if(this.dynamic){let l=this.match(i);return l?l.path:null}return this.raw[0]=="?"?s=(t||"/")+this.raw:s=t+"/"+this.raw,s.replace(/\$/g,"").replace(/\/\/+/g,"/")}},zv=yu;(()=>{y(yu,Nv,"Route",16)})();function q0(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}var tu=Symbol.for("#enter"),su=Symbol.for("#resolved"),Os=Symbol.for("#leave"),Ef=Symbol.for("#afterVisitRouted"),Tf=Symbol.for("#afterVisitRouteTo"),Qh=Symbol.for("#doc"),Vi=Symbol.for("#version"),Fv=Symbol.for("#routes"),yf=Symbol.for("#origin"),Pl=Symbol.for("#request"),it=Symbol.for("#hash"),di=Symbol.for("#routeTo"),ht=Symbol.for("#path"),Hi=Symbol.for("#match"),nt=Symbol.for("#options"),Ov=Symbol.for("#cache"),Nf=Symbol.for("#unmatched"),Ii=Symbol.for("#active"),Lv=Symbol.for("#resolvedPath"),Kv=Symbol.for("#dataKey"),Gv=Symbol.for("#activeKey"),St=Symbol.for("#urlKey"),Zh=Symbol.for("#dataMap"),gh=Symbol.for("#href"),I=Symbol.for("#route"),zf=Symbol.for("#context"),Ff=Symbol.for("#afterVisit"),Of=Symbol.for("#routeHandler"),Yv=Symbol.for("#parentNode"),Xv=Symbol.for("#visitContext"),Lf=Symbol.for("##visitContext"),Cv=Symbol.for("#attachToParent"),Hv=Symbol.for("#detachFromParent"),Kf=Symbol.for("#router");var GN=AS(function(){return globalThis.document.router}),Qv=Symbol(),P0=class extends Z{constructor(i,h={}){super(),this[Qh]=i,this[Vi]=0,this[Fv]={},this.aliases={},this.redirects={},this.rules={},this.matchers={},this.options=h,this.busy=[],this.queue=new ub,this.root=new yv(this),this.location=new ms(h.url||i.location.href,this),this.history=new fv(this),this.mode=h.mode||"history",this.queue.on("busy",function(){return globalThis.document.flags.incr("_routing_")}),this.queue.on("idle",function(){return globalThis.document.flags.decr("_routing_"),W()}),this.setup()}get origin(){return this[yf]||(this[yf]=this[Qh].location.origin)}get query(){return this.location.query}init(){return this.refresh({mode:"replace"}),this}alias(i,h){return this.aliases[i]=h,this.location.reparse(),this}touch(){return this[Vi]++}option(i,h){return h==null?this.options[i]:(this.options[i]=h,this)}get realpath(){let i=this[Qh].location;return i.href.slice(i.origin.length)}get state(){return this.history.state}get states(){return this.history.currentStates}set state(i){this.state.data=i,this.state.save()}get ctx(){return this[Pl]}pushState(i,h,t){return this.history.pushState(i,h||null,String(t))}replaceState(i,h,t){return this.history.replaceState(i,h||null,String(t))}refresh(i={}){var h=this;if(this.refreshing)return;this.refreshing=!0;let t=this.location,s=ms.parse(i.location||this.realpath,this),l=i.mode,u=this[Pl];if(!s.equals(t)||!u||i.state){let e=new bf(this,s,t,i);this[Pl]=e,this.emit("beforechange",e),e.aborted&&(!e.forceAbort&&globalThis.window.confirm("Are you sure you want to leave? You might have unsaved changes")?e.aborted=!1:l=="pop"?this.pushState(this.state,null,String(t)):l=="replace"&&this.replaceState(this.state,null,String(t))),e.aborted||(this.location=e.location,l=="push"?this.pushState(e.state,null,String(this.location)):l=="replace"?this.replaceState(e.state,null,String(this.location)):l=="pop"&&(this.history.index=i.index),this.refreshing=!1,this.emit("change",e),this.touch(),W())}return a.add(function(){let e=h[Qh].location.hash;if(e!=h[it])return h.emit("hashchange",h[it]=e)}),this.refreshing=!1,this}onpopstate(i){let h=this.history.index,t=h,s={pop:!0,index:0,from:h,mode:"pop"};try{if(typeof i.state=="string"){let[l,u]=i.state.split("|");t=s.index=parseInt(u),t<h?s.revert=this.history.slice(t+1,h+1).reverse():t>h&&(s.apply=this.history.slice(h+1,t+1))}}catch{}return this.refresh(s),this}onbeforeunload(i){let h=new bf(this,null,this.location,{mode:"unload"});if(this.emit("beforechange",h),h.aborted)return!0}onhashchange(i){return this.emit("hashchange",this[it]=this[Qh].location.hash),W()}setup(){this.onclick=this.onclick.bind(this),this.onhashchange=this.onhashchange.bind(this);let i=globalThis.window;return this[it]=this[Qh].location.hash,this.location=ms.parse(this.realpath,this),i.onpopstate=this.onpopstate.bind(this),i.onbeforeunload=this.onbeforeunload.bind(this),i.addEventListener("hashchange",this.onhashchange),i.addEventListener("click",this.onclick,{capture:!0}),i.document.documentElement.emit("routerinit",this),this.refresh,this}onclick(i){if(i.metaKey||i.altKey)return;let h=null,t=null,s=i.target;for(;s&&(!h||!t);)!h&&s.nodeName=="A"&&(h=s),!t&&s[di]&&(t=s),s=s.parentNode;if(h&&t!=h&&(!t||t.contains(h))){let l=h.getAttribute("href");l&&!l.match(/\:\/\//)&&(!h.getAttribute("target")||h.getAttribute("target")=="_self")&&!h.classList.contains("external")&&h.addEventListener("click",this.onclicklink.bind(this),{once:!0})}return!0}onclicklink(i){let h=i.currentTarget||i.target;h[di]&&h[di].resolve();let t=h.getAttribute("href"),s=new URL(h.href),l=s.href.slice(s.origin.length),u=this.realpath.split("#")[0],e=l.split("#")[0];return u==e?globalThis.document.location.hash=s.hash:h[di]?h[di].go():this.go(l),i.stopPropagation(),i.preventDefault()}get url(){return this.location.url}get path(){let i=this.location.path;return this.aliases[i]||i}get pathname(){return this.location.pathname}serializeParams(i){var h;if(q0(i,Object)){h=[];for(let t=0,s=Object.keys(i),l=s.length,u,e;t<l;t++)u=s[t],e=i[u],h.push([u,globalThis.encodeURI(e)].join("="));return h.join("&")}return i||""}get hash(){return this[it]}set hash(i){let h="#"+this.serializeParams(i);globalThis.history.replaceState(this.state,null,h)}match(i){return this.route(i).match(this.path)}route(i){return this.root.route(i)}go(i,h=null){if(typeof i=="object"&&h===null&&(h=i,i=this.path),typeof i=="number")return globalThis.history.go(i),this;let t=this.location.clone().update(i),s=this.history.buildState(h,t.path,!0);return this.refresh({push:!0,mode:"push",location:t,state:s,apply:[s]}),this}replace(i,h=null){typeof i=="object"&&h===null&&(h=i,i=this.path);let t=this.location.clone().update(i),s=this.history.buildState(h,t.path,!1);return this.refresh({replace:!0,mode:"replace",location:t,state:s,apply:[s]})}},Zv=P0;(()=>{y(P0,Qv,"Router",16)})();var gv=Symbol(),V0=class{constructor(i,h,t,s={}){this.parent=t,this.node=i,this[ht]=h,this[Hi]=null,this[nt]=s,this[Ov]={},this[Nf]={},this[Ii]=null,this[Lv]=null,this[Kv]=Symbol(),this[Gv]=Symbol(),this[St]=Symbol()}get router(){return this.node.ownerDocument.router}get route(){return(this.parent?this.parent.route:this.router).route(this[ht])}get match(){return this[Hi]}get params(){return this[Hi]||this[Nf]}get state(){let i=this[Zh]||(this[Zh]=new Map),h=this.params,t=this[Zh].get(h);return t||this[Zh].set(h,t={}),t}set state(i){(this[Zh]||(this[Zh]=new Map)).set(this.params,i)}set path(i){this[ht]!=i&&(this[ht]=i,!0)&&this.router.touch()}get path(){return this[ht]}get isActive(){return!!this[Ii]}get activeΦ(){return!!this[Ii]}resolve(){let i=this.router[Vi];if(!(this[Vi]!=i&&(this[Vi]=i,!0)))return;let h=this.route,t=this[nt],s=this.router.path,l=h.match(s),u=this[Ii],e=this[Hi],r=l!=e,f=l&&l[this[St]];return l&&(this[Ii]=!0,this[Hi]=l,l[this[St]]=s),l&&(r||f!=s||!u)&&this[su](l,e,f),!u&&l&&this[tu](),!l&&(u||u===null)&&(this[Ii]=!1,this[Os]()),this[Hi]}[tu](){var i,h;return this.node.flags.remove("not-routed"),this.node.flags.add("routed"),(h=(i=this.node)==null?void 0:i.routeDidEnter)==null?void 0:h.call(i,this)}[su](i,h,t=""){var s,l;return(l=(s=this.node)==null?void 0:s.routeDidResolve)==null?void 0:l.call(s,this,i,h,t)}[Os](){var i,h;return this.node.flags.add("not-routed"),this.node.flags.remove("routed"),(h=(i=this.node)==null?void 0:i.routeDidLeave)==null?void 0:h.call(i,this)}},j0=V0;(()=>{y(V0,gv,"ElementRoute",16)})();var Jv=Symbol(),A0=class extends j0{[tu](){return this}[su](){return this}[Os](){return this}resolve(){let i=this.router[Vi];if(!(this[Vi]!=i&&(this[Vi]=i,!0)))return;let h=this[nt],t=this.route,s=this.router.path,l=this.route.resolve(s),u=this.route.match(s);u&&(this[Hi]=u,this[Hi][this[St]]=s),h.sticky&&this[Hi]&&(l=this[Hi][this[St]]),this[gh]!=l&&(this[gh]=l,!0)&&this.node.nodeName=="A"&&this.node.setAttribute("href",l),this.node.flags.toggle("active",!!u)}get url(){return this.resolve(),globalThis.location.origin+this[gh]}go(){return this.resolve(),this[nt]&&this[nt].replace?this.router.replace(this[gh]):this.router.path==this[gh]?!0:this.router.go(this[gh])}},Wv=A0;(()=>{y(A0,Jv,"ElementRouteTo",0)})();var Bv=Symbol(),Rv=class{get router(){return this.ownerDocument.router}};(()=>{y(Rv,Bv,"Node",1,Node)})();var Mv=Symbol(),Uv=class{set route(i){if(i==null)return;if(this[I]){this[I].path=i;return}let h=i[0]!="/"?this[zf].route:null;this[I]=new j0(this,i,h,this.route__),this[Ff]=this[Ef]}get route(){return this[I]}set routeΞto(i){var h=this;if(i==null)return;if(this[di]){this[di].path=i;return}let t=i[0]!="/"?this[zf].route:null;this[I]=this[di]=new Wv(this,i,t,this.routeTo__),this[Ff]=this[Tf],this.onclick=function(s){if(!s.altKey&&!s.metaKey&&!s[Of])return s.preventDefault(),s[Of]=h[di],h[di].go()}}[Ef](){if(this[I]){let i=this[Yv],h=i&&i[Xv];if(h&&h.matchedRoute&&h.matchedRoute!=this[I]){this[I][Ii]!=!1&&(this[I][Ii]=!1,!0)&&(this[I][Os](),this[I][Vi]=-1);return}if(this[I].resolve(),this[I].activeΦ)h.matchedRoute=this[I];else return}if(this.visit&&this.visit(),this[Lf])return this[Lf]=null}[Tf](){if(this[di]&&this[di].resolve(),this.visit)return this.visit()}routeDidEnter(i){return this[Cv]()}routeDidLeave(i){return this[Hv]()}routeDidResolve(i,h,t){var s=this;q0(this.routed,Function)&&h!=t&&this.router.queue.add(async function(){s.suspend();let l=await s.routed(h,i.state,t);return s.unsuspend()})}};(()=>{y(Uv,Mv,"Element",1,Element)})();var qv=Symbol(),Pv=class{get router(){return this[Kf]||(this[Kf]=new Zv(this))}};(()=>{y(Pv,qv,"Document",1,Document)})();function Vl(i,h){var t;return typeof h=="string"?typeof i===h:(t=h[Symbol.hasInstance])==null?void 0:t.call(h,i)}function Ei(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var Zs=Symbol.for("##reactive"),wh=Symbol.for("##referenced"),Et=Symbol.for("##dereferenced"),is=Symbol.for("#map"),Gf=Symbol.for("#__init__"),hs=Symbol.for("#child"),Vv=Symbol.for("##spy"),tt=Symbol.for("#reactions"),jl=Symbol.for("#promise"),B={TOUCHING:2,STALE:4,OBJECT:8,RUNNING:16,INVALIDATING:32,POSSIBLY_STALE:64,AUTORUN:128,DEACTIVATED:256},V=0,Yf=!1,lu=null,jv=0,x0=1,Nu={META:new Map,VALUE:new Map,REF:new Map},gi,ns={root:null,ctx:null,get context(){return Q},get atomics(){return lu},get ownref(){return Ri},flush(){if(Q==gi)return gi.flush()}},Ri=Symbol.for("~"),D0=Symbol.for("~~"),zu=function(i,h){return h.has(i)||h.set(i,Symbol()),h.get(i)},Fu=function(i){return typeof i=="symbol"?zu(i,Nu.VALUE):Symbol.for(i)},Av=function(i){return typeof i=="symbol"?zu(i,Nu.META):Symbol.for("#"+i+"__")},Ou=function(i){return typeof i=="symbol"?zu(i,Nu.REF):Symbol.for("~"+i)},P=function(i,h){return V&&Q.add(i[Ri]),h},wi=function(i,h){return i[Ri].$$invalidated(0),h},Uh=function(i,h,t){let s=i[Ri];return s||(s=i[Ri]=new o0,Object.defineProperties(i,t)),h&&s.addSubscriber(h),i},Lu=function(i,h){let t=i[Ri];return t&&t.removeSubscriber(h),i},xv=Symbol(),p0=class{constructor(i){this.changes=new Map,this.cleanup(),i&&this.reset(i)}reset(i=[]){return this.array=i,this.initialLength=i.length}cleanup(){return this.idx=0,this.array=null,this.changes.clear(),this.dirty=!1}push(i){if(this.initialLength==0){this.array.indexOf(i)<0&&(this.changes.set(i,1),this.array.push(i),this.idx++);return}let h=this.idx,t=this.array[h];if(t===i)++this.idx;else{if(h>0&&this.array[h-1]===i)return;let s=this.array.indexOf(i),l=this.changes.get(i);if(s===-1)this.array.splice(h,0,i),this.changes.set(i,1),this.idx++;else{if(s<h)return;s===h+1?(t&&this.changes.set(t,-1),this.array.splice(h,1),++this.idx):(s>h&&this.array.splice(s,1),this.array.splice(h,0,i))}l==-1&&this.changes.delete(i)}}end(){if(this.array.length>=this.idx)for(;this.array.length>this.idx;)this.changes.set(this.array.pop(),-1);return this.array}patch(){return this.end()}},Dv=p0;(()=>{y(p0,xv,"ArrayPatcher",16)})();function Ku(i){var h,t;let s=Object.getOwnPropertyDescriptors(i.prototype);return h=s.name,delete s.name,t=s.constructor,delete s.constructor,s}function pv(){if(Yf!=!0&&(Yf=!0,!0))return Gs.on("inited",function(i){let h=i[D0];if(h){let t=globalThis.Node&&Vl(i,globalThis.Node),s=i[Ri]||(i[Ri]={});for(let l=0,u=Object.keys(h),e=u.length,r,f;l<e;l++){r=u[l],f=h[r];let m=s[r]=new Ss(i[r],i,f);t||m.call()}t&&(hh(i,"mount",function(){for(let l=0,u=Ei(Object.values(s)),e=u.length;l<e;l++){let r=u[l];Vl(r,Ss)&&r.activate()}}),hh(i,"unmount",function(){for(let l=0,u=Ei(Object.values(s)),e=u.length;l<e;l++){let r=u[l];Vl(r,Ss)&&r.deactivate()}}))}})}function _v(i,h=D0){return i.hasOwnProperty(h)||(i[h]=Object.assign({},i[h]||{})),i[h]}var kv=Symbol(),Gu=class{constructor(i,h=0){this.depth=h,this.parent=i,this.target=null,this.spy=null,this.patcher=new Dv}get activeΦ(){return Q==this}get rootΦ(){return this==gi}get snapshot(){let i=[],h=this[hs];for(;h&&h.target;)i.push({depth:h.depth,target:h.target,beacon:h.beacon}),h=h[hs];return i}reset(i){var h,t;this.target=i,this.beacon=i.beacon;let s=this.spy=i[Vv];return this.tracking=s&&(h=s.tracking)!=null?h:!0,this.patcher.reset(i.observing||(i.observing=[])),s&&((t=s==null?void 0:s.enter)==null||t.call(s,this)),this}add(i,h){var t,s;this.tracking&&i&&this.beacon&&this.patcher.push(i),this.spy&&((s=(t=this.spy)==null?void 0:t.observed)==null||s.call(t,this,i,h))}react(i){var h,t;return this.spy&&((t=(h=this.spy)==null?void 0:h.react)==null||t.call(h,this,i)),gi.reactions.add(i)}push(i){return ns.ctx=Q=this.child.reset(i)}pop(){var i,h;let t=null;if(this.beacon){t=this.patcher.end();let s=this.patcher.changes;if(s.size)for(let[l,u]of Ei(s))u===1?l.addSubscriber(this.beacon):l.removeSubscriber(this.beacon)}return this.spy&&((h=(i=this.spy)==null?void 0:i.leave)==null||h.call(i,this)),this.patcher.cleanup(),this.target=this.beacon=null,Q=this.parent,Q==gi?(gi.flush(),ns.ctx=null):ns.ctx=Q,t}get child(){return this[hs]||(this[hs]=new Gu(this,this.depth+1))}get reactions(){return this[tt]||(this[tt]=new Set)}flush(){if(!this[tt])return;let i=this[tt];this[tt]=null;for(let h of Ei(i))h.call()}},$v=Gu;(()=>{y(Gu,kv,"Context",16)})();var av=Symbol(),_0=class extends $v{add(){return!0}},ov=_0;(()=>{y(_0,av,"Root",0)})();var Q=gi=ns.root=new ov(null,0),cv=function(){return Q.tracking=!1},k0=function(i,h,t,s,l){let u=i[t],e=i[l];return e||(e=i[l]=new o0(s,h,u)),Q.add(e,i),u},$0=function(i,h,t,s,l,u){let e=i[t];if(s!=e){i[t]=s;let r=i[u];r&&r.changed(0,s,e)}},Iv=Symbol(),a0=class{constructor(i,h,t){return this.id=x0++,this.observer=null,this.observers=null,this.v=0,this.o=i||null,t&&t[wh]&&t[wh](this),this}get $$v(){return this.v}changed(i,h,t){if(jv++,this.v++,t&&t[Et]&&t[Et](this,h),h&&h[wh]&&h[wh](this,t),this.observer&&this.observer.$$invalidated(i+1,this,h,t),this.observers)for(let s of Ei(this.observers))s.$$invalidated(i+1,this,h,t);Q==gi&&Q.flush()}invalidated(i,h){return console.warn("Ref.invalidated is deprecated - use $$invalidated"),this.$$invalidated(i,h)}$$invalidated(i,h){if(lu)return lu.add(this),!0;if(this.v++,i>30){console.warn("Ref observer chain too deep",this,h);return}if(this.observer&&this.observer.$$invalidated(i+1,this),this.observers)for(let t of Ei(this.observers))t.$$invalidated(i+1,this);return i==0&&Q==gi&&Q.flush(),!0}addSubscriber(i){this.observer?(this.observers||(this.observers=new Set),this.observers.add(i)):this.observer=i}removeSubscriber(i){this.observer==i&&(this.observer=null);let h=this.observers;h&&h.delete(i)}reportChanged(){return this.changed(0)}reportObserved(i){return Q.add(this,i)}},o0=a0;(()=>{y(a0,Iv,"Ref",16)})();var iE=Symbol(),c0=class extends Array{push(){return wi(this,super.push(...arguments))}pop(){return wi(this,super.pop(...arguments))}unshift(){return wi(this,super.unshift(...arguments))}shift(){return wi(this,super.shift(...arguments))}splice(){return wi(this,super.splice(...arguments))}at(){return P(this,super.at(...arguments))}map(){return P(this,super.map(...arguments))}flatMap(){return P(this,super.flatMap(...arguments))}flat(){return P(this,super.flat(...arguments))}filter(){return P(this,super.filter(...arguments))}find(){return P(this,super.find(...arguments))}slice(){return P(this,super.slice(...arguments))}sort(){return P(this,super.sort(...arguments))}get len(){return P(this,this.length)}set len(i){this.length=i,wi(this)}toIterable(){return V&&Q.add(this[Ri]),this}[Symbol.iterator](){return P(this,super[Symbol.iterator](...arguments))}},hE=c0;(()=>{y(c0,iE,"ObservableArray",8)})();var Xf=Ku(hE),tE=Symbol(),sE=class{get len(){return this.length}set len(i){this.length=i}get[Zs](){return Uh(this,null,Xf)}[wh](i){return Uh(this,i,Xf)}[Et](i){return Lu(this,i)}};(()=>{y(sE,tE,"Array",1,Array)})();var Cf=Set.prototype.has,lE=Symbol(),I0=class extends Set{has(){return P(this,super.has(...arguments))}keys(){return P(this,super.keys(...arguments))}values(){return P(this,super.values(...arguments))}entries(){return P(this,super.entries(...arguments))}add(i){return Cf.call(this,i)?this:wi(this,super.add(...arguments))}delete(i){return Cf.call(this,i)?wi(this,super.delete(...arguments)):this}clear(){return this.size?wi(this,super.clear(...arguments)):this}},uE=I0;(()=>{y(I0,lE,"ObservableSet",8)})();var Hf=Ku(uE),eE=Symbol(),rE=class{get[Zs](){return Uh(this,null,Hf)}[wh](i){return Uh(this,i,Hf)}[Et](i){return Lu(this,i)}};(()=>{y(rE,eE,"Set",1,Set)})();var fE=Symbol(),im=class extends Map{get(){return P(this,super.get(...arguments))}has(){return P(this,super.has(...arguments))}keys(){return P(this,super.keys(...arguments))}values(){return P(this,super.values(...arguments))}entries(){return P(this,super.entries(...arguments))}set(){return wi(this,super.set(...arguments))}clear(){return wi(this,super.clear(...arguments))}delete(){return wi(this,super.delete(...arguments))}},mE=im;(()=>{y(im,fE,"ObservableMap",8)})();var Qf=Ku(mE),nE=Symbol(),SE=class{get[Zs](){return Uh(this,null,Qf)}[wh](i){return Uh(this,i,Qf)}[Et](i){return Lu(this,i)}};(()=>{y(SE,nE,"Map",1,Map)})();var bE=Symbol(),hm=class{constructor(i,h={}){var t,s=this;this.name=i,this.options=h;let l=this.key=Fu(i),u=Ou(i),e=this.descriptor={enumerable:(t=h.enumerable)!=null?t:!0,configurable:!1,get:function(){return V?k0(this,i,l,s,u):this[l]},set:function(f){return V||!!this[u]?$0(this,i,l,f,s,u):this[l]=f}},r=this.lazyDescriptor={enumerable:!1,configurable:!0,get:function(){return V?(Object.defineProperty(this,i,e),this[i]):this[l]},set:function(f){return this[l]=f,this[u]=null,Object.defineProperty(this,i,e)}}}},dE=hm;(()=>{y(hm,bE,"PropertyType",16)})();var wE=Symbol(),tm=class{constructor(i=null){this[Gf](i)}[Gf](i=null,h=!0,t=!0){var s;this[is]=i&&(s=i[is])!==void 0?s:new Map}for(i){let h=this[is].get(i);return h||this[is].set(i,h=[]),h}get(i){let h=this.for(i);return h[Ri]||h[Zs],V&&P(h),h}add(i,h){return this.for(i).push(h)}delete(i,h){let t=this.for(i),s=t.indexOf(h);t.splice(s,1)}},vE=tm;(()=>{y(tm,wE,"RefIndex",16)})();var EE=Symbol(),TE=class{constructor(i,h){var t=this;this.name=i,this.key=h,this.index=new vE;let s=Ou(i),l=this.descriptor={enumerable:!0,configurable:!1,get:function(){return V?k0(this,i,h,t,s):this[h]},set:function(e){let r=this[h];if(V||!!this[s]?$0(this,i,h,e,t,s):this[h]=e,r!=e&&(r&&t.index.delete(r,this),e))return t.index.add(e,this)}},u=this.lazyDescriptor={set:function(e){return this[h]=e,e&&t.index.add(e,this),Object.defineProperty(this,i,l),this[s]=null}}}where(i){return this.index.get(i)}};(()=>{y(TE,EE,"RefType",16)})();var yE=Symbol(),sm=class{constructor(i,h,t,s){this.observing=null,this.observers=null,this.flags=68,this.target=i,this.func=h,this.vkey=t,this.type=s,this.v=0}get beacon(){return this}addSubscriber(i){if(i==this){console.warn("@computed depends on itself");return}this.observer?(this.observers||(this.observers=[]),this.observers.push(i)):this.observer=i}removeSubscriber(i){if(this.observer==i)return this.observer=null;let h=this.observers,t=h?h.indexOf(i):-1;t>=0&&h.splice(t,1)}$$invalidated(i,h){if(this.flags|=B.STALE|B.POSSIBLY_STALE,i>40){console.warn("Memo invalidated observer chain too deep",this,h);return}if(this.observer&&this.observer.$$invalidated(i+1,this),!!this.observers){for(let t=0,s=Ei(this.observers),l=s.length;t<l;t++)s[t].$$invalidated(i+1,this);return this}}deactivate(){if(this.observing)for(let i=0,h=Ei(this.observing),t=h.length;i<t;i++)h[i].removeSubscriber(this);return this.observing=null,this}value(){if(V&&Q.add(this),(this.flags&B.POSSIBLY_STALE)==0)return this.target[this.vkey];V++,this.flags|=B.RUNNING,Q.push(this);let i=this.func.call(this.target);Q.pop(this);let h=this.target[this.vkey],t=!1;if(i&&h&&i.constructor===h.constructor&&i instanceof Array){let s=i.length;if(s!=h.length)t=!0;else{let l=0;for(;l<s;){if(i[l]!=h[l]){t=!0;break}l++}}}else t=i!==h;return this.target[this.vkey]=i,this.flags&=~(B.STALE|B.POSSIBLY_STALE|B.RUNNING),t&&this.v++,V--,i}},Ls=sm;(()=>{y(sm,yE,"Memo",16)})();var NE=Symbol(),zE=class{constructor(i,h){var t=this;this.name=i;let s=Ou(i),l=Fu(i),u=this.descriptor={enumerable:!1,configurable:!1,get:function(){return this[s].value()}},e=this.lazyDescriptor={enumerable:!1,configurable:!0,get:function(){let r=this[s]=new Ls(this,h,l,t.type);return Object.defineProperty(this,i,u),r.value()}}}};(()=>{y(zE,NE,"ComputedType",16)})();var FE=Symbol(),lm=class{get beacon(){return this}constructor(i,h,t={}){this.cb=i,this.context=h,this.options=t,this.flags=0,this.id=x0++,this.cachedComputedVersions=new WeakMap,this.checkComputedValues=new Set,this.observing=[],this.timeout=null}get runningΦ(){return this.flags&B.RUNNING}$$invalidated(i,h){var t,s;h instanceof Ls?(this.flags|=B.POSSIBLY_STALE,(s=(t=this.checkComputedValues)==null?void 0:t.add)==null||s.call(t,h)):this.flags|=B.STALE,this.observing&&Q.react(this)}activate(){return this.observing=[],this.cachedComputedVersions=new WeakMap,this.checkComputedValues=new Set,this.call(),this}deactivate(){if(this.timeout&&clearTimeout(this.timeout),this.observing)for(let i=0,h=Ei(this.observing),t=h.length;i<t;i++)h[i].removeSubscriber(this);return this.observing=this.checkComputedValues=this.cachedComputedVersions=null,this}call(){var i=this;if(V&&console.warn("should not call reaction inside an autorunning context?",gi.snapshot,this),this.flags&B.POSSIBLY_STALE&&(this.flags&B.STALE)==0){let h=!1;for(let t of Ei(this.checkComputedValues)){let s=this.cachedComputedVersions.get(t);t.value();let l=t.v;if(s!=l){h=!0;break}}if(!h){this.flags&=~B.POSSIBLY_STALE,this.checkComputedValues.clear();return}}if(this.options.delay){clearTimeout(this.timeout);let h=this.options.delay;typeof h!="number"&&(h=1000),this.timeout=setTimeout(function(){return i.run()},h);return}return this.run()}run(){V++,this.flags|=B.RUNNING;let i=Q.push(this),h=this.cb.call(this.context,cv),t=Q.pop(this);this.observing=t,this.checkComputedValues.clear();for(let s=0,l=Ei(t),u=l.length;s<u;s++){let e=l[s];e instanceof Ls&&this.cachedComputedVersions.set(e,e.v)}return this.flags&=~(B.RUNNING|B.STALE|B.POSSIBLY_STALE),V--,this.options.silent||W(),h}dispose(){return this.deactivate(),this.cb=this.context=this.options=null,this}},Ss=lm;(()=>{y(lm,FE,"Reaction",16)})();var OE=Symbol(),LE=class extends Ss{resolve(i){return this.deactivate(),this.resolved=i}then(...i){var h=this;return this.resolved!==void 0?Promise.resolve(this.resolved).then(...i):(this[jl]||(this[jl]=new Promise(function(t){return h.resolve=function(s){return h.deactivate(),h.resolved=s,t(s)}})),this[jl].then(...i))}run(){V++,this.flags|=B.RUNNING;let i=Q.push(this),h=this.cb.call(this.context),t=Q.pop(this);this.observing=t,this.checkComputedValues.clear();for(let s=0,l=Ei(t),u=l.length;s<u;s++){let e=l[s];e instanceof Ls&&this.cachedComputedVersions.set(e,e.v)}return this.flags&=~(B.RUNNING|B.STALE|B.POSSIBLY_STALE),V--,h!=!1&&h!=null&&h!=null&&(this.resolve(h),this.options.silent||W()),h}};(()=>{y(LE,OE,"Awaits",0)})();var KE=Symbol(),GE=class{constructor(i,h){this.scope=h,this.cb=i}get ctx(){return Q}run(i=this.scope,h=[],t=!1){Q.push(this);try{t&&V++;let s=this.cb.apply(i,h);return t&&V--,Q.pop(this),s}catch(s){throw t&&V--,Q.pop(this),s}}};(()=>{y(GE,KE,"Action",16)})();function Yu(i,h,t){let s=Av(h),l=Fu(h),u=this[0]||{},e=i[s]=new dE(h,u);return t?(Object.defineProperty(i,l,Object.assign({},t)),e.lazyDescriptor):(Object.defineProperty(i,h,e.lazyDescriptor),null)}function um(i,h,t){let s=_v(i),l=this[0]||{};return l.flags=B.AUTORUN,pv(),s[h]=l,t}function YE(i){let h;return i&&((h=i.toIterable)?h.call(i):i)}var Zf=Symbol.for("#__init__"),ts=Symbol.for("#watchers");var XE=Symbol(),CE=class{constructor(i=null){this[Zf](i)}[Zf](i=null,h=!0,t=!0){var s;this.local=i&&(s=i.local)!==void 0?s:!1,this.session=i&&(s=i.session)!==void 0?s:!1,this.weak=i&&(s=i.weak)!==void 0?s:!1}watch(i){return(this[ts]||(this[ts]=[])).push(i)}$get(i,h){return i[h]}$set(i,h,t,s){if(this[ts]){let l=this.$get(h,t,s);if(l!=i){h[t]=i;for(let u=0,e=YE(this[ts]),r=e.length;u<r;u++){let f=e[u].call(h,i,l,this)}}}else h[t]=i}$accessor(i,h,t,s,l){return l[s]=this}};(()=>{y(CE,XE,"Accessor",16)})();function Nt(i,h){return HE(i[Object.keys(i)[0]],"",h)}function Js(i,h){var t;if(!h||!h.length)return;t=[];for(let s=0,l=ki(i),u=l.length;s<u;s++){let e=l[s];t.push(gs(e,h))}return t}function HE(i,h="",t=[]){var s;for(let l=0,u=Object.keys(i),e=u.length,r,f;l<e;l++)if(r=u[l],f=i[r],r=="$"&&f?.fold?.length){for(let m=0,n=ki(f.fold),S=n.length;m<S;m++){let d=n[m];t.push(""+h+"."+d)}s=f.fold,delete f.fold}else if(r!="$")t=t.concat(Nt(f,""+h+"."+r));return t}function gs(i,h,t=""){var s,l,u;l=[];for(let e=0,r=Object.keys(i),f=r.length,m,n;e<f;e++){if(m=r[e],n=i[m],m=="$")continue;let S=""+t+"."+m;if(h.indexOf(S)!=-1)l.push(n?.length==1?(i[m]=n[0],H(n[0],Object)&&gs(n[0],h,S)):n?.length>1?console.log("InstantDB: seems that ["+S+"] is not a one-to-one relation."):(u=i[m],delete i[m],u));else if(H(n,Array)){s=[];for(let d=0,v=ki(n),b=v.length;d<b;d++){let w=v[d];if(!H(w,Object))continue;s.push(gs(w,h,S))}l.push(s)}else l.push(H(n,Object)&&gs(n,h,S))}return l}async function Ws(i,h,t,s,l=!1,u=!0){if(!i||!h)return;if(!Object.keys(h).length)return console.log("InstantDB Error: empty query."),!1;else if(Object.keys(h).length>1)return console.log("InstantDB Error: query has several root keys."),!1;let e=Object.keys(h)[0],r=[],f=[];try{if(u)Nt(h,f);if(r=l?(await i.query(h))[e]:(await i.queryOnce(h)).data[e],u)Js(r,f);if(H(t,Function))t(r)}catch(m){if(H(s,Function))s(m)}return r}function em(i,h,t){if(h.action=="create")h.id=t();if(h.data||={},!h.action)console.log("Inner error: for DB transaction no action was provided");else if(!h.table)console.log("Inner error: for DB transaction ("+h.action+") no table was provided");else if(!h.id)console.log("Inner error: for DB transaction ("+h.action+") no record ID was provided");else if(h.action=="link"&&(!h.links||!Object.keys(h.links).length))console.log("Inner error: for DB transaction (link) no links were provided");else{let s=i.tx[h.table][h.id];if(h.secret)s=s.ruleParams({knownDocId:h.secret});if(h.action=="create")s=s.update(h.data);if(h.action=="update")s=s.merge(h.data);if(h.action=="delete")s=s.delete();if(h.links&&Object.keys(h.links).length&&Je(h.action,["create","update","link"]))s=s.link(h.links);if(h.links&&Object.keys(h.links).length&&h.action=="unlink")s=s.unlink(h.links);return s}return}async function Bs(i,h,t,s,l){if(!i||!h||!H(l,Function))return;let u=h;if(H(u,Array))for(let e=0,r=ki(u),f=r.length;e<f;e++){let m=r[e];m=em(i,m,l)}else u=em(i,u,l);try{let e=await i.transact(u);if(H(t,Function))t(e);return!0}catch(e){if(H(s,Function))s(e);return!1}}var rm=Symbol();class Rs{[q](i=null,h=!0,t=!0){this.connection=i?i.connection:void 0}constructor(i){this[q](),this.connection=i,$i(this,rm)}listen(i={onupdate:void 0,onerror:void 0}){return this.connection.subscribeAuth(function(h){if(h.error){if(H(i.onupdate,Function))i.onupdate(null);if(H(i.onerror,Function))return i.onerror(h.error.message)}else if(!h.user){if(H(i.onupdate,Function))return i.onupdate(null)}else if(h.user){if(H(i.onupdate,Function))return i.onupdate(h.user)}else return console.log("Instant DB Error: something went wrong during listening for auth")})}async code(i={email:"",onsuccess:void 0,onerror:void 0}){if(!i.email){if(H(i.onerror,Function))i.onerror();else console.log("Instant DB Error: empty email for sending a code");return!1}try{let h=await this.connection.auth.sendMagicCode({email:i.email});if(H(i.onsuccess,Function))i.onsuccess(h);return!0}catch(h){if(H(i.onerror,Function))i.onerror(h);return!1}}async login(i={email:"",code:"",onsuccess:void 0,onerror:void 0}){if(!i.email||!i.code){if(H(i.onerror,Function))i.onerror();else console.log("Instant DB Error: empty email or code while login");return!1}try{if(await this.connection.auth.signInWithMagicCode({email:i.email,code:i.code}),H(i.onsuccess,Function))i.onsuccess();return!0}catch(h){if(H(i.onerror,Function))i.onerror(h);return!1}}async logout(i={onerror:void 0,onsuccess:void 0}){try{if(await this.connection.auth.signOut(),H(i.onsuccess,Function))i.onsuccess();return!0}catch(h){if(H(i.onerror,Function))i.onerror(h);return!1}}static{zi(this,rm,"Auth",16)}}var fm=Symbol();class QE{[q](i=null,h=!0,t=!0){var s;this.folding=i&&(s=i.folding)!==void 0?s:!0,this.uid=i?i.uid:void 0,this.connection=i?i.connection:void 0}constructor(i,h){this[q](),this.connection=i,this.uid=h,$i(this,fm)}async read(i={query:{},onsuccess:void 0,onerror:void 0}){return await Ws(this.connection,i.query,i.onsuccess,i.onerror,!0,this.folding)}async write(i={records:void 0,onsuccess:void 0,onerror:void 0}){return await Bs(this.connection,i.records,i.onsuccess,i.onerror,this.uid)}static{zi(this,fm,"ServerIDB",16)}}var mm=Symbol();class nm{[q](i=null,h=!0,t=!0){var s;this.folding=i&&(s=i.folding)!==void 0?s:!0,this.connection=i?i.connection:void 0,this.uid=i?i.uid:void 0,this.auth=i?i.auth:void 0,this.subscriptions=i&&(s=i.subscriptions)!==void 0?s:{}}constructor(i,h){this[q](),this.connection=i,this.uid=h,this.auth=new Rs(this.connection,this.uid),$i(this,mm)}async read(i={query:{},onsuccess:void 0,onerror:void 0}){return await Ws(this.connection,i.query,i.onsuccess,i.onerror,!1,this.folding)}async write(i={records:void 0,onsuccess:void 0,onerror:void 0}){return await Bs(this.connection,i.records,i.onsuccess,i.onerror,this.uid)}subscribe(i={name:"",query:{},onupdate:void 0,onerror:void 0}){if(this.subscriptions[i.name])this.subscriptions[i.name]();let h=[];return Nt(i.query,h),this.subscriptions[i.name]=this.connection.subscribeQuery(i.query,function(t){if(t.error){if(H(i.onerror,Function))return i.onerror(t.error.message)}else if(Js(t.data,h),H(i.onupdate,Function))return i.onupdate(t.data)})}static{zi(this,mm,"ClientIDB",16)}}class zt{constructor(i,h,t=""){this.attributes=i,this.content=h,this.flags=t}adoptNode(i){for(let[h,t]of Object.entries(this.attributes))i.setAttribute(h,t);i.innerHTML=this.content}}var Sm=new zt({viewBox:"0 0 256 256"},'<path d="M216,83.31V208a8,8,0,0,1-8,8H48a8,8,0,0,1-8-8V48a8,8,0,0,1,8-8H172.69a8,8,0,0,1,5.65,2.34l35.32,35.32A8,8,0,0,1,216,83.31Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M80,216V152a8,8,0,0,1,8-8h80a8,8,0,0,1,8,8v64" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="152" y1="72" x2="96" y2="72" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>',"phosphor");var bm=new zt({viewBox:"0 0 256 256"},'<path d="M92.69,216H48a8,8,0,0,1-8-8V163.31a8,8,0,0,1,2.34-5.65L165.66,34.34a8,8,0,0,1,11.31,0L221.66,79a8,8,0,0,1,0,11.31L98.34,213.66A8,8,0,0,1,92.69,216Z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="136" y1="64" x2="192" y2="120" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="164" y1="92" x2="68" y2="188" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="95.49" y1="215.49" x2="40.51" y2="160.51" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>',"phosphor");var dm=new zt({viewBox:"0 0 256 256"},'<line x1="40" y1="128" x2="216" y2="128" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="128" y1="40" x2="128" y2="216" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>',"phosphor");var wm=new zt({viewBox:"0 0 256 256"},'<line x1="216" y1="56" x2="40" y2="56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="104" y1="104" x2="104" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><line x1="152" y1="104" x2="152" y2="168" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M200,56V208a8,8,0,0,1-8,8H64a8,8,0,0,1-8-8V56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/><path d="M168,56V40a16,16,0,0,0-16-16H104A16,16,0,0,0,88,40V56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="16"/>',"phosphor");function o(i){if(typeof i==="number")return(Math.abs(i*2654435761)>>>0).toString(16);if(typeof i==="boolean")return i?"1":"0";if(i===null)return"null";if(i===void 0)return"undefined";if(typeof i==="string"){let h=2166136261;for(let t=0;t<i.length;t++)h^=i.charCodeAt(t),h+=(h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24),h=h>>>0;return h.toString(16)}if(Array.isArray(i)){let h=2166136261;for(let t=0;t<i.length;t++){h^=(t+1)*2654435761;let s=o(i[t]);for(let l=0;l<s.length;l++)h^=s.charCodeAt(l),h*=16777619,h=h>>>0}return h.toString(16)}if(typeof i==="object"){let h=2166136261,t=Object.keys(i).sort();for(let s=0;s<t.length;s++){let l=t[s],u=o(l);h^=parseInt(u,16),h*=16777619,h=h>>>0;let e=o(i[l]);h^=parseInt(e,16),h*=16777619,h=h>>>0}return h.toString(16)}return o(String(i))}var R={Remove:"remove",Replace:"replace",Add:"add"},Nm=Symbol.for("__MUTATIVE_PROXY_DRAFT__"),gE=Symbol("__MUTATIVE_RAW_RETURN_SYMBOL__"),Ms=Symbol.iterator,fi={mutable:"mutable",immutable:"immutable"},Ju={};function Ot(i,h){return i instanceof Map?i.has(h):Object.prototype.hasOwnProperty.call(i,h)}function vm(i,h){if(h in i){let t=Reflect.getPrototypeOf(i);while(t){let s=Reflect.getOwnPropertyDescriptor(t,h);if(s)return s;t=Reflect.getPrototypeOf(t)}}return}function Wu(i){return Object.getPrototypeOf(i)===Set.prototype}function Bu(i){return Object.getPrototypeOf(i)===Map.prototype}function ri(i){var h;return(h=i.copy)!==null&&h!==void 0?h:i.original}function Eh(i){return!!X(i)}function X(i){if(typeof i!=="object")return null;return i===null||i===void 0?void 0:i[Nm]}function Ru(i){var h;let t=X(i);return t?(h=t.copy)!==null&&h!==void 0?h:t.original:i}function Oi(i,h){if(!i||typeof i!=="object")return!1;let t;return Object.getPrototypeOf(i)===Object.prototype||Array.isArray(i)||i instanceof Map||i instanceof Set||!!(h===null||h===void 0?void 0:h.mark)&&((t=h.mark(i,fi))===fi.immutable||typeof t==="function")}function zm(i,h=[]){if(Object.hasOwnProperty.call(i,"key")){let t=i.parent.copy,s=X(Ai(t,i.key));if(s!==null&&(s===null||s===void 0?void 0:s.original)!==i.original)return null;let l=i.parent.type===3,u=l?Array.from(i.parent.setMap.keys()).indexOf(i.key):i.key;if(!(l&&t.size>u||Ot(t,u)))return null;h.push(u)}if(i.parent)return zm(i.parent,h);h.reverse();try{JE(i.copy,h)}catch(t){return null}return h}function Th(i){if(Array.isArray(i))return 1;if(i instanceof Map)return 2;if(i instanceof Set)return 3;return 0}function Ai(i,h){return Th(i)===2?i.get(h):i[h]}function Kt(i,h,t){if(Th(i)===2)i.set(h,t);else i[h]=t}function Xu(i,h){let t=X(i);return(t?ri(t):i)[h]}function ji(i,h){if(i===h)return i!==0||1/i===1/h;else return i!==i&&h!==h}function Cu(i){if(!i)return;while(i.finalities.revoke.length>0)i.finalities.revoke.pop()()}function vh(i,h){return h?i:[""].concat(i).map((t)=>{let s=`${t}`;if(s.indexOf("/")===-1&&s.indexOf("~")===-1)return s;return s.replace(/~/g,"~0").replace(/\//g,"~1")}).join("/")}function JE(i,h){for(let t=0;t<h.length-1;t+=1){let s=h[t];if(i=Ai(Th(i)===3?Array.from(i):i,s),typeof i!=="object")throw new Error(`Cannot resolve patch at '${h.join("/")}'.`)}return i}function WE(i){let h=Object.create(Object.getPrototypeOf(i));return Reflect.ownKeys(i).forEach((t)=>{let s=Reflect.getOwnPropertyDescriptor(i,t);if(s.enumerable&&s.configurable&&s.writable){h[t]=i[t];return}if(!s.writable)s.writable=!0,s.configurable=!0;if(s.get||s.set)s={configurable:!0,writable:!0,enumerable:s.enumerable,value:i[t]};Reflect.defineProperty(h,t,s)}),h}var BE=Object.prototype.propertyIsEnumerable;function Fm(i,h){let t;if(Array.isArray(i))return Array.prototype.concat.call(i);else if(i instanceof Set){if(!Wu(i))return new(Object.getPrototypeOf(i)).constructor(i.values());return Set.prototype.difference?Set.prototype.difference.call(i,new Set):new Set(i.values())}else if(i instanceof Map){if(!Bu(i))return new(Object.getPrototypeOf(i)).constructor(i);return new Map(i)}else if((h===null||h===void 0?void 0:h.mark)&&(t=h.mark(i,fi),t!==void 0)&&t!==fi.mutable){if(t===fi.immutable)return WE(i);else if(typeof t==="function"){if(h.enablePatches||h.enableAutoFreeze)throw new Error("You can't use mark and patches or auto freeze together.");return t()}throw new Error(`Unsupported mark result: ${t}`)}else if(typeof i==="object"&&Object.getPrototypeOf(i)===Object.prototype){let s={};return Object.keys(i).forEach((l)=>{s[l]=i[l]}),Object.getOwnPropertySymbols(i).forEach((l)=>{if(BE.call(i,l))s[l]=i[l]}),s}else throw new Error("Please check mark() to ensure that it is a stable marker draftable function.")}function c(i){if(i.copy)return;i.copy=Fm(i.original,i.options)}function Ft(i){if(!Oi(i))return Ru(i);if(Array.isArray(i))return i.map(Ft);if(i instanceof Map){let t=Array.from(i.entries()).map(([s,l])=>[s,Ft(l)]);if(!Bu(i))return new(Object.getPrototypeOf(i)).constructor(t);return new Map(t)}if(i instanceof Set){let t=Array.from(i).map(Ft);if(!Wu(i))return new(Object.getPrototypeOf(i)).constructor(t);return new Set(t)}let h=Object.create(Object.getPrototypeOf(i));for(let t in i)h[t]=Ft(i[t]);return h}function Us(i){return Eh(i)?Ft(i):i}function Mi(i){var h;if(i.assignedMap=(h=i.assignedMap)!==null&&h!==void 0?h:new Map,!i.operated){if(i.operated=!0,i.parent)Mi(i.parent)}}function Em(){throw new Error("Cannot modify frozen object")}function Ph(i,h,t,s,l){{t=t!==null&&t!==void 0?t:new WeakMap,s=s!==null&&s!==void 0?s:[],l=l!==null&&l!==void 0?l:[];let e=t.has(i)?t.get(i):i;if(s.length>0){let r=s.indexOf(e);if(e&&typeof e==="object"&&r!==-1){if(s[0]===e)throw new Error("Forbids circular reference");throw new Error(`Forbids circular reference: ~/${l.slice(0,r).map((f,m)=>{if(typeof f==="symbol")return`[${f.toString()}]`;let n=s[m];if(typeof f==="object"&&(n instanceof Map||n instanceof Set))return Array.from(n.keys()).indexOf(f);return f}).join("/")}`)}s.push(e),l.push(h)}else s.push(e)}if(Object.isFrozen(i)||Eh(i)){s.pop(),l.pop();return}switch(Th(i)){case 2:for(let[r,f]of i)Ph(r,r,t,s,l),Ph(f,r,t,s,l);i.set=i.clear=i.delete=Em;break;case 3:for(let r of i)Ph(r,r,t,s,l);i.add=i.clear=i.delete=Em;break;case 1:Object.freeze(i);let e=0;for(let r of i)Ph(r,e,t,s,l),e+=1;break;default:Object.freeze(i),Object.keys(i).forEach((r)=>{let f=i[r];Ph(f,r,t,s,l)})}s.pop(),l.pop()}function Mu(i,h){let t=Th(i);if(t===0)Reflect.ownKeys(i).forEach((s)=>{h(s,i[s],i)});else if(t===1){let s=0;for(let l of i)h(s,l,i),s+=1}else i.forEach((s,l)=>h(l,s,i))}function Om(i,h,t){if(Eh(i)||!Oi(i,t)||h.has(i)||Object.isFrozen(i))return;let s=i instanceof Set,l=s?new Map:void 0;if(h.add(i),Mu(i,(u,e)=>{var r;if(Eh(e)){let f=X(e);c(f);let m=((r=f.assignedMap)===null||r===void 0?void 0:r.size)||f.operated?f.copy:f.original;Kt(s?l:i,u,m)}else Om(e,h,t)}),l){let u=i,e=Array.from(u);u.clear(),e.forEach((r)=>{u.add(l.has(r)?l.get(r):r)})}}function RE(i,h){let t=i.type===3?i.setMap:i.copy;if(i.finalities.revoke.length>1&&i.assignedMap.get(h)&&t)Om(Ai(t,h),i.finalities.handledSet,i.options)}function Hu(i){if(i.type===3&&i.copy)i.copy.clear(),i.setMap.forEach((h)=>{i.copy.add(Ru(h))})}function Qu(i,h,t,s){if(i.operated&&i.assignedMap&&i.assignedMap.size>0&&!i.finalized){if(t&&s){let u=zm(i);if(u)h(i,u,t,s)}i.finalized=!0}}function Uu(i,h,t,s){let l=X(t);if(l){if(!l.callbacks)l.callbacks=[];if(l.callbacks.push((u,e)=>{var r;let f=i.type===3?i.setMap:i.copy;if(ji(Ai(f,h),t)){let m=l.original;if(l.copy)m=l.copy;if(Hu(i),Qu(i,s,u,e),i.options.enableAutoFreeze)i.options.updatedValues=(r=i.options.updatedValues)!==null&&r!==void 0?r:new WeakMap,i.options.updatedValues.set(m,l.original);Kt(f,h,m)}}),i.options.enableAutoFreeze){if(l.finalities!==i.finalities)i.options.enableAutoFreeze=!1}}if(Oi(t,i.options))i.finalities.draft.push(()=>{let u=i.type===3?i.setMap:i.copy;if(ji(Ai(u,h),t))RE(i,h)})}function ME(i,h,t,s,l){let{original:u,assignedMap:e,options:r}=i,f=i.copy;if(f.length<u.length)[u,f]=[f,u],[t,s]=[s,t];for(let m=0;m<u.length;m+=1)if(e.get(m.toString())&&f[m]!==u[m]){let n=h.concat([m]),S=vh(n,l);t.push({op:R.Replace,path:S,value:Us(f[m])}),s.push({op:R.Replace,path:S,value:Us(u[m])})}for(let m=u.length;m<f.length;m+=1){let n=h.concat([m]),S=vh(n,l);t.push({op:R.Add,path:S,value:Us(f[m])})}if(u.length<f.length){let{arrayLengthAssignment:m=!0}=r.enablePatches;if(m){let n=h.concat(["length"]),S=vh(n,l);s.push({op:R.Replace,path:S,value:u.length})}else for(let n=f.length;u.length<n;n-=1){let S=h.concat([n-1]),d=vh(S,l);s.push({op:R.Remove,path:d})}}}function UE({original:i,copy:h,assignedMap:t},s,l,u,e){t.forEach((r,f)=>{let m=Ai(i,f),n=Us(Ai(h,f)),S=!r?R.Remove:Ot(i,f)?R.Replace:R.Add;if(ji(m,n)&&S===R.Replace)return;let d=s.concat(f),v=vh(d,e);l.push(S===R.Remove?{op:S,path:v}:{op:S,path:v,value:n}),u.push(S===R.Add?{op:R.Remove,path:v}:S===R.Remove?{op:R.Add,path:v,value:m}:{op:R.Replace,path:v,value:m})})}function qE({original:i,copy:h},t,s,l,u){let e=0;i.forEach((r)=>{if(!h.has(r)){let f=t.concat([e]),m=vh(f,u);s.push({op:R.Remove,path:m,value:r}),l.unshift({op:R.Add,path:m,value:r})}e+=1}),e=0,h.forEach((r)=>{if(!i.has(r)){let f=t.concat([e]),m=vh(f,u);s.push({op:R.Add,path:m,value:r}),l.unshift({op:R.Remove,path:m,value:r})}e+=1})}function Lt(i,h,t,s){let{pathAsArray:l=!0}=i.options.enablePatches;switch(i.type){case 0:case 2:return UE(i,h,t,s,l);case 1:return ME(i,h,t,s,l);case 3:return qE(i,h,t,s,l)}}var PE=!1,qs=(i,h,t=!1)=>{if(typeof i==="object"&&i!==null&&(!Oi(i,h)||t)&&!PE)throw new Error("Strict mode: Mutable data cannot be accessed directly, please use 'unsafe(callback)' wrap.")};var Zu={get size(){return ri(X(this)).size},has(i){return ri(X(this)).has(i)},set(i,h){let t=X(this),s=ri(t);if(!s.has(i)||!ji(s.get(i),h))c(t),Mi(t),t.assignedMap.set(i,!0),t.copy.set(i,h),Uu(t,i,h,Lt);return this},delete(i){if(!this.has(i))return!1;let h=X(this);if(c(h),Mi(h),h.original.has(i))h.assignedMap.set(i,!1);else h.assignedMap.delete(i);return h.copy.delete(i),!0},clear(){let i=X(this);if(!this.size)return;c(i),Mi(i),i.assignedMap=new Map;for(let[h]of i.original)i.assignedMap.set(h,!1);i.copy.clear()},forEach(i,h){let t=X(this);ri(t).forEach((s,l)=>{i.call(h,this.get(l),l,this)})},get(i){var h,t;let s=X(this),l=ri(s).get(i),u=((t=(h=s.options).mark)===null||t===void 0?void 0:t.call(h,l,fi))===fi.mutable;if(s.options.strict)qs(l,s.options,u);if(u)return l;if(s.finalized||!Oi(l,s.options))return l;if(l!==s.original.get(i))return l;let e=Ju.createDraft({original:l,parentDraft:s,key:i,finalities:s.finalities,options:s.options});return c(s),s.copy.set(i,e),e},keys(){return ri(X(this)).keys()},values(){let i=this.keys();return{[Ms]:()=>this.values(),next:()=>{let h=i.next();if(h.done)return h;return{done:!1,value:this.get(h.value)}}}},entries(){let i=this.keys();return{[Ms]:()=>this.entries(),next:()=>{let h=i.next();if(h.done)return h;let t=this.get(h.value);return{done:!1,value:[h.value,t]}}}},[Ms](){return this.entries()}},VE=Reflect.ownKeys(Zu),Tm=(i,h,{isValuesIterator:t})=>()=>{var s,l;let u=h.next();if(u.done)return u;let e=u.value,r=i.setMap.get(e),f=X(r),m=((l=(s=i.options).mark)===null||l===void 0?void 0:l.call(s,r,fi))===fi.mutable;if(i.options.strict)qs(e,i.options,m);if(!m&&!f&&Oi(e,i.options)&&!i.finalized&&i.original.has(e)){let n=Ju.createDraft({original:e,parentDraft:i,key:e,finalities:i.finalities,options:i.options});i.setMap.set(e,n),r=n}else if(f)r=f.proxy;return{done:!1,value:t?r:[r,r]}},Ps={get size(){return X(this).setMap.size},has(i){let h=X(this);if(h.setMap.has(i))return!0;c(h);let t=X(i);if(t&&h.setMap.has(t.original))return!0;return!1},add(i){let h=X(this);if(!this.has(i))c(h),Mi(h),h.assignedMap.set(i,!0),h.setMap.set(i,i),Uu(h,i,i,Lt);return this},delete(i){if(!this.has(i))return!1;let h=X(this);c(h),Mi(h);let t=X(i);if(t&&h.setMap.has(t.original))return h.assignedMap.set(t.original,!1),h.setMap.delete(t.original);if(!t&&h.setMap.has(i))h.assignedMap.set(i,!1);else h.assignedMap.delete(i);return h.setMap.delete(i)},clear(){if(!this.size)return;let i=X(this);c(i),Mi(i);for(let h of i.original)i.assignedMap.set(h,!1);i.setMap.clear()},values(){let i=X(this);c(i);let h=i.setMap.keys();return{[Symbol.iterator]:()=>this.values(),next:Tm(i,h,{isValuesIterator:!0})}},entries(){let i=X(this);c(i);let h=i.setMap.keys();return{[Symbol.iterator]:()=>this.entries(),next:Tm(i,h,{isValuesIterator:!1})}},keys(){return this.values()},[Ms](){return this.values()},forEach(i,h){let t=this.values(),s=t.next();while(!s.done)i.call(h,s.value,s.value,this),s=t.next()}};if(Set.prototype.difference)Object.assign(Ps,{intersection(i){return Set.prototype.intersection.call(new Set(this.values()),i)},union(i){return Set.prototype.union.call(new Set(this.values()),i)},difference(i){return Set.prototype.difference.call(new Set(this.values()),i)},symmetricDifference(i){return Set.prototype.symmetricDifference.call(new Set(this.values()),i)},isSubsetOf(i){return Set.prototype.isSubsetOf.call(new Set(this.values()),i)},isSupersetOf(i){return Set.prototype.isSupersetOf.call(new Set(this.values()),i)},isDisjointFrom(i){return Set.prototype.isDisjointFrom.call(new Set(this.values()),i)}});var jE=Reflect.ownKeys(Ps),Lm=new WeakSet,Km={get(i,h,t){var s,l;let u=(s=i.copy)===null||s===void 0?void 0:s[h];if(u&&Lm.has(u))return u;if(h===Nm)return i;let e;if(i.options.mark){let m=h==="size"&&(i.original instanceof Map||i.original instanceof Set)?Reflect.get(i.original,h):Reflect.get(i.original,h,t);if(e=i.options.mark(m,fi),e===fi.mutable){if(i.options.strict)qs(m,i.options,!0);return m}}let r=ri(i);if(r instanceof Map&&VE.includes(h)){if(h==="size")return Object.getOwnPropertyDescriptor(Zu,"size").get.call(i.proxy);let m=Zu[h];if(m)return m.bind(i.proxy)}if(r instanceof Set&&jE.includes(h)){if(h==="size")return Object.getOwnPropertyDescriptor(Ps,"size").get.call(i.proxy);let m=Ps[h];if(m)return m.bind(i.proxy)}if(!Ot(r,h)){let m=vm(r,h);return m?"value"in m?m.value:(l=m.get)===null||l===void 0?void 0:l.call(i.proxy):void 0}let f=r[h];if(i.options.strict)qs(f,i.options);if(i.finalized||!Oi(f,i.options))return f;if(f===Xu(i.original,h)){if(c(i),i.copy[h]=qu({original:i.original[h],parentDraft:i,key:i.type===1?Number(h):h,finalities:i.finalities,options:i.options}),typeof e==="function"){let m=X(i.copy[h]);return c(m),Mi(m),m.copy}return i.copy[h]}return f},set(i,h,t){var s;if(i.type===3||i.type===2)throw new Error("Map/Set draft does not support any property assignment.");let l;if(i.type===1&&h!=="length"&&!(Number.isInteger(l=Number(h))&&l>=0&&(h===0||l===0||String(l)===String(h))))throw new Error("Only supports setting array indices and the 'length' property.");let u=vm(ri(i),h);if(u===null||u===void 0?void 0:u.set)return u.set.call(i.proxy,t),!0;let e=Xu(ri(i),h),r=X(e);if(r&&ji(r.original,t))return i.copy[h]=t,i.assignedMap=(s=i.assignedMap)!==null&&s!==void 0?s:new Map,i.assignedMap.set(h,!1),!0;if(ji(t,e)&&(t!==void 0||Ot(i.original,h)))return!0;if(c(i),Mi(i),Ot(i.original,h)&&ji(t,i.original[h]))i.assignedMap.delete(h);else i.assignedMap.set(h,!0);return i.copy[h]=t,Uu(i,h,t,Lt),!0},has(i,h){return h in ri(i)},ownKeys(i){return Reflect.ownKeys(ri(i))},getOwnPropertyDescriptor(i,h){let t=ri(i),s=Reflect.getOwnPropertyDescriptor(t,h);if(!s)return s;return{writable:!0,configurable:i.type!==1||h!=="length",enumerable:s.enumerable,value:t[h]}},getPrototypeOf(i){return Reflect.getPrototypeOf(i.original)},setPrototypeOf(){throw new Error("Cannot call 'setPrototypeOf()' on drafts")},defineProperty(){throw new Error("Cannot call 'defineProperty()' on drafts")},deleteProperty(i,h){var t;if(i.type===1)return Km.set.call(this,i,h,void 0,i.proxy);if(Xu(i.original,h)!==void 0||h in i.original)c(i),Mi(i),i.assignedMap.set(h,!1);else i.assignedMap=(t=i.assignedMap)!==null&&t!==void 0?t:new Map,i.assignedMap.delete(h);if(i.copy)delete i.copy[h];return!0}};function qu(i){let{original:h,parentDraft:t,key:s,finalities:l,options:u}=i,e=Th(h),r={type:e,finalized:!1,parent:t,original:h,copy:null,proxy:null,finalities:l,options:u,setMap:e===3?new Map(h.entries()):void 0};if(s||"key"in i)r.key=s;let{proxy:f,revoke:m}=Proxy.revocable(e===1?Object.assign([],r):r,Km);if(l.revoke.push(m),Lm.add(f),r.proxy=f,t){let n=t;n.finalities.draft.push((S,d)=>{var v,b;let w=X(f),T=n.type===3?n.setMap:n.copy,E=Ai(T,s),N=X(E);if(N){let z=N.original;if(N.operated)z=Ru(E);if(Hu(N),Qu(N,Lt,S,d),n.options.enableAutoFreeze)n.options.updatedValues=(v=n.options.updatedValues)!==null&&v!==void 0?v:new WeakMap,n.options.updatedValues.set(z,N.original);Kt(T,s,z)}(b=w.callbacks)===null||b===void 0||b.forEach((z)=>{z(S,d)})})}else{let n=X(f);n.finalities.draft.push((S,d)=>{Hu(n),Qu(n,Lt,S,d)})}return f}Ju.createDraft=qu;function AE(i,h,t,s,l){var u;let e=X(i),r=(u=e===null||e===void 0?void 0:e.original)!==null&&u!==void 0?u:i,f=!!h.length;if(e===null||e===void 0?void 0:e.operated)while(e.finalities.draft.length>0)e.finalities.draft.pop()(t,s);let m=f?h[0]:e?e.operated?e.copy:e.original:i;if(e)Cu(e);if(l)Ph(m,m,e===null||e===void 0?void 0:e.options.updatedValues);return[m,t&&f?[{op:R.Replace,path:[],value:h[0]}]:t,s&&f?[{op:R.Replace,path:[],value:r}]:s]}function xE(i,h){var t;let s={draft:[],revoke:[],handledSet:new WeakSet},l,u;if(h.enablePatches)l=[],u=[];let r=((t=h.mark)===null||t===void 0?void 0:t.call(h,i,fi))===fi.mutable||!Oi(i,h)?i:qu({original:i,parentDraft:null,finalities:s,options:h});return[r,(f=[])=>{let[m,n,S]=AE(r,f,l,u,h.enableAutoFreeze);return h.enablePatches?[m,n,S]:m}]}function gu(i){let{rootDraft:h,value:t,useRawReturn:s=!1,isRoot:l=!0}=i;if(Mu(t,(u,e,r)=>{let f=X(e);if(f&&h&&f.finalities===h.finalities){i.isContainDraft=!0;let m=f.original;if(r instanceof Set){let n=Array.from(r);r.clear(),n.forEach((S)=>r.add(u===S?m:S))}else Kt(r,u,m)}else if(typeof e==="object"&&e!==null)i.value=e,i.isRoot=!1,gu(i)}),l){if(!i.isContainDraft)console.warn("The return value does not contain any draft, please use 'rawReturn()' to wrap the return value to improve performance.");if(s)console.warn("The return value contains drafts, please don't use 'rawReturn()' to wrap the return value.")}}function Gm(i){var h;let t=X(i);if(!Oi(i,t===null||t===void 0?void 0:t.options))return i;let s=Th(i);if(t&&!t.operated)return t.original;let l;function u(){l=s===2?!Bu(i)?new(Object.getPrototypeOf(i)).constructor(i):new Map(i):s===3?Array.from(t.setMap.values()):Fm(i,t===null||t===void 0?void 0:t.options)}if(t){t.finalized=!0;try{u()}finally{t.finalized=!1}}else l=i;if(Mu(l,(e,r)=>{if(t&&ji(Ai(t.original,e),r))return;let f=Gm(r);if(f!==r){if(l===i)u();Kt(l,e,f)}}),s===3){let e=(h=t===null||t===void 0?void 0:t.original)!==null&&h!==void 0?h:l;return!Wu(e)?new(Object.getPrototypeOf(e)).constructor(l):new Set(l)}return l}function ym(i){if(!Eh(i))throw new Error(`current() is only used for Draft, parameter: ${i}`);return Gm(i)}var DE=(i)=>{if(i!==void 0&&Object.prototype.toString.call(i)!=="[object Object]")throw new Error(`Invalid options: ${String(i)}, 'options' should be an object.`);return function h(t,s,l){var u,e,r;if(typeof t==="function"&&typeof s!=="function")return function(O,...L){return h(O,(Y)=>t.call(this,Y,...L),s)};let f=t,m=s,n=l;if(typeof s!=="function")n=s;if(n!==void 0&&Object.prototype.toString.call(n)!=="[object Object]")throw new Error(`Invalid options: ${n}, 'options' should be an object.`);n=Object.assign(Object.assign({},i),n);let S=Eh(f)?ym(f):f,d=Array.isArray(n.mark)?(O,L)=>{for(let Y of n.mark){if(typeof Y!=="function")throw new Error(`Invalid mark: ${Y}, 'mark' should be a function.`);let g=Y(O,L);if(g)return g}return}:n.mark,v=(u=n.enablePatches)!==null&&u!==void 0?u:!1,b=(e=n.strict)!==null&&e!==void 0?e:!1,T={enableAutoFreeze:(r=n.enableAutoFreeze)!==null&&r!==void 0?r:!1,mark:d,strict:b,enablePatches:v};if(!Oi(S,T)&&typeof S==="object"&&S!==null)throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");let[E,N]=xE(S,T);if(typeof s!=="function"){if(!Oi(S,T))throw new Error("Invalid base state: create() only supports plain objects, arrays, Set, Map or using mark() to mark the state as immutable.");return[E,N]}let z;try{z=m(E)}catch(O){throw Cu(X(E)),O}let F=(O)=>{let L=X(E);if(!Eh(O)){if(O!==void 0&&!ji(O,E)&&(L===null||L===void 0?void 0:L.operated))throw new Error("Either the value is returned as a new non-draft value, or only the draft is modified without returning any value.");let g=O===null||O===void 0?void 0:O[gE];if(g){let C=g[0];if(T.strict&&typeof O==="object"&&O!==null)gu({rootDraft:L,value:O,useRawReturn:!0});return N([C])}if(O!==void 0){if(typeof O==="object"&&O!==null)gu({rootDraft:L,value:O});return N([O])}}if(O===E||O===void 0)return N([]);let Y=X(O);if(T===Y.options){if(Y.operated)throw new Error("Cannot return a modified child draft.");return N([ym(O)])}return N([O])};if(z instanceof Promise)return z.then(F,(O)=>{throw Cu(X(E)),O});return F(z)}},Gt=DE();var Xz=Object.prototype.constructor.toString();function Pu(i,h){let t=Object.keys(i),s=Object.keys(h);return t.length===s.length&&Object.keys(i).every((l)=>h.hasOwnProperty(l))}function Vu(i,h){return Object.keys(i).length===Object.keys(h).length&&Object.keys(i).every((t)=>h.hasOwnProperty(t)&&i[t]===h[t])}function Xt(i,h){if(typeof i!=="object"||typeof h!=="object"||i===null||h===null)return i===h;if(!Pu(i,h))return!1;return Object.keys(i).every((t)=>Xt(i[t],h[t]))}function ju(i){if(!Yt(i))return i;let h={};for(let[t,s]of Object.entries(i)){if(s===void 0)continue;h[t]=s}return h}function Au(i,h){if(!Yt(i)||!Yt(h))return h;let t=Object.assign({},i);for(let s of Object.keys(h)){if(h[s]===void 0)continue;if(h[s]===null){delete t[s];continue}let l=Yt(i[s])&&Yt(h[s]);t[s]=l?Au(i[s],h[s]):h[s]}return t}function Yt(i){return typeof i==="object"&&i!==null&&!Array.isArray(i)}function Ym(i,h,t){if(!i)return;if(h.length===0)return;let s=i||{};for(let u=0;u<h.length-1;u++){let e=h[u];if(!(e in s)||typeof s[e]!=="object")s[e]=typeof h[u+1]==="number"?[]:{};s=s[e]}let l=h[h.length-1];if(Array.isArray(s)&&typeof l==="number")s.splice(l,0,t);else s[l]=t}function xu(i,h,t){if(!i)return;if(h.length===0)return;let s=i||{};for(let l=0;l<h.length-1;l++){let u=h[l];if(!(u in s)||typeof s[u]!=="object")s[u]=typeof h[l+1]==="number"?[]:{};s=s[u]}s[h[h.length-1]]=t}function Du(i,h){if(!i)return;if(h.length===0)return;let[t,...s]=h;if(!(t in i))return;if(s.length===0){if(Array.isArray(i))i.splice(t,1);else delete i[t];return}if(Du(i[t],s),pE(i[t]))delete i[t]}function pE(i){return i&&Object.keys(i).length===0}function _E(i){return i.cardinality==="one"}function _u(i){return i["value-type"]==="ref"}function js(i){return i["value-type"]==="blob"}function As(i,h){return i[h]}function ku(i,h){return h.reduce((t,s)=>t&&t.get(s),i)}function Li(i,h){if(h.length===0)throw new Error("path must have at least one element");if(h.length===1){i.delete(h[0]);return}let[t,...s]=h;if(!i.has(t))return;Li(i.get(t),s)}function si(i,h,t){if(h.length===0)throw new Error("path must have at least one element");if(h.length===1){i.set(h[0],t);return}let[s,...l]=h,u=i.get(s);if(!u)u=new Map,i.set(s,u);si(u,l,t)}function Xm(i,h){let t=new Map,s=new Map,l=new Map;for(let u of h){let[e,r,f,m]=u,n=As(i,r);if(!n){console.warn("no such attr",e,i);continue}if(_u(n))si(l,[f,r,e],u);si(t,[e,r,f],u),si(s,[r,e,f],u)}return{eav:t,aev:s,vae:l}}function Cm(i){let h=new Map,t=new Map,s=new Map,l=new Map;for(let u of Object.values(i)){let e=u["forward-identity"],[r,f,m]=e,n=u["reverse-identity"];if(si(s,[f,m],u),js(u))si(h,[f,m],u);if(u["primary?"])si(t,[f],u);if(n){let[S,d,v]=n;si(l,[d,v],u)}}return{blobAttrs:h,primaryKeys:t,forwardIdents:s,revIdents:l}}function Hm(i){return{__type:i.__type,attrs:i.attrs,triples:mi(i.eav,3),cardinalityInference:i.cardinalityInference,linkIndex:i.linkIndex}}function Qm(i){return xs(i.attrs,i.triples,i.cardinalityInference,i.linkIndex)}function $u(i){i.attrIndexes=Cm(i.attrs)}function xs(i,h,t,s){let l=Xm(i,h);return l.attrs=i,l.attrIndexes=Cm(i),l.cardinalityInference=t,l.linkIndex=s,l.__type="store",l}function Ds(i,h){var t,s;let l;if(Array.isArray(h[0])){let[e,r]=h[0],f=i.aev.get(e);if(!f)return null;l=(t=mi(f,2).find((n)=>n[2]===r))===null||t===void 0?void 0:t[0]}else l=h[0];if(!l)return null;let u=h[2];if(Array.isArray(u)&&u.length===2&&i.aev.get(u[0])){let[e,r]=u,f=i.aev.get(e);if(!f)return null;let n=(s=mi(f,2).find((w)=>w[2]===r))===null||s===void 0?void 0:s[0];if(!n)return null;let[S,d,v,...b]=h;return[l,d,n,...b]}else{let[e,...r]=h;return[l,...r]}}function kE(i,h){let t=Ds(i,h);if(!t)return;let[s,l,u]=t,e=As(i.attrs,l);if(!e)return;if(Li(i.eav,[s,l,u]),Li(i.aev,[l,s,u]),_u(e))Li(i.vae,[u,l,s])}var $E=0;function Zm(i,h,t){let[s,l,u]=t,e,r=ku(i.ea,[s,l,u]);if(r)e=r[3];return e||Date.now()*10+$E++}function aE(i,h){var t;let s=Ds(i,h);if(!s)return;let[l,u,e]=s,r=As(i.attrs,u);if(!r)return;let f=ku(i.eav,[l,u,e]),m=(t=f===null||f===void 0?void 0:f[3])!==null&&t!==void 0?t:Zm(i,r,s),n=[l,u,e,m];if(_E(r))si(i.eav,[l,u],new Map([[e,n]])),si(i.aev,[u,l],new Map([[e,n]]));else si(i.eav,[l,u,e],n),si(i.aev,[u,l,e],n);if(_u(r))si(i.vae,[e,u,l],n)}function oE(i,h){var t;let s=Ds(i,h);if(!s)return;let[l,u,e]=s,r=As(i.attrs,u);if(!r)return;if(!js(r))throw new Error("merge operation is not supported for links");let f=ku(i.eav,[l,u]);if(!f)return;let m=(t=f.values().next())===null||t===void 0?void 0:t.value;if(!m)return;let n=m[2],S=Au(n,e),d=[l,u,S,Zm(i,r,m)];si(i.eav,[l,u],new Map([[S,d]]))}function pu(i,h){var t,s;let[l,u]=h,e=Ds(i,[l]);if(!e)return;let[r]=e,f=i.eav.get(r);if(f){for(let n of f.keys()){let S=i.attrs[n];if(S&&S["on-delete-reverse"]==="cascade")mi(f.get(n),1).forEach(([d,v,b])=>{var w;return pu(i,[b,(w=S["reverse-identity"])===null||w===void 0?void 0:w[1]])});if(!u||!S||((t=S["forward-identity"])===null||t===void 0?void 0:t[1])===u)Li(i.aev,[n,r]),Li(i.eav,[r,n])}if(f.size===0)Li(i.eav,[r])}let m=i.vae.get(r)&&mi(i.vae.get(r),2);if(m)m.forEach((n)=>{var S,d;let[v,b,w]=n,T=i.attrs[b];if(!u||!T||((S=T["reverse-identity"])===null||S===void 0?void 0:S[1])===u)Li(i.eav,[v,b,w]),Li(i.aev,[b,v,w]),Li(i.vae,[w,b,v]);if(T&&T["on-delete"]==="cascade")pu(i,[v,(d=T["forward-identity"])===null||d===void 0?void 0:d[1]])});if(((s=i.vae.get(r))===null||s===void 0?void 0:s.size)===0)Li(i.vae,[r])}function gm(i,h){let t=Xm(i.attrs,h);Object.keys(t).forEach((s)=>{i[s]=t[s]})}function cE(i,[h]){i.attrs[h.id]=h,$u(i)}function Jm(i){return mi(i.eav,3)}function IE(i,[h]){if(!i.attrs[h])return;let t=Jm(i).filter(([s,l])=>l!==h);delete i.attrs[h],$u(i),gm(i,t)}function iT(i,[h]){let t=i.attrs[h.id];if(!t)return;i.attrs[h.id]=Object.assign(Object.assign({},t),h),$u(i),gm(i,Jm(i))}function hT(i,h){let[t,...s]=h;switch(t){case"add-triple":aE(i,s);break;case"deep-merge-triple":oE(i,s);break;case"retract-triple":kE(i,s);break;case"delete-entity":pu(i,s);break;case"add-attr":cE(i,s);break;case"delete-attr":IE(i,s);break;case"update-attr":iT(i,s);break;case"rule-params":break;default:throw new Error(`unhandled transaction action: ${t}`)}}function mi(i,h,t=[]){if(!i)return t;if(h===0)return t;if(h===1){for(let s of i.values())t.push(s);return t}for(let s of i.values())mi(s,h-1,t);return t}function Vs(i,h,t){var s,l;let u=[];if(t===null||t===void 0?void 0:t.hasOwnProperty("$not")){for(let r of h.keys())if(t.$not!==r)u.push(h.get(r));return u}if(t===null||t===void 0?void 0:t.hasOwnProperty("$isNull")){let{attrId:r,isNull:f,reverse:m}=t.$isNull;if(m)for(let n of h.keys()){let S=i.vae.get(n),d=!S||((s=S.get(r))===null||s===void 0?void 0:s.get(null))||!S.get(r);if(f?d:!d)u.push(h.get(n))}else{let n=i.aev.get(r);for(let S of h.keys()){let d=!n||((l=n.get(S))===null||l===void 0?void 0:l.get(null))||!n.get(S);if(f?d:!d)u.push(h.get(S))}}return u}if(t===null||t===void 0?void 0:t.$comparator)return mi(h,1).filter(t.$op);let e=t.in||t.$in||[t];for(let r of e){let f=h.get(r);if(f)u.push(f)}return u}function tT(i,h,t){let s="";if(i!==void 0)s+="e";if(h!==void 0)s+="a";if(t!==void 0)s+="v";return s}function Wm(i,[h,t,s]){var l,u;switch(tT(h,t,s)){case"e":{let r=i.eav.get(h);return mi(r,2)}case"ea":{let r=(l=i.eav.get(h))===null||l===void 0?void 0:l.get(t);return mi(r,1)}case"eav":{let r=(u=i.eav.get(h))===null||u===void 0?void 0:u.get(t);if(!r)return[];return Vs(i,r,s)}case"ev":{let r=i.eav.get(h);if(!r)return[];let f=[];for(let m of r.values())f.push(...Vs(i,m,s));return f}case"a":{let r=i.aev.get(t);return mi(r,2)}case"av":{let r=i.aev.get(t);if(!r)return[];let f=[];for(let m of r.values())f.push(...Vs(i,m,s));return f}case"v":{let r=[];for(let f of i.eav.values())for(let m of f.values())r.push(...Vs(i,m,s))}default:return mi(i.eav,3)}}function Bm(i,h,t){var s;let l={};for(let[u,e]of h.entries()){let r=(s=i.eav.get(t))===null||s===void 0?void 0:s.get(e.id),f=mi(r,1);for(let m of f)l[u]=m[2]}return l}function yh(i,h,t){var s;return(s=i.attrIndexes.forwardIdents.get(h))===null||s===void 0?void 0:s.get(t)}function au(i,h,t){var s;return(s=i.attrIndexes.revIdents.get(h))===null||s===void 0?void 0:s.get(t)}function Rm(i,h){return i.attrIndexes.blobAttrs.get(h)}function Mm(i,h){var t;let s=i.attrIndexes.primaryKeys.get(h);if(s)return s;return(t=i.attrIndexes.forwardIdents.get(h))===null||t===void 0?void 0:t.get("id")}function ou(i,h){return Gt(i,(t)=>{h.forEach((s)=>{hT(t,s)})})}function sT(i){return typeof i==="string"&&i.startsWith("?")}function lT(i,h,t){if(t.hasOwnProperty(i)){let s=t[i];return Pm(s,h,t)}return Object.assign(Object.assign({},t),{[i]:h})}function qm(i,h,t){return i===h?t:null}function uT(i){switch(typeof i){case"string":return i.startsWith("?")?lT:qm;default:return qm}}var eT=["in","$in","$not","$isNull","$comparator"];function rT(i){for(let h of eT)if(i.hasOwnProperty(h))return!0;return!1}function Pm(i,h,t){if(!t)return null;if(typeof i==="object"){if(rT(i))return t;return null}return uT(i)(i,h,t)}function fT(i,h,t){return i.reduce((s,l,u)=>{let e=h[u];return Pm(l,e,s)},t)}function mT(i,h,t){return ST(i,h,t).map((s)=>fT(h,s,t)).filter((s)=>s)}function nT(i,h,t){if(h.or)return h.or.patterns.flatMap((s)=>{return cu(i,s,t)});if(h.and)return h.and.patterns.reduce((s,l)=>{return cu(i,l,s)},t);return t.flatMap((s)=>mT(i,h,s))}function cu(i,h,t=[{}]){return h.reduce((s,l)=>{return nT(i,l,s)},t)}function Iu(i,h){if(Array.isArray(h))return h.map((t)=>Iu(i,t));return sT(h)?i[h]:h}function Vm(i,{find:h,where:t}){return cu(i,t).map((l)=>Iu(l,h))}function ST(i,h,t){return Wm(i,Iu(t,h))}var ps,bT=new Uint8Array(16);function ie(){if(!ps){if(ps=typeof crypto!=="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ps)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}return ps(bT)}var A=[];for(let i=0;i<256;++i)A.push((i+256).toString(16).slice(1));function jm(i,h=0){return A[i[h+0]]+A[i[h+1]]+A[i[h+2]]+A[i[h+3]]+"-"+A[i[h+4]]+A[i[h+5]]+"-"+A[i[h+6]]+A[i[h+7]]+"-"+A[i[h+8]]+A[i[h+9]]+"-"+A[i[h+10]]+A[i[h+11]]+A[i[h+12]]+A[i[h+13]]+A[i[h+14]]+A[i[h+15]]}var dT=typeof crypto!=="undefined"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),he={randomUUID:dT};function wT(i,h,t){if(he.randomUUID&&!h&&!i)return he.randomUUID();i=i||{};let s=i.random||(i.rng||ie)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,h){t=t||0;for(let l=0;l<16;++l)h[t+l]=s[l];return h}return jm(s)}var te=wT;function Am(i){let h=i.replace(/-/g,""),t=[];for(let s=0;s<h.length;s+=2)t.push(parseInt(h.substring(s,s+2),16));return t}function vT(i,h){for(let t=0;t<i.length;t++){if(i[t]<h[t])return-1;if(i[t]>h[t])return 1}return 0}function xm(i,h){return vT(Am(i),Am(h))}function ET(){return te()}var M=ET;var TT=0;function Ct(i){return ks(`_${i}`,TT++)}function ks(i,h){return`?${i}-${h}`}class Nh extends Error{constructor(i){super(i);this.name="AttrNotFoundError"}}function yT(i,h){let t=Mm(i,h);if(!t)throw new Nh(`Could not find id attr for ${h}`);return t}function Dm(i,h,t,s){return[NT(i,h,t,s)]}function NT(i,h,t,s){return[i(t,s),yT(h,t).id,i(t,s),i("time",s)]}function zT(i,h,t){return i.map((s)=>s===h?t:s)}function $m(i,h,t,s,l){let u=yh(h,t,l),e=au(h,t,l),r=u||e;if(!r)throw new Nh(`Could not find attr for ${[t,l]}`);if(r["value-type"]!=="ref")throw new Error(`Attr ${r.id} is not a ref`);let[f,m]=r["forward-identity"],[n,S]=r["reverse-identity"],d=s+1,v=u?[i(m,s),r.id,i(S,d),Ct("time")]:[i(m,d),r.id,i(S,s),Ct("time")],b=u?S:m,w=Boolean(u);return[b,d,v,r,w]}function pm(i,h){if(typeof h!=="string")return function u(e){return!1};let s=h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/%/g,".*").replace(/_/g,"."),l=new RegExp(`^${s}$`,i?void 0:"i");return function u(e){if(typeof e!=="string")return!1;return l.test(e)}}function FT(i,h){if(typeof h!=="object"||h.hasOwnProperty("$in")||h.hasOwnProperty("in"))return h;let t=i["checked-data-type"]==="date";if(h.hasOwnProperty("$gt"))return{$comparator:!0,$op:t?function s(l){return new Date(l[2])>new Date(h.$gt)}:function s(l){return l[2]>h.$gt}};if(h.hasOwnProperty("$gte"))return{$comparator:!0,$op:t?function s(l){return new Date(l[2])>=new Date(h.$gte)}:function s(l){return l[2]>=h.$gte}};if(h.hasOwnProperty("$lt"))return{$comparator:!0,$op:t?function s(l){return new Date(l[2])<new Date(h.$lt)}:function s(l){return l[2]<h.$lt}};if(h.hasOwnProperty("$lte"))return{$comparator:!0,$op:t?function s(l){return new Date(l[2])<=new Date(h.$lte)}:function s(l){return l[2]<=h.$lte}};if(h.hasOwnProperty("$like")){let s=pm(!0,h.$like);return{$comparator:!0,$op:function l(u){return s(u[2])}}}if(h.hasOwnProperty("$ilike")){let s=pm(!1,h.$ilike);return{$comparator:!0,$op:function l(u){return s(u[2])}}}return h}function OT(i,h,t,s,l,u){let e=yh(h,t,l),r=au(h,t,l),f=e||r;if(!f)throw new Nh(`No attr for etype = ${t} label = ${l}`);if(u===null||u===void 0?void 0:u.hasOwnProperty("$isNull")){let m=yh(h,t,"id");if(!m)throw new Nh(`No attr for etype = ${t} label = id`);return[i(t,s),m.id,{$isNull:{attrId:f.id,isNull:u.$isNull,reverse:!e}},Ct("time")]}if(e)return[i(t,s),f.id,FT(f,u),Ct("time")];return[u,f.id,i(t,s),Ct("time")]}function LT(i,h,t,s,l){let[u,e,r]=l.reduce((f,m)=>{let[n,S,d]=f,[v,b,w]=$m(i,h,n,S,m);return[v,b,[...d,w]]},[t,s,[]]);return[u,e,r]}function se(i,h,t,s,l,u){let e=l.slice(0,l.length-1),r=l[l.length-1],[f,m,n]=LT(i,h,t,s,e),S=OT(i,h,f,m,r,u);return n.concat([S])}function KT(i,h){return h?[h].concat(i):i}function GT([i,h]){return i==="or"&&Array.isArray(h)}function YT([i,h]){return i==="and"&&Array.isArray(h)}function XT(i,h,t){return(s,l)=>{let u=i(s,l);if(h==u)return u;return`${u}-${t}`}}function _m(i,h,t,s,l,u){let e=i(s,l),r=u.map((f,m)=>{let n=XT(i,e,m);return am(n,t,s,l,f)});return{[h]:{patterns:r,joinSym:e}}}function CT(i){let h=[];for(let t=1;t<=i.length;t++)h.push(i.slice(0,t));return h}function km(i,h,t,s,l){return CT(l).map((u)=>se(i,h,t,s,u,{$isNull:!0}))}function am(i,h,t,s,l){return Object.entries(l).flatMap(([u,e])=>{if(GT([u,e]))return _m(i,"or",h,t,s,e);if(YT([u,e]))return _m(i,"and",h,t,s,e);if(u==="$entityIdStartsWith")return[];let r=u.split(".");if(e===null||e===void 0?void 0:e.hasOwnProperty("$not")){let f=se(i,h,t,s,r,e),m=km(i,h,t,s,r);return[{or:{patterns:[f,...m],joinSym:i(t,s)}}]}if((e===null||e===void 0?void 0:e.hasOwnProperty("$isNull"))&&e.$isNull===!0&&r.length>1)return[{or:{patterns:km(i,h,t,s,r),joinSym:i(t,s)}}];return se(i,h,t,s,r,e)})}function HT(i,h,t,s){let l=ks;if(!s)return Dm(l,i,h,t);return am(l,i,h,t,s).concat(Dm(l,i,h,t))}function QT(i,h,t){return[i(h,t),i("time",t)]}function ZT(i,h,t,s,l,u){let[e,r,f,m,n]=$m(i,h,t,s,l),S=zT(f,i(t,s),u);return[e,r,S,m,n]}function gT(i,h,{etype:t,level:s,form:l},u){let e=Object.keys(l).filter((r)=>r!=="$");if(!e.length)return Object.values(u);return Object.entries(u).map(function r([f,m]){return e.map(function S(d){var v,b,w;let T=Boolean(h.cardinalityInference&&((w=(b=(v=h.linkIndex)===null||v===void 0?void 0:v[t])===null||b===void 0?void 0:b[d])===null||w===void 0?void 0:w.isSingular));try{let[E,N,z]=ZT(i,h,t,s,d,f),F=om(h,{etype:E,level:N,form:l[d],join:z}),O=T?F[0]:F;return{[d]:O}}catch(E){if(E instanceof Nh)return{[d]:T?void 0:[]};throw E}}).reduce(function S(d,v){return Object.assign(Object.assign({},d),v)},m)})}function _s([i,h],[t,s]){if(h===s||h==null&&s==null)return xm(i,t);if(s==null)return 1;if(h==null)return-1;if(h>s)return 1;return-1}function le(i){if(i==null)return i;return new Date(i).getTime()}function JT(i,h,t,s){var l;let[u,e,r,f]=i,m=t==="desc"?1:-1;if(((l=h["forward-identity"])===null||l===void 0?void 0:l[2])==="id")return _s(s,[u,f])===m;let[n,S]=s,d=h["checked-data-type"]==="date"?le(S):S,v=h["checked-data-type"]==="date"?le(r):r;return _s([n,d],[u,v])===m}function WT(i,h){let t=h[1];return i.attrs[t]}function BT(i,h,t){let s=Object.keys(t)[0];return yh(i,h,s)}function RT(i,h,t,s){if(t)return WT(i,t);if(s)return BT(i,h,s)}function MT(i,h,t){var s,l;if(!Array.isArray(t.fields))return Rm(i,h);let u=new Map;for(let e of t.fields){let r=yh(i,h,e),f=(s=r===null||r===void 0?void 0:r["forward-identity"])===null||s===void 0?void 0:s[2];if(f&&js(r))u.set(f,r)}if(!u.has("id")){let e=yh(i,h,"id"),r=(l=e===null||e===void 0?void 0:e["forward-identity"])===null||l===void 0?void 0:l[2];if(r)u.set(r,e)}return u}function UT(i,h,t,s,l,u){var e;let r=Vm(i,u),f=s===null||s===void 0?void 0:s["start-cursor"],m=RT(i,h,f,l);if(m&&((e=m===null||m===void 0?void 0:m["forward-identity"])===null||e===void 0?void 0:e[2])!=="id"){let d=m["checked-data-type"]==="date",v=m.id;r=r.map(([b])=>{var w,T,E,N,z;let F=(z=(N=(E=(T=(w=i.eav.get(b))===null||w===void 0?void 0:w.get(v))===null||T===void 0?void 0:T.values())===null||E===void 0?void 0:E.next())===null||N===void 0?void 0:N.value)===null||z===void 0?void 0:z[2];if(d)F=le(F);return[b,F]})}r.sort(t==="asc"?function d(v,b){return _s(v,b)}:function d(v,b){return _s(b,v)});let n={},S=MT(i,h,u);for(let d of r){let[v]=d;if(n[v])continue;if(f&&m&&JT(f,m,t,d))continue;let b=Bm(i,S,v);if(b)n[v]=b}return n}function qT(i){var h;let t=(h=i.$)===null||h===void 0?void 0:h.order;if(!t)return"asc";return t[Object.keys(t)[0]]||"asc"}function PT(i,{etype:h,level:t,form:s,join:l,pageInfo:u}){var e,r,f,m,n,S,d,v,b;let w=((e=s.$)===null||e===void 0?void 0:e.limit)||((r=s.$)===null||r===void 0?void 0:r.first)||((f=s.$)===null||f===void 0?void 0:f.last),T=(m=s.$)===null||m===void 0?void 0:m.offset,E=(n=s.$)===null||n===void 0?void 0:n.before,N=(S=s.$)===null||S===void 0?void 0:S.after,z=(d=s.$)===null||d===void 0?void 0:d.order,F=(v=s.$)===null||v===void 0?void 0:v.fields;if((T||E||N)&&(!u||!u["start-cursor"]))return[];let O=KT(HT(i,h,t,(b=s.$)===null||b===void 0?void 0:b.where),l),L=QT(ks,h,t),Y=UT(i,h,qT(s),u,z,{where:O,find:L,fields:F});if(w!=null){let g=Object.entries(Y);if(g.length<=w)return Y;return Object.fromEntries(g.slice(0,w))}return Y}function VT(i,h){try{return PT(i,h)}catch(t){if(t instanceof Nh)return{};throw t}}function om(i,h){let t=VT(i,h);return gT(ks,i,h,t)}function jT(i){let h={};for(let[t,s]of Object.entries(i))h[t]={startCursor:s["start-cursor"],endCursor:s["end-cursor"],hasNextPage:s["has-next-page?"],hasPreviousPage:s["has-previous-page?"]};return h}function ue({store:i,pageInfo:h,aggregate:t},s){let u={data:Object.keys(s).reduce(function e(r,f){if((t===null||t===void 0?void 0:t[f])||f==="$$ruleParams")return r;return r[f]=om(i,{etype:f,form:s[f],level:0,pageInfo:h===null||h===void 0?void 0:h[f]}),r},{})};if(h)u.pageInfo=jT(h);if(t)u.aggregate=t;return u}function AT(){return new Set(Object.keys({__etype:1,__ops:1,update:1,link:1,unlink:1,delete:1,merge:1,ruleParams:1}))}var xT=AT();function ee(i,h,t){return new Proxy({__etype:i,__ops:t},{get:(l,u)=>{if(u==="__ops")return t;if(u==="__etype")return i;if(!xT.has(u))return;return(e)=>{return ee(i,h,[...t,[u,i,h,e]])}}})}function $s(i){return i.startsWith("lookup__")}function re(i){let[h,t,...s]=i.split("__");return[t,JSON.parse(s.join("__"))]}function DT(i){return new Proxy({__etype:i},{get(h,t){if(t==="__etype")return i;let s=t;if($s(s))return ee(i,re(s),[]);return ee(i,s,[])}})}function fe(){return new Proxy({},{get(i,h){return DT(h)}})}var Ht=fe();function me(i){return i.__ops}function Im(i,h){let{attrIdMap:t,refSwapAttrIds:s}=i,l=[];for(let e of h){let r=t[e];if(r)l.push(r);else if(Array.isArray(e)&&e.length==2&&t[e[0]]){let[f,m]=e;l.push([t[f],m])}else l.push(e)}let[u]=h;if((u==="add-triple"||u==="retract-triple")&&s.has(h[2])){let e=l[1];l[1]=l[3],l[3]=e}return l}function p(i,h,t){return Object.values(i).find((s)=>{let[l,u,e]=s["forward-identity"];return u===h&&e===t})}function lh(i,h,t){return Object.values(i).find((s)=>{let l=s["reverse-identity"];if(!l)return!1;let[u,e,r]=l;return e===h&&r===t})}function pT(i){if(Array.isArray(i))return i;let h=Object.entries(i);if(h.length!==1)throw new Error("lookup must be an object with a single unique attr and value.");return h[0]}function Se(i,h,t){return t.indexOf(".")!==-1&&!p(i,h,t)}function be(i){let[h,t,...s]=i.split(".");if(s.length>0||t!=="id")throw new Error(`${i} is not a valid lookup attribute.`);return h}function _T(i,h,t){if(!Se(i,h,t))return p(i,h,t);let s=be(t),l=p(i,h,s)||lh(i,h,s);if(l&&l["value-type"]!=="ref")throw new Error(`${t} does not reference a valid link attribute.`);return l}function de(i){if(typeof i==="string"&&!$s(i))return null;return typeof i==="string"&&$s(i)?re(i):pT(i)}function ni(i,h,t){let s=de(t);if(s===null)return t;let[l,u]=s,e=_T(i,h,l);if(!e||!e["unique?"])throw new Error(`${l} is not a unique attribute.`);return[e.id,u]}function hn(i,h,t,s){let l=ni(i,h,t);if(!Array.isArray(l))return s;return[["add-triple",l,p(i,h,"id").id,l]].concat(s)}function kT(i,[h,t,s]){let l=Object.entries(s).flatMap(([u,e])=>{let r=Array.isArray(e)?e:[e],f=p(i,h,u),m=lh(i,h,u);return r.map((n)=>{return f?["add-triple",ni(i,h,t),f.id,ni(i,f["reverse-identity"][1],n)]:["add-triple",ni(i,m["forward-identity"][1],n),m.id,ni(i,h,t)]})});return hn(i,h,t,l)}function $T(i,[h,t,s]){let l=Object.entries(s).flatMap(([u,e])=>{let r=Array.isArray(e)?e:[e],f=p(i,h,u),m=lh(i,h,u);return r.map((n)=>{return f?["retract-triple",ni(i,h,t),f.id,ni(i,f["reverse-identity"][1],n)]:["retract-triple",ni(i,m["forward-identity"][1],n),m.id,ni(i,h,t)]})});return hn(i,h,t,l)}function aT(i,[h,t,s]){let l=ju(s),u=ni(i,h,t);return[["id",u]].concat(Object.entries(l)).map(([r,f])=>{let m=p(i,h,r);return["add-triple",u,m.id,f]})}function oT(i,[h,t]){return[["delete-entity",ni(i,h,t),h]]}function cT(i,[h,t,s]){let l=ju(s),u=ni(i,h,t),e=Object.entries(l).map(([f,m])=>{let n=p(i,h,f);return["deep-merge-triple",u,n.id,m]});return[["add-triple",u,p(i,h,"id").id,u]].concat(e)}function IT(i,[h,t,s]){return[["rule-params",ni(i,h,t),h,s]]}function iy(i){let[h,t,s,l]=i;if(!l)return i;let u=Object.assign({},l);return delete u.id,[h,t,s,u]}function hy(i,h){let[t,...s]=iy(h);switch(t){case"merge":return cT(i,s);case"update":return aT(i,s);case"link":return kT(i,s);case"unlink":return $T(i,s);case"delete":return oT(i,s);case"ruleParams":return IT(i,s);default:throw new Error(`unsupported action ${t}`)}}function ty(i){switch(i){case"string":case"date":case"boolean":case"number":return i;default:return}}function sy(i,h,t){var s,l;let u=(l=(s=i.entities[h])===null||s===void 0?void 0:s.attrs)===null||l===void 0?void 0:l[t];if(t==="id")return null;if(!u)throw new Error(`${h}.${t} does not exist in your schema`);let{unique:e,indexed:r}=u===null||u===void 0?void 0:u.config,f=ty(u===null||u===void 0?void 0:u.valueType);return{"index?":r,"unique?":e,"checked-data-type":f}}function ne(i,h,t,s){let l=i?sy(i,h,t):null,u=M(),r=[M(),h,t];return Object.assign(Object.assign({id:u,"forward-identity":r,"value-type":"blob",cardinality:"one","unique?":!1,"index?":!1,isUnsynced:!0},l||{}),s||{})}function ly(i,h,t){return Object.values(i.links).find((l)=>{return l.forward.on===h&&l.forward.label===t||l.reverse.on===h&&l.reverse.label===t})}function uy(i,h,t){let s=ly(i,h,t);if(!s)throw new Error(`Couldn't find the link ${h}.${t} in your schema`);let{forward:l,reverse:u}=s;return{"forward-identity":[M(),l.on,l.label],"reverse-identity":[M(),u.on,u.label],cardinality:l.has==="one"?"one":"many","unique?":u.has==="one"}}function cm(i,h,t,s){let l=i?uy(i,h,t):null,u=M(),e=[M(),h,t],r=[M(),t,h];return Object.assign(Object.assign({id:u,"forward-identity":e,"reverse-identity":r,"value-type":"ref",cardinality:"many","unique?":!1,"index?":!1,isUnsynced:!0},l||{}),s||{})}var ey=new Set(["update","merge","link","unlink"]),ry=new Set(["link","unlink"]),fy=new Set(["update","merge"]),my=new Set(["link","unlink","update","merge","delete","ruleParams"]),we={"unique?":!0,"index?":!0},ny=Object.assign(Object.assign({},we),{cardinality:"one"});function Sy(i){let h=[],[t,s,l,u]=i;if(!my.has(t))return h;let e=de(l);if(e)h.push({etype:s,lookupPair:e});if(t==="link")for(let[r,f]of Object.entries(u)){let m=Array.isArray(f)?f:[f];for(let n of m){let S=de(n);if(S)h.push({etype:s,lookupPair:S,linkLabel:r})}}return h}function by({attrs:i,schema:h},t){var s,l;let[u,e,r]=[new Set,Object.assign({},i),[]];function f(S){e[S.id]=S,r.push(["add-attr",S]),u.add(S.id)}function m(S){if((S===null||S===void 0?void 0:S.isUnsynced)&&!u.has(S.id))r.push(["add-attr",S]),u.add(S.id)}function n(S,d){let v=p(e,S,d),b=lh(e,S,d);if(m(v),m(b),!v&&!b)f(cm(h,S,d,ny))}for(let S of t)for(let{etype:d,lookupPair:v,linkLabel:b}of Sy(S)){let w=v[0];if(b){n(d,b);let T=p(e,d,b),E=lh(e,d,b);m(T),m(E);let N=((s=T===null||T===void 0?void 0:T["reverse-identity"])===null||s===void 0?void 0:s[1])||((l=E===null||E===void 0?void 0:E["forward-identity"])===null||l===void 0?void 0:l[1])||b;if(Se(e,N,w))n(N,be(w));else{let z=p(e,N,w);if(!z)f(ne(h,N,w,we));m(z)}}else if(Se(e,d,w))n(d,be(w));else{let T=p(e,d,w);if(!T)f(ne(h,d,w,we));m(T)}}for(let S of t){let[d,v,b,w]=S;if(ey.has(d)){let T=Object.keys(w);T.push("id");for(let E of T){let N=p(e,v,E);if(m(N),fy.has(d)){if(!N)f(ne(h,v,E,E==="id"?{"unique?":!0}:null))}if(ry.has(d)){let z=lh(e,v,E);if(!N&&!z)f(cm(h,v,E));m(z)}}}}return[e,r]}function tn(i,h){let s=(Array.isArray(h)?h:[h]).flatMap((r)=>me(r)),[l,u]=by(i,s),e=s.flatMap((r)=>hy(l,r));return[...u,...e]}var sn=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};class Vh{constructor(i){this.dbName=i,this._storeName="kv",this._dbPromise=this._init()}_init(){return new Promise((i,h)=>{let t=indexedDB.open(this.dbName,1);t.onerror=(s)=>{h(s)},t.onsuccess=(s)=>{i(s.target.result)},t.onupgradeneeded=(s)=>{s.target.result.createObjectStore(this._storeName)}})}getItem(i){return sn(this,void 0,void 0,function*(){let h=yield this._dbPromise;return new Promise((t,s)=>{let e=h.transaction([this._storeName],"readonly").objectStore(this._storeName).get(i);e.onerror=(r)=>{s(r)},e.onsuccess=(r)=>{if(e.result)t(e.result);else t(null)}})})}setItem(i,h){return sn(this,void 0,void 0,function*(){let t=yield this._dbPromise;return new Promise((s,l)=>{let r=t.transaction([this._storeName],"readwrite").objectStore(this._storeName).put(h,i);r.onerror=(f)=>{l(f)},r.onsuccess=(f)=>{s()}})})}}var wy=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};class jh{static getIsOnline(){return wy(this,void 0,void 0,function*(){return navigator.onLine})}static listen(i){let h=()=>{i(!0)},t=()=>{i(!1)};return addEventListener("online",h),addEventListener("offline",t),()=>{removeEventListener("online",h),removeEventListener("offline",t)}}}var vy=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};class as extends Error{constructor(i){var h;let t=((h=i.body)===null||h===void 0?void 0:h.message)||`API Error (${i.status})`;super(t);let s=new.target.prototype;if(Object.setPrototypeOf)Object.setPrototypeOf(this,s);if(Error.captureStackTrace)Error.captureStackTrace(this,as);this.name="InstantAPIError",this.status=i.status,this.body=i.body}get[Symbol.toStringTag](){return"InstantAPIError"}}function Ti(i,h){return vy(this,void 0,void 0,function*(){let t=yield fetch(i,h),s=yield t.json();return t.status===200?Promise.resolve(s):Promise.reject(new as({status:t.status,body:s}))})}var Qt=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};function ln({apiURI:i,appId:h,email:t}){return Ti(`${i}/runtime/auth/send_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":h,email:t})})}function un(i){return Qt(this,arguments,void 0,function*({apiURI:h,appId:t,email:s,code:l}){return yield Ti(`${h}/runtime/auth/verify_magic_code`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":t,email:s,code:l})})})}function en(i){return Qt(this,arguments,void 0,function*({apiURI:h,appId:t,refreshToken:s}){return yield Ti(`${h}/runtime/auth/verify_refresh_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({"app-id":t,"refresh-token":s})})})}function ve(i){return Qt(this,arguments,void 0,function*({apiURI:h,appId:t,code:s,codeVerifier:l}){return yield Ti(`${h}/runtime/oauth/token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:t,code:s,code_verifier:l})})})}function rn(i){return Qt(this,arguments,void 0,function*({apiURI:h,appId:t,nonce:s,idToken:l,clientName:u,refreshToken:e}){return yield Ti(`${h}/runtime/oauth/id_token`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:t,nonce:s,id_token:l,client_name:u,refresh_token:e})})})}function fn(i){return Qt(this,arguments,void 0,function*({apiURI:h,appId:t,refreshToken:s}){return yield Ti(`${h}/runtime/signout`,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({app_id:t,refresh_token:s})})})}var Zt=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};function mn(i){return Zt(this,arguments,void 0,function*({apiURI:h,appId:t,path:s,file:l,refreshToken:u,contentType:e,contentDisposition:r}){let f={app_id:t,path:s,authorization:`Bearer ${u}`,"content-type":e||l.type};if(r)f["content-disposition"]=r;return yield Ti(`${h}/storage/upload`,{method:"PUT",headers:f,body:l})})}function nn(i){return Zt(this,arguments,void 0,function*({apiURI:h,appId:t,path:s,refreshToken:l}){let{data:u}=yield Ti(`${h}/storage/files?app_id=${t}&filename=${encodeURIComponent(s)}`,{method:"DELETE",headers:{"content-type":"application/json",authorization:`Bearer ${l}`}});return u})}function Sn(i){return Zt(this,arguments,void 0,function*({apiURI:h,appId:t,fileName:s,refreshToken:l,metadata:u={}}){let{data:e}=yield Ti(`${h}/storage/signed-upload-url`,{method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${l}`},body:JSON.stringify({app_id:t,filename:s})});return e})}function bn(i,h){return Zt(this,void 0,void 0,function*(){return(yield fetch(i,{method:"PUT",body:h,headers:{"Content-Type":h.type}})).ok})}function dn(i){return Zt(this,arguments,void 0,function*({apiURI:h,appId:t,path:s,refreshToken:l}){let{data:u}=yield Ti(`${h}/storage/signed-download-url?app_id=${t}&filename=${encodeURIComponent(s)}`,{method:"GET",headers:{"content-type":"application/json",authorization:`Bearer ${l}`}});return u})}var gt=!1,Ee=!1,Te=!1;if(typeof window!=="undefined"&&typeof window.localStorage!=="undefined")gt=!!window.localStorage.getItem("devBackend"),Ee=!!window.localStorage.getItem("__instantLogging"),Te=!!window.localStorage.getItem("__devtoolLocalDash");function ye(i,h){if(!h)return i;let t={};return h.forEach((s)=>{t[s]=i[s]}),t}function vn(i,h,t){var s,l;let u={peers:{}};if(h&&"user"in h?h.user:!0){let r=ye((s=i.user)!==null&&s!==void 0?s:{},h===null||h===void 0?void 0:h.keys);u.user=Object.assign(Object.assign({},r),{peerId:t})}for(let r of Object.keys((l=i.peers)!==null&&l!==void 0?l:{})){let f=(h===null||h===void 0?void 0:h.peers)===void 0,m=Array.isArray(h===null||h===void 0?void 0:h.peers)&&(h===null||h===void 0?void 0:h.peers.includes(r));if(f||m){let n=ye(i.peers[r],h===null||h===void 0?void 0:h.keys);u.peers[r]=Object.assign(Object.assign({},n),{peerId:r})}}return u}function En(i,h){if(i.isLoading!==h.isLoading)return!0;if(i.error!==h.error)return!0;if(i.user||h.user){if(!i.user||!h.user)return!0;if(!Vu(i.user,h.user))return!0}if(!Pu(i.peers,h.peers))return!0;for(let s of Object.keys(i.peers))if(!Vu(i.peers[s],h.peers[s]))return!0;return!1}class os{constructor(){this.promise=new Promise((i,h)=>{this._resolve=i,this._reject=h})}resolve(i){this._resolve(i)}reject(i){this._reject(i)}}var cs=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})};class Is{constructor(i,h,t,s,l=(r)=>{return JSON.stringify(r)},u=(r)=>{return JSON.parse(r)},e=100){this._subs=[],this._persister=i,this._key=h,this._onMerge=s,this._loadedCbs=[],this._isLoading=!0,this.currentValue=t,this.toJSON=l,this.fromJSON=u,this._saveThrottleMs=e,this._pendingSaveCbs=[],this._version=0,this._load()}_load(){return cs(this,void 0,void 0,function*(){let i=this.fromJSON(yield this._persister.getItem(this._key));this._isLoading=!1,this._onMerge(i,this.currentValue);for(let h of this._loadedCbs)h()})}waitForLoaded(){return cs(this,void 0,void 0,function*(){if(!this._isLoading)return;yield new Promise((h)=>{this._loadedCbs.push(h)})})}isLoading(){return this._isLoading}version(){return this._version}waitForSync(){return cs(this,void 0,void 0,function*(){if(!this._nextSave)return;yield new Promise((h)=>{this._pendingSaveCbs.push(h)})})}_writeToStorage(){this._persister.setItem(this._key,this.toJSON(this.currentValue));for(let i of this._pendingSaveCbs)i();this._pendingSaveCbs.length=0}flush(){return cs(this,void 0,void 0,function*(){if(!this._nextSave)return;clearTimeout(this._nextSave),this._writeToStorage()})}_enqueuePersist(i){if(this._nextSave){if(i)this._pendingSaveCbs.push(i);return}this._nextSave=setTimeout(()=>{this._nextSave=null,this._writeToStorage()},this._saveThrottleMs)}set(i,h){if(this._version++,this.currentValue=i(this.currentValue),this._isLoading)this._loadedCbs.push(()=>this._enqueuePersist(h));else this._enqueuePersist(h);for(let t of this._subs)t(this.currentValue)}subscribe(i){return this._subs.push(i),i(this.currentValue),()=>{this._subs=this._subs.filter((h)=>h!==i)}}}function Tn(i,h=[]){i.forEach((t)=>{let{data:s}=t,{"datalog-result":l}=s,{"join-rows":u}=l;for(let e of u)for(let r of e)h.push(r);Tn(t["child-nodes"],h)})}function Ne(i){let h=[];return Tn(i,h),h}function yn(i){return Object.values(i.links).reduce((h,t)=>{var s,l,u,e;return(s=h[u=t.forward.on])!==null&&s!==void 0||(h[u]={}),h[t.forward.on][t.forward.label]={isForward:!0,isSingular:t.forward.has==="one",link:t},(l=h[e=t.reverse.on])!==null&&l!==void 0||(h[e]={}),h[t.reverse.on][t.reverse.label]={isForward:!1,isSingular:t.reverse.has==="one",link:t},h},{})}var il="v0.18.9";function ze(i){return{info:i?console.info.bind(console):()=>{},debug:i?console.debug.bind(console):()=>{},error:i?console.error.bind(console):()=>{}}}var j=function(i,h,t,s){function l(u){return u instanceof t?u:new t(function(e){e(u)})}return new(t||(t=Promise))(function(u,e){function r(n){try{m(s.next(n))}catch(S){e(S)}}function f(n){try{m(s.throw(n))}catch(S){e(S)}}function m(n){n.done?u(n.value):l(n.value).then(r,f)}m((s=s.apply(i,h||[])).next())})},xi={CONNECTING:"connecting",OPENED:"opened",AUTHENTICATED:"authenticated",CLOSED:"closed",ERRORED:"errored"},yy=30000,Ny=0,Nn=1,zy={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"},Fe="_instant_oauth_redirect",Oe="currentUser",Fy=0;function Oy(i){let h=new WebSocket(i);return h._id=Fy++,h}function Ly(){return typeof window!=="undefined"||typeof chrome!=="undefined"}var zn={"set-presence":!0,"set-presence-ok":!0,"refresh-presence":!0,"patch-presence":!0};function Ky(i){var h;let t=JSON.parse(i);for(let s in t){let l=t[s];if((h=l===null||l===void 0?void 0:l.result)===null||h===void 0?void 0:h.store)l.result.store=Qm(l.result.store)}return t}function Gy(i){var h;let t={};for(let s in i){let l=i[s],u=Object.assign({},l);if((h=l.result)===null||h===void 0?void 0:h.store)u.result=Object.assign(Object.assign({},l.result),{store:Hm(l.result.store)});t[s]=u}return JSON.stringify(t)}class hl{constructor(i,h=Vh,t=jh,s){if(this._isOnline=!0,this._isShutdown=!1,this.status=xi.CONNECTING,this.queryCbs={},this.queryOnceDfds={},this.authCbs=[],this.attrsCbs=[],this.mutationErrorCbs=[],this.connectionStatusCbs=[],this.mutationDeferredStore=new Map,this._reconnectTimeoutId=null,this._reconnectTimeoutMs=0,this._localIdPromises={},this._errorMessage=null,this._oauthCallbackResponse=null,this._linkIndex=null,this._rooms={},this._roomsPendingLeave={},this._presence={},this._broadcastQueue=[],this._broadcastSubs={},this._currentUserCached={isLoading:!0,error:void 0,user:void 0},this._beforeUnloadCbs=[],this._dataForQueryCache={},this._onMergeQuerySubs=(l,u)=>{let e=l||{},r=Object.assign({},u);Object.entries(u).forEach(([m,n])=>{var S;let d=(S=e===null||e===void 0?void 0:e[m])===null||S===void 0?void 0:S.result,v=n.result;if(d&&!v)r[m].result=d}),Object.keys(e).filter((m)=>!u[m]).slice(0,10).forEach((m)=>{r[m]=e[m]}),this.querySubs.set((m)=>r),this.loadedNotifyAll()},this._onMergePendingMutations=(l,u)=>{let e=new Map([...l.entries(),...u.entries()]);this.pendingMutations.set((f)=>e),this.loadedNotifyAll(),this._rewriteMutations(this.attrs,l).forEach((f,m)=>{if(!u.has(m)&&!f["tx-id"])this._sendMutation(m,f)})},this.getPreviousResult=(l)=>{let u=o(l);return this.dataForQuery(u)},this.notifyOne=(l)=>{var u,e;let r=(u=this.queryCbs[l])!==null&&u!==void 0?u:[],f=(e=this._dataForQueryCache[l])===null||e===void 0?void 0:e.data,m=this.dataForQuery(l);if(!m)return;if(Xt(m,f))return;r.forEach((n)=>n.cb(m))},this.notifyOneQueryOnce=(l)=>{var u;let e=(u=this.queryOnceDfds[l])!==null&&u!==void 0?u:[],r=this.dataForQuery(l);e.forEach((f)=>{this._completeQueryOnce(f.q,l,f.dfd),f.dfd.resolve(r)})},this.notifyQueryError=(l,u)=>{(this.queryCbs[l]||[]).forEach((r)=>r.cb({error:u}))},this.pushTx=(l)=>{try{let u=tn({attrs:this.optimisticAttrs(),schema:this.config.schema},l);return this.pushOps(u)}catch(u){return this.pushOps([],u)}},this.pushOps=(l,u)=>{let e=M(),r={op:"transact","tx-steps":l,error:u};this.pendingMutations.set((m)=>{return m.set(e,r),m});let f=new os;return this.mutationDeferredStore.set(e,f),this._sendMutation(e,r),this.notifyAll(),f.promise},this._wsOnOpen=(l)=>{let u=l.target;if(this._ws!==u){this._log.info("[socket][open]",u._id,"skip; this is no longer the current ws");return}this._log.info("[socket][open]",this._ws._id),this._setStatus(xi.OPENED),this.getCurrentUser().then((e)=>{var r;this._trySend(M(),{op:"init","app-id":this.config.appId,"refresh-token":(r=e.user)===null||r===void 0?void 0:r.refresh_token,versions:this.versions,"__admin-token":this.config.__adminToken})})},this._wsOnMessage=(l)=>{let u=l.target,e=JSON.parse(l.data.toString());if(this._ws!==u){this._log.info("[socket][message]",u._id,e,"skip; this is no longer the current ws");return}this._handleReceive(u._id,JSON.parse(l.data.toString()))},this._wsOnError=(l)=>{let u=l.target;if(this._ws!==u){this._log.info("[socket][error]",u._id,"skip; this is no longer the current ws");return}this._log.error("[socket][error]",u._id,l)},this._wsOnClose=(l)=>{let u=l.target;if(this._ws!==u){this._log.info("[socket][close]",u._id,"skip; this is no longer the current ws");return}this._setStatus(xi.CLOSED);for(let e of Object.values(this._rooms))e.isConnected=!1;if(this._isShutdown){this._log.info("[socket][close]",u._id,"Reactor has been shut down and will not reconnect");return}this._log.info("[socket][close]",u._id,"schedule reconnect, ms =",this._reconnectTimeoutMs),setTimeout(()=>{if(this._reconnectTimeoutMs=Math.min(this._reconnectTimeoutMs+1000,1e4),!this._isOnline){this._log.info("[socket][close]",u._id,"we are offline, no need to start socket");return}this._startSocket()},this._reconnectTimeoutMs)},this.config=Object.assign(Object.assign({},zy),i),this._log=ze(i.verbose||gt||Ee),this.versions=Object.assign(Object.assign({},s||{}),{"@instantdb/core":il}),this.config.schema)this._linkIndex=yn(this.config.schema);if(!Ly())return;if(typeof BroadcastChannel==="function")this._broadcastChannel=new BroadcastChannel("@instantdb"),this._broadcastChannel.addEventListener("message",(l)=>j(this,void 0,void 0,function*(){var u;if(((u=l.data)===null||u===void 0?void 0:u.type)==="auth"){let e=yield this.getCurrentUser();this.updateUser(e.user)}}));if(this._oauthCallbackResponse=this._oauthLoginInit(),this._initStorage(h),this.getCurrentUser(),t.getIsOnline().then((l)=>{this._isOnline=l,this._startSocket(),t.listen((u)=>{if(u===this._isOnline)return;if(this._log.info("[network] online =",u),this._isOnline=u,this._isOnline)this._startSocket();else this._log.info("Changing status from",this.status,"to",xi.CLOSED),this._setStatus(xi.CLOSED)})}),typeof addEventListener!=="undefined")this._beforeUnload=this._beforeUnload.bind(this),addEventListener("beforeunload",this._beforeUnload)}_initStorage(i){this._persister=new i(`instant_${this.config.appId}_5`),this.querySubs=new Is(this._persister,"querySubs",{},this._onMergeQuerySubs,Gy,Ky),this.pendingMutations=new Is(this._persister,"pendingMutations",new Map,this._onMergePendingMutations,(h)=>{return JSON.stringify([...h.entries()])},(h)=>{return new Map(JSON.parse(h))}),this._beforeUnloadCbs.push(()=>{this.pendingMutations.flush(),this.querySubs.flush()})}_beforeUnload(){for(let i of this._beforeUnloadCbs)i()}_finishTransaction(i,h,t){let s=this.mutationDeferredStore.get(h);this.mutationDeferredStore.delete(h);let l=i!=="error"&&i!=="timeout";if(!s&&!l)console.error("Mutation failed",Object.assign({status:i,clientId:h},t));if(!s)return;if(l)s.resolve({status:i,clientId:h});else s.reject(Object.assign({status:i,clientId:h},t))}_setStatus(i,h){this.status=i,this._errorMessage=h,this.notifyConnectionStatusSubs(i)}_flushEnqueuedRoomData(i){var h,t;let s=(t=(h=this._presence[i])===null||h===void 0?void 0:h.result)===null||t===void 0?void 0:t.user,l=this._broadcastQueue[i];if(this._broadcastQueue[i]=[],s)this._trySetPresence(i,s);if(l)for(let u of l){let{topic:e,roomType:r,data:f}=u;this._tryBroadcast(i,r,e,f)}}_handleReceive(i,h){var t,s,l,u;let e=Boolean(this.config.schema)&&("cardinalityInference"in this.config?Boolean(this.config.cardinalityInference):!0);if(!zn[h.op])this._log.info("[receive]",i,h.op,h);switch(h.op){case"init-ok":this._setStatus(xi.AUTHENTICATED),this._reconnectTimeoutMs=0,this._setAttrs(h.attrs),this._flushPendingMessages(),this._sessionId=h["session-id"];for(let K of Object.keys(this._rooms))this._tryJoinRoom(K);break;case"add-query-exists":this.notifyOneQueryOnce(o(h.q));break;case"add-query-ok":let{q:r,result:f}=h,m=o(r),n=(s=(t=f===null||f===void 0?void 0:f[0])===null||t===void 0?void 0:t.data)===null||s===void 0?void 0:s["page-info"],S=(u=(l=f===null||f===void 0?void 0:f[0])===null||l===void 0?void 0:l.data)===null||u===void 0?void 0:u.aggregate,d=Ne(f),v=xs(this.attrs,d,e,this._linkIndex);this.querySubs.set((K)=>{return K[m].result={store:v,pageInfo:n,aggregate:S},K}),this.notifyOne(m),this.notifyOneQueryOnce(m);break;case"refresh-ok":let{computations:b,attrs:w}=h;this._setAttrs(w);let T=b.map((K)=>{var G,x,_,k;let U=K["instaql-query"],$=K["instaql-result"],ui=o(U),rh=Ne($),pi=xs(this.attrs,rh,e,this._linkIndex),Ni=(x=(G=$===null||$===void 0?void 0:$[0])===null||G===void 0?void 0:G.data)===null||x===void 0?void 0:x["page-info"],Gi=(k=(_=$===null||$===void 0?void 0:$[0])===null||_===void 0?void 0:_.data)===null||k===void 0?void 0:k.aggregate;return{hash:ui,store:pi,pageInfo:Ni,aggregate:Gi}});T.forEach(({hash:K,store:G,pageInfo:x,aggregate:_})=>{this.querySubs.set((k)=>{return k[K].result={store:G,pageInfo:x,aggregate:_},k})}),T.forEach(({hash:K})=>{this.notifyOne(K)});break;case"transact-ok":let{"client-event-id":E,"tx-id":N}=h,F=this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).get(E);if(!F)break;this.pendingMutations.set((K)=>{return K.delete(E),K});let O=F["tx-steps"];this.querySubs.set((K)=>{var G;for(let[x,_]of Object.entries(K)){let k=(G=_===null||_===void 0?void 0:_.result)===null||G===void 0?void 0:G.store;if(!k)continue;let U=ou(k,O);K[x].result.store=U}return K});let L=F["tx-steps"].filter(([K,...G])=>K==="add-attr").map(([K,G])=>G).concat(Object.values(this.attrs));this._setAttrs(L),this._finishTransaction("synced",E);break;case"patch-presence":{let K=h["room-id"];this._patchPresencePeers(K,h.edits),this._notifyPresenceSubs(K);break}case"refresh-presence":{let K=h["room-id"];this._setPresencePeers(K,h.data),this._notifyPresenceSubs(K);break}case"server-broadcast":let Y=h["room-id"],g=h.topic;this._notifyBroadcastSubs(Y,g,h);break;case"join-room-ok":let C=h["room-id"],Si=this._rooms[C];if(!Si){if(this._roomsPendingLeave[C])this._tryLeaveRoom(C),delete this._roomsPendingLeave[C];break}Si.isConnected=!0,this._notifyPresenceSubs(C),this._flushEnqueuedRoomData(C);break;case"join-room-error":let li=h["room-id"],Ki=this._rooms[li];if(Ki)Ki.error=h.error;this._notifyPresenceSubs(li);break;case"error":this._handleReceiveError(h);break;default:break}}_handleMutationError(i,h,t){let s=this.pendingMutations.currentValue.get(h);if(s&&(i!=="timeout"||!s["tx-id"]))this.pendingMutations.set((l)=>{return l.delete(h),l}),this.notifyAll(),this.notifyAttrsSubs(),this.notifyMutationErrorSubs(t),this._finishTransaction(i,h,t)}_handleReceiveError(i){var h,t,s,l,u;let e=i["client-event-id"],r=this.pendingMutations.currentValue.get(e),f={message:i.message||"Uh-oh, something went wrong. Ping Joe & Stopa."};if(i.hint)f.hint=i.hint;if(r){let S={message:i.message,hint:i.hint};this._handleMutationError("error",e,S);return}if(((h=i["original-event"])===null||h===void 0?void 0:h.hasOwnProperty("q"))&&((t=i["original-event"])===null||t===void 0?void 0:t.op)==="add-query"){let S=(s=i["original-event"])===null||s===void 0?void 0:s.q,d=o(S);this.notifyQueryError(o(S),f),this.notifyQueryOnceError(S,d,e,f);return}if(((l=i["original-event"])===null||l===void 0?void 0:l.op)==="init"){if(i.type==="record-not-found"&&((u=i.hint)===null||u===void 0?void 0:u["record-type"])==="app-user"){this.changeCurrentUser(null);return}this._setStatus(xi.ERRORED,f),this.notifyAll();return}let n=Object.assign({},i);if(delete n.message,delete n.hint,console.error(i.message,n),i.hint)console.error(`This error comes with some debugging information. Here it is: 
`,i.hint)}notifyQueryOnceError(i,h,t,s){var l;let u=(l=this.queryOnceDfds[h])===null||l===void 0?void 0:l.find((e)=>e.eventId===t);if(!u)return;u.dfd.reject(s),this._completeQueryOnce(i,h,u.dfd)}_setAttrs(i){this.attrs=i.reduce((h,t)=>{return h[t.id]=t,h},{}),this.notifyAttrsSubs()}_startQuerySub(i,h){let t=M();return this.querySubs.set((s)=>{return s[h]=s[h]||{q:i,result:null,eventId:t},s}),this._trySendAuthed(t,{op:"add-query",q:i}),t}subscribeQuery(i,h,t){var s;if(t&&"ruleParams"in t)i=Object.assign({$$ruleParams:t.ruleParams},i);let l=o(i),u=this.getPreviousResult(i);if(u)h(u);return this.queryCbs[l]=(s=this.queryCbs[l])!==null&&s!==void 0?s:[],this.queryCbs[l].push({q:i,cb:h}),this._startQuerySub(i,l),()=>{this._unsubQuery(i,l,h)}}queryOnce(i,h){var t;if(h&&"ruleParams"in h)i=Object.assign({$$ruleParams:h.ruleParams},i);let s=new os;if(!this._isOnline)return s.reject(new Error("We can't run `queryOnce`, because the device is offline.")),s.promise;if(!this.querySubs)return s.reject(new Error("We can't run `queryOnce` on the backend. Use adminAPI.query instead: https://www.instantdb.com/docs/backend#query")),s.promise;let l=o(i),u=this._startQuerySub(i,l);return this.queryOnceDfds[l]=(t=this.queryOnceDfds[l])!==null&&t!==void 0?t:[],this.queryOnceDfds[l].push({q:i,dfd:s,eventId:u}),setTimeout(()=>s.reject(new Error("Query timed out")),yy),s.promise}_completeQueryOnce(i,h,t){if(!this.queryOnceDfds[h])return;this.queryOnceDfds[h]=this.queryOnceDfds[h].filter((s)=>s.dfd!==t),this._cleanupQuery(i,h)}_unsubQuery(i,h,t){if(!this.queryCbs[h])return;this.queryCbs[h]=this.queryCbs[h].filter((s)=>s.cb!==t),this._cleanupQuery(i,h)}_cleanupQuery(i,h){var t,s;if(((t=this.queryCbs[h])===null||t===void 0?void 0:t.length)||((s=this.queryOnceDfds[h])===null||s===void 0?void 0:s.length))return;delete this.queryCbs[h],delete this.queryOnceDfds[h],this._trySendAuthed(M(),{op:"remove-query",q:i})}_rewriteMutations(i,h){if(!i)return h;let t=(r)=>{let[f,m,n]=r["forward-identity"];return p(i,m,n)},s=(r)=>{let[f,m,n]=r["forward-identity"];return lh(i,m,n)},l={attrIdMap:{},refSwapAttrIds:new Set},u=(r)=>{let f=[];for(let m of r){let[n]=m;if(n==="add-attr"){let[d,v]=m,b=t(v);if(b){l.attrIdMap[v.id]=b.id;continue}if(v["value-type"]==="ref"){let w=s(v);if(w){l.attrIdMap[v.id]=w.id,l.refSwapAttrIds.add(v.id);continue}}}let S=Im(l,m);f.push(S)}return f},e=new Map;for(let[r,f]of h.entries())e.set(r,Object.assign(Object.assign({},f),{"tx-steps":u(f["tx-steps"])}));return e}optimisticAttrs(){var i;let h=[...this.pendingMutations.currentValue.values()].flatMap((e)=>e["tx-steps"]),t=new Set(h.filter(([e,r])=>e==="delete-attr").map(([e,r])=>r)),s=[];for(let[e,r]of h)if(e==="add-attr")s.push(r);else if(e==="update-attr"&&r.id&&((i=this.attrs)===null||i===void 0?void 0:i[r.id])){let f=Object.assign(Object.assign({},this.attrs[r.id]),r);s.push(f)}let l=[...Object.values(this.attrs||{}),...s].filter((e)=>!t.has(e.id));return Object.fromEntries(l.map((e)=>[e.id,e]))}dataForQuery(i){let h=this._errorMessage;if(h)return{error:h};if(!this.querySubs)return;if(!this.pendingMutations)return;let t=this.querySubs.version(),s=this.querySubs.currentValue,l=this.pendingMutations.version(),u=this.pendingMutations.currentValue,{q:e,result:r}=s[i]||{};if(!r)return;let f=this._dataForQueryCache[i];if(f&&t===f.querySubVersion&&l===f.pendingMutationsVersion)return f.data;let{store:m,pageInfo:n,aggregate:S}=r,v=[...this._rewriteMutations(m.attrs,u).values()].flatMap((T)=>T["tx-steps"]),b=ou(m,v),w=ue({store:b,pageInfo:n,aggregate:S},e);return this._dataForQueryCache[i]={querySubVersion:t,pendingMutationsVersion:l,data:w},w}notifyAll(){Object.keys(this.queryCbs).forEach((i)=>{this.notifyOne(i)})}loadedNotifyAll(){if(this.pendingMutations.isLoading()||this.querySubs.isLoading())return;this.notifyAll()}shutdown(){var i;this._isShutdown=!0,(i=this._ws)===null||i===void 0||i.close()}_sendMutation(i,h){if(h.error){this._handleMutationError("error",i,{error:h.error,message:h.error.message});return}if(this.status!==xi.AUTHENTICATED){this._finishTransaction("enqueued",i);return}let t=Math.max(5000,this.pendingMutations.currentValue.size*5000);if(!this._isOnline)this._finishTransaction("enqueued",i);else this._trySend(i,h),setTimeout(()=>{this._finishTransaction("pending",i)},3000),setTimeout(()=>{if(!this._isOnline)return;this._handleMutationError("timeout",i,{message:"transaction timed out"})},t)}_flushPendingMessages(){Object.keys(this.queryCbs).map((s)=>{return this.querySubs.currentValue[s]}).filter((s)=>s).forEach(({eventId:s,q:l})=>{this._trySendAuthed(s,{op:"add-query",q:l})}),Object.values(this.queryOnceDfds).flat().forEach(({eventId:s,q:l})=>{this._trySendAuthed(s,{op:"add-query",q:l})}),this._rewriteMutations(this.attrs,this.pendingMutations.currentValue).forEach((s,l)=>{if(!s["tx-id"])this._sendMutation(l,s)})}_trySendAuthed(...i){if(this.status!==xi.AUTHENTICATED)return;this._trySend(...i)}_trySend(i,h,t){if(this._ws.readyState!==Nn)return;if(!zn[h.op])this._log.info("[send]",this._ws._id,h.op,h);this._ws.send(JSON.stringify(Object.assign({"client-event-id":i},h)))}_startSocket(){if(this._ws&&this._ws.readyState==Ny){this._log.info("[socket][start]",this._ws._id,"maintained as current ws, we were still in a connecting state");return}let i=this._ws;if(this._ws=Oy(`${this.config.websocketURI}?app_id=${this.config.appId}`),this._ws.onopen=this._wsOnOpen,this._ws.onmessage=this._wsOnMessage,this._ws.onclose=this._wsOnClose,this._ws.onerror=this._wsOnError,this._log.info("[socket][start]",this._ws._id),(i===null||i===void 0?void 0:i.readyState)===Nn)this._log.info("[socket][start]",this._ws._id,"close previous ws id = ",i._id),i.close()}getLocalId(i){return j(this,void 0,void 0,function*(){let h=`localToken_${i}`,t=yield this._persister.getItem(h);if(t)return t;if(this._localIdPromises[h])return this._localIdPromises[h];let s=M();return this._localIdPromises[h]=this._persister.setItem(h,s).then(()=>s),this._localIdPromises[h]})}_replaceUrlAfterOAuth(){if(typeof URL==="undefined")return;let i=new URL(window.location.href);if(i.searchParams.get(Fe)){let h=i.toString();i.searchParams.delete(Fe),i.searchParams.delete("code"),i.searchParams.delete("error");let t=i.pathname+(i.searchParams.size?"?"+i.searchParams:"")+i.hash;if(history.replaceState(history.state,"",t),typeof navigation==="object"&&typeof navigation.addEventListener==="function"&&typeof navigation.removeEventListener==="function"){let s=!1,l=(u)=>{var e;if(!s){if(s=!0,navigation.removeEventListener("navigate",l),!u.userInitiated&&u.navigationType==="replace"&&((e=u.destination)===null||e===void 0?void 0:e.url)===h)history.replaceState(history.state,"",t)}};navigation.addEventListener("navigate",l)}}}_oauthLoginInit(){return j(this,void 0,void 0,function*(){var i,h,t,s;if(typeof window==="undefined"||typeof window.location==="undefined"||typeof URLSearchParams==="undefined")return null;let l=new URLSearchParams(window.location.search);if(!l.get(Fe))return null;let u=l.get("error");if(u)return this._replaceUrlAfterOAuth(),{error:{message:u}};let e=l.get("code");if(!e)return null;this._replaceUrlAfterOAuth();try{let{user:r}=yield ve({apiURI:this.config.apiURI,appId:this.config.appId,code:e});return this.setCurrentUser(r),null}catch(r){if(((i=r===null||r===void 0?void 0:r.body)===null||i===void 0?void 0:i.type)==="record-not-found"&&((t=(h=r===null||r===void 0?void 0:r.body)===null||h===void 0?void 0:h.hint)===null||t===void 0?void 0:t["record-type"])==="app-oauth-code"&&(yield this._hasCurrentUser()))return null;return{error:{message:((s=r===null||r===void 0?void 0:r.body)===null||s===void 0?void 0:s.message)||"Error logging in."}}}})}_waitForOAuthCallbackResponse(){return j(this,void 0,void 0,function*(){return yield this._oauthCallbackResponse})}__subscribeMutationErrors(i){return this.mutationErrorCbs.push(i),()=>{this.mutationErrorCbs=this.mutationErrorCbs.filter((h)=>h!==i)}}subscribeAuth(i){this.authCbs.push(i);let h=this._currentUserCached;if(!h.isLoading)i(this._currentUserCached);let t=!1;return this.getCurrentUser().then((s)=>{if(t)return;if(Xt(s,h))return;i(s)}),()=>{t=!0,this.authCbs=this.authCbs.filter((s)=>s!==i)}}getAuth(){return j(this,void 0,void 0,function*(){let{user:i,error:h}=yield this.getCurrentUser();if(h)throw h;return i})}subscribeConnectionStatus(i){return this.connectionStatusCbs.push(i),()=>{this.connectionStatusCbs=this.connectionStatusCbs.filter((h)=>h!==i)}}subscribeAttrs(i){if(this.attrsCbs.push(i),this.attrs)i(this.attrs);return()=>{this.attrsCbs=this.attrsCbs.filter((h)=>h!==i)}}notifyAuthSubs(i){this.authCbs.forEach((h)=>h(i))}notifyMutationErrorSubs(i){this.mutationErrorCbs.forEach((h)=>h(i))}notifyAttrsSubs(){if(!this.attrs)return;let i=this.optimisticAttrs();this.attrsCbs.forEach((h)=>h(i))}notifyConnectionStatusSubs(i){this.connectionStatusCbs.forEach((h)=>h(i))}setCurrentUser(i){return j(this,void 0,void 0,function*(){yield this._persister.setItem(Oe,JSON.stringify(i))})}getCurrentUserCached(){return this._currentUserCached}getCurrentUser(){return j(this,void 0,void 0,function*(){let i=yield this._waitForOAuthCallbackResponse();if(i===null||i===void 0?void 0:i.error){let s={error:i.error,user:void 0};return this._currentUserCached=Object.assign({isLoading:!1},s),s}let h=yield this._persister.getItem(Oe),t={user:JSON.parse(h),error:void 0};return this._currentUserCached=Object.assign({isLoading:!1},t),t})}_hasCurrentUser(){return j(this,void 0,void 0,function*(){let i=yield this._persister.getItem(Oe);return JSON.parse(i)!=null})}changeCurrentUser(i){return j(this,void 0,void 0,function*(){var h;let{user:t}=yield this.getCurrentUser();if(Xt(t,i))return;yield this.setCurrentUser(i),this.updateUser(i);try{(h=this._broadcastChannel)===null||h===void 0||h.postMessage({type:"auth"})}catch(s){console.error("Error posting message to broadcast channel",s)}})}updateUser(i){let h={error:void 0,user:i};this._currentUserCached=Object.assign({isLoading:!1},h),this._dataForQueryCache={},this.querySubs.set((t)=>{return Object.keys(t).forEach((s)=>{delete t[s].result}),t}),this._reconnectTimeoutMs=0,this._ws.close(),this._oauthCallbackResponse=null,this.notifyAuthSubs(h)}sendMagicCode({email:i}){return ln({apiURI:this.config.apiURI,appId:this.config.appId,email:i})}signInWithMagicCode(i){return j(this,arguments,void 0,function*({email:h,code:t}){let s=yield un({apiURI:this.config.apiURI,appId:this.config.appId,email:h,code:t});return yield this.changeCurrentUser(s.user),s})}signInWithCustomToken(i){return j(this,void 0,void 0,function*(){let h=yield en({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:i});return yield this.changeCurrentUser(h.user),h})}potentiallyInvalidateToken(i,h){var t;let s=(t=i===null||i===void 0?void 0:i.user)===null||t===void 0?void 0:t.refresh_token;if(!s)return;if(h.invalidateToken===!1){this._log.info("[auth-invalidate] skipped invalidateToken");return}fn({apiURI:this.config.apiURI,appId:this.config.appId,refreshToken:s}).then(()=>{this._log.info("[auth-invalidate] completed invalidateToken")}).catch((u)=>{})}signOut(i){return j(this,void 0,void 0,function*(){let h=yield this.getCurrentUser();this.potentiallyInvalidateToken(h,i),yield this.changeCurrentUser(null)})}createAuthorizationURL({clientName:i,redirectURL:h}){let{apiURI:t,appId:s}=this.config;return`${t}/runtime/oauth/start?app_id=${s}&client_name=${i}&redirect_uri=${h}`}exchangeCodeForToken(i){return j(this,arguments,void 0,function*({code:h,codeVerifier:t}){let s=yield ve({apiURI:this.config.apiURI,appId:this.config.appId,code:h,codeVerifier:t});return yield this.changeCurrentUser(s.user),s})}issuerURI(){let{apiURI:i,appId:h}=this.config;return`${i}/runtime/${h}`}signInWithIdToken(i){return j(this,arguments,void 0,function*({idToken:h,clientName:t,nonce:s}){var l;let u=yield this.getCurrentUser(),e=(l=u===null||u===void 0?void 0:u.user)===null||l===void 0?void 0:l.refresh_token,r=yield rn({apiURI:this.config.apiURI,appId:this.config.appId,idToken:h,clientName:t,nonce:s,refreshToken:e});return yield this.changeCurrentUser(r.user),r})}joinRoom(i){if(!this._rooms[i])this._rooms[i]={isConnected:!1,error:void 0};return this._presence[i]=this._presence[i]||{},this._tryJoinRoom(i),()=>{this._cleanupRoom(i)}}_cleanupRoom(i){var h,t,s,l;if(!((t=(h=this._presence[i])===null||h===void 0?void 0:h.handlers)===null||t===void 0?void 0:t.length)&&!Object.keys((s=this._broadcastSubs[i])!==null&&s!==void 0?s:{}).length){let u=(l=this._rooms[i])===null||l===void 0?void 0:l.isConnected;if(delete this._rooms[i],delete this._presence[i],delete this._broadcastSubs[i],u)this._tryLeaveRoom(i);else this._roomsPendingLeave[i]=!0}}getPresence(i,h,t={}){let s=this._rooms[h],l=this._presence[h];if(!s||!l||!l.result)return null;return Object.assign(Object.assign({},vn(l.result,t,this._sessionId)),{isLoading:!s.isConnected,error:s.error})}publishPresence(i,h,t){let s=this._rooms[h],l=this._presence[h];if(!s||!l)return;l.result=l.result||{};let u=Object.assign(Object.assign({},l.result.user),t);if(l.result.user=u,!s.isConnected)return;this._trySetPresence(h,u),this._notifyPresenceSubs(h)}_trySetPresence(i,h){this._trySendAuthed(M(),{op:"set-presence","room-id":i,data:h})}_tryJoinRoom(i){this._trySendAuthed(M(),{op:"join-room","room-id":i}),delete this._roomsPendingLeave[i]}_tryLeaveRoom(i){this._trySendAuthed(M(),{op:"leave-room","room-id":i})}subscribePresence(i,h,t,s){let l=this.joinRoom(h),u=Object.assign(Object.assign({},t),{roomId:h,cb:s,prev:null});return this._presence[h]=this._presence[h]||{},this._presence[h].handlers=this._presence[h].handlers||[],this._presence[h].handlers.push(u),this._notifyPresenceSub(h,u),()=>{var e,r,f;this._presence[h].handlers=(f=(r=(e=this._presence[h])===null||e===void 0?void 0:e.handlers)===null||r===void 0?void 0:r.filter((m)=>m!==u))!==null&&f!==void 0?f:[],l()}}_notifyPresenceSubs(i){var h,t;(t=(h=this._presence[i])===null||h===void 0?void 0:h.handlers)===null||t===void 0||t.forEach((s)=>{this._notifyPresenceSub(i,s)})}_notifyPresenceSub(i,h){let t=this.getPresence("",i,h);if(!t)return;if(h.prev&&!En(t,h.prev))return;h.prev=t,h.cb(t)}_patchPresencePeers(i,h){var t,s,l;let u=((s=(t=this._presence[i])===null||t===void 0?void 0:t.result)===null||s===void 0?void 0:s.peers)||{},e=Object.fromEntries(Object.entries(u).map(([m,n])=>[m,{data:n}])),r=(l=this._presence[i])===null||l===void 0?void 0:l.result,f=Gt(e,(m)=>{for(let[n,S,d]of h)switch(S){case"+":Ym(m,n,d);break;case"r":xu(m,n,d);break;case"-":Du(m,n);break}delete m[this._sessionId]});this._setPresencePeers(i,f)}_setPresencePeers(i,h){let t=Object.assign({},h);delete t[this._sessionId];let s=Object.fromEntries(Object.entries(t).map(([l,u])=>[l,u.data]));this._presence=Gt(this._presence,(l)=>{xu(l,[i,"result","peers"],s)})}publishTopic({roomType:i,roomId:h,topic:t,data:s}){var l;let u=this._rooms[h];if(!u)return;if(!u.isConnected){this._broadcastQueue[h]=(l=this._broadcastQueue[h])!==null&&l!==void 0?l:[],this._broadcastQueue[h].push({topic:t,roomType:i,data:s});return}this._tryBroadcast(h,i,t,s)}_tryBroadcast(i,h,t,s){this._trySendAuthed(M(),{op:"client-broadcast","room-id":i,roomType:h,topic:t,data:s})}subscribeTopic(i,h,t){let s=this.joinRoom(i);return this._broadcastSubs[i]=this._broadcastSubs[i]||{},this._broadcastSubs[i][h]=this._broadcastSubs[i][h]||[],this._broadcastSubs[i][h].push(t),this._presence[i]=this._presence[i]||{},()=>{if(this._broadcastSubs[i][h]=this._broadcastSubs[i][h].filter((l)=>l!==t),!this._broadcastSubs[i][h].length)delete this._broadcastSubs[i][h];s()}}_notifyBroadcastSubs(i,h,t){var s,l,u;(u=(l=(s=this._broadcastSubs)===null||s===void 0?void 0:s[i])===null||l===void 0?void 0:l[h])===null||u===void 0||u.forEach((e)=>{var r,f,m,n,S,d;let v=(r=t.data)===null||r===void 0?void 0:r.data,b=t.data["peer-id"]===this._sessionId?(m=(f=this._presence[i])===null||f===void 0?void 0:f.result)===null||m===void 0?void 0:m.user:(d=(S=(n=this._presence[i])===null||n===void 0?void 0:n.result)===null||S===void 0?void 0:S.peers)===null||d===void 0?void 0:d[t.data["peer-id"]];return e(v,b)})}uploadFile(i,h,t){return j(this,void 0,void 0,function*(){var s;let l=yield this.getCurrentUser(),u=(s=l===null||l===void 0?void 0:l.user)===null||s===void 0?void 0:s.refresh_token;return mn(Object.assign(Object.assign({},t),{apiURI:this.config.apiURI,appId:this.config.appId,path:i,file:h,refreshToken:u}))})}deleteFile(i){return j(this,void 0,void 0,function*(){var h;let t=yield this.getCurrentUser(),s=(h=t===null||t===void 0?void 0:t.user)===null||h===void 0?void 0:h.refresh_token;return yield nn({apiURI:this.config.apiURI,appId:this.config.appId,path:i,refreshToken:s})})}upload(i,h){return j(this,void 0,void 0,function*(){var t;let s=yield this.getCurrentUser(),l=(t=s===null||s===void 0?void 0:s.user)===null||t===void 0?void 0:t.refresh_token,u=i||h.name,e=yield Sn({apiURI:this.config.apiURI,appId:this.config.appId,fileName:u,refreshToken:l});return yield bn(e,h)})}getDownloadUrl(i){return j(this,void 0,void 0,function*(){var h;let t=yield this.getCurrentUser(),s=(h=t===null||t===void 0?void 0:t.user)===null||h===void 0?void 0:h.refresh_token;return yield dn({apiURI:this.config.apiURI,appId:this.config.appId,path:i,refreshToken:s})})}}var tl;function Fn(i,h){tl===null||tl===void 0||tl.dispose();let t=Zy(h),s=Cy(h,r),l=Xy(Yy(i));function u(n){var S;if(n.source!==l.element.contentWindow)return;if(((S=n.data)===null||S===void 0?void 0:S.type)==="close"&&t.isVisible())r()}function e(n){let S=n.shiftKey&&n.ctrlKey&&n.key==="0",d=n.key==="Escape"||n.key==="Esc";if(S)r();else if(d&&t.isVisible())r()}function r(){if(t.isVisible())t.element.style.display="none";else if(t.element.style.display="block",!t.element.contains(l.element))t.element.appendChild(l.element)}function f(){t.element.remove(),s.element.remove(),removeEventListener("keydown",e),removeEventListener("message",u)}function m(){document.body.appendChild(t.element),document.body.appendChild(s.element),addEventListener("keydown",e),addEventListener("message",u),tl={dispose:f}}return m()}function Yy(i){return`${gt||Te?"http://localhost:3000":"https://instantdb.com"}/_devtool?appId=${i}`}function Xy(i){let h=document.createElement("iframe");return h.src=i,h.className="instant-devtool-iframe",Object.assign(h.style,{width:"100%",height:"100%",backgroundColor:"white",border:"none"}),{element:h}}function Cy(i,h){let s=document.createElement("button");return s.innerHTML=`
    <svg width="32" height="32" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="512" height="512" fill="black"/>
      <rect x="97.0973" y="91.3297" width="140" height="330" fill="white"/>
    </svg>
  `,s.className="instant-devtool-toggler",Object.assign(s.style,Object.assign(Object.assign({position:"fixed"},Hy(i.position)),{height:"32px",width:"32px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:"9010",padding:"0",margin:"0",border:"none",cursor:"pointer"})),s.addEventListener("click",h),{element:s}}function Hy(i){switch(i){case"bottom-left":return{bottom:"24px",left:"24px"};case"bottom-right":return{bottom:"24px",right:"24px"};case"top-right":return{top:"24px",right:"24px"};case"top-left":return{top:"24px",left:"24px"}}}function Qy(i){switch(i){case"bottom-left":return{bottom:"24px",right:"24px",left:"60px",top:"72px"};case"bottom-right":return{bottom:"24px",left:"24px",right:"60px",top:"72px"};case"top-right":return{top:"24px",left:"24px",right:"60px",bottom:"72px"};case"top-left":return{top:"24px",right:"24px",left:"60px",bottom:"72px"}}}function Zy(i){let h=document.createElement("div");Object.assign(h.style,Object.assign(Object.assign({position:"fixed"},Qy(i.position)),{display:"block",borderRadius:"4px",border:"1px #ccc solid",boxShadow:"0px 0px 8px #00000044",backgroundColor:"#eee",zIndex:"999990"})),h.style.display="none",h.className="instant-devtool-container";function t(){return h.style.display!=="none"}return{element:h,isVisible:t}}var gy={apiURI:"https://api.instantdb.com",websocketURI:"wss://api.instantdb.com/runtime/session"};function Jy(){var i;return globalThis.__instantDbStore=(i=globalThis.__instantDbStore)!==null&&i!==void 0?i:{},globalThis.__instantDbStore}function Le(i){let h=i.__adminToken;return i.appId+"_"+(i.websocketURI||"default_ws_uri")+"_"+(i.apiURI||"default_api_uri")+"_"+(h||"client_only")}var Ke=Jy();class On{constructor(i){this.db=i,this.sendMagicCode=(h)=>{return this.db.sendMagicCode(h)},this.signInWithMagicCode=(h)=>{return this.db.signInWithMagicCode(h)},this.signInWithToken=(h)=>{return this.db.signInWithCustomToken(h)},this.createAuthorizationURL=(h)=>{return this.db.createAuthorizationURL(h)},this.signInWithIdToken=(h)=>{return this.db.signInWithIdToken(h)},this.exchangeOAuthCode=(h)=>{return this.db.exchangeCodeForToken(h)},this.issuerURI=()=>{return this.db.issuerURI()},this.signOut=(h={invalidateToken:!0})=>{return this.db.signOut(h)}}}class Ln{constructor(i){this.db=i,this.uploadFile=(h,t,s={})=>{return this.db.uploadFile(h,t,s)},this.delete=(h)=>{return this.db.deleteFile(h)},this.upload=(h,t)=>{return this.db.upload(h,t)},this.put=this.upload,this.getDownloadUrl=(h)=>{return this.db.getDownloadUrl(h)}}}class Kn{constructor(i){this.tx=fe(),this._reactor=i,this.auth=new On(this._reactor),this.storage=new Ln(this._reactor)}transact(i){return this._reactor.pushTx(i)}getLocalId(i){return this._reactor.getLocalId(i)}subscribeQuery(i,h,t){return this._reactor.subscribeQuery(i,h,t)}subscribeAuth(i){return this._reactor.subscribeAuth(i)}getAuth(){return this._reactor.getAuth()}subscribeConnectionStatus(i){return this._reactor.subscribeConnectionStatus(i)}joinRoom(i="_defaultRoomType",h="_defaultRoomId"){return{leaveRoom:this._reactor.joinRoom(h),subscribeTopic:(s,l)=>this._reactor.subscribeTopic(h,s,l),subscribePresence:(s,l)=>this._reactor.subscribePresence(i,h,s,l),publishTopic:(s,l)=>this._reactor.publishTopic({roomType:i,roomId:h,topic:s,data:l}),publishPresence:(s)=>this._reactor.publishPresence(i,h,s),getPresence:(s)=>this._reactor.getPresence(i,h,s)}}shutdown(){delete Ke[Le(this._reactor.config)],this._reactor.shutdown()}queryOnce(i,h){return this._reactor.queryOnce(i,h)}}function Gn(i,h,t,s){let l=Ke[Le(i)];if(l)return l;let u=new hl(Object.assign(Object.assign(Object.assign({},gy),i),{cardinalityInference:i.schema?!0:!1}),h||Vh,t||jh,Object.assign(Object.assign({},s||{}),{"@instantdb/core":il})),e=new Kn(u);return Ke[Le(i)]=e,Wy(i.appId,i.devtool),e}function Wy(i,h){if(typeof window==="undefined"||typeof window.location==="undefined"||typeof document==="undefined")return;if(typeof h==="boolean"&&!h)return;let t=Object.assign({position:"bottom-right",allowedHosts:["localhost"]},typeof h==="object"?h:{});if(!t.allowedHosts.includes(window.location.hostname))return;Fn(i,t)}u0(),S0(),Hs(),Uf(),wu();var Ge=Symbol.for("#beforeReconcile"),yi=Symbol.for("##up"),eh=Symbol.for("#afterVisit"),Di=Symbol.for("#placeChild"),Ye=Symbol.for("#afterReconcile"),Yn=Symbol.for("#getRenderContext"),Xn=Symbol(),Cn=Symbol(),Hn=Symbol(),Qn=Symbol(),Zn=Symbol(),gn=Symbol(),Jn=Symbol(),Wn=Symbol(),Bn=Symbol(),Rn=Symbol(),Mn=Symbol(),Un=Symbol(),qn=Symbol(),Pn=Symbol(),Vn=Symbol(),jn=Symbol(),An=Symbol(),xn=Symbol(),Dn=Symbol(),pn=Symbol(),_n=Symbol(),kn=Symbol(),$n=Symbol(),an=Symbol(),on=Symbol(),cn=Symbol(),In=Symbol(),iS=Symbol(),hS=Symbol(),tS=Symbol(),sS=Symbol(),lS=Symbol(),By=Symbol(),uS=Symbol(),eS=Symbol(),rS=Symbol(),fS=Symbol(),mS=Symbol(),nS=Symbol(),SS=Symbol(),bS=Symbol(),dS=Symbol(),wS=Symbol(),vS=Symbol(),Ry=Symbol(),ES=Symbol(),TS=Symbol(),yS=Symbol(),NS=Symbol(),zS=Symbol(),FS=Symbol(),OS=Symbol(),uh,Jt=xf(),LS=Symbol(),sl,ll,YS="f12e82bf-1908-48c7-a1af-860615f16e87",My="instantdb-imba-template",KS=Symbol();class XS{constructor(){this.local=J0(My),this.local.user,this.local.tasks,this.local.loginΦ,this.local.sentCodeΦ,this.local.error,this.local.loading,this.local.email_input,$i(this,KS)}static{zi(this,KS,"dataSYNC",16)}}globalThis.DATA=new XS;var GS=Symbol();class CS{constructor(){DATA.instant=Gn({appId:YS}),$i(this,GS)}subscribe(){return DATA.instant.subscribeAuth(function(i){let h;if(console.log("Auth state changed:",i),i.error)return console.log("Error during authentication");else if(i.user)if(DATA.local.user=i.user,DATA.local.loginΦ=!0,W(),DATA.local.user){console.log(DATA.local.user.id);let t={tasks:{$:{where:{"$users.id":DATA.local.user.id}}}};return console.log("Executing query:",t),h=DATA.instant.subscribeQuery(t,function(s){if(console.log("Query response:",s),s.error)return console.error("Uh oh!",s.error.message);else if(s.data)if(s.data.tasks)return DATA.local.tasks=s.data.tasks||[],W();else return console.warn("Unexpected response structure:",s);else return console.warn("Unexpected response:",s)})}else return console.warn("User is not logged in. Skipping query.");else return DATA.local.loginΦ=!0,DATA.local.user=!1,W()})}async sendMagicCode(){if(!DATA.local.email_input){console.error("Email is required to send a magic code.");return}return console.log(DATA.local.email_input,"clicked login"),await DATA.instant.auth.sendMagicCode({email:DATA.local.email_input}),DATA.local.sentCodeΦ=!0,W()}async logout(){return console.log("clicked logout"),await DATA.instant.auth.signOut(),DATA.local.user=!1,DATA.local.email_input="",W()}async loginWithCode(i){if(!DATA.local.email_input||!i){console.error("Both email and code are required to sign in.");return}return await DATA.instant.auth.signInWithMagicCode({email:DATA.local.email_input,code:i}),DATA.local.email_input=!1,DATA.local.sentCodeΦ=!1}static{zi(this,GS,"InstantAPI",16)}}globalThis.API=new CS;var Uy=Symbol();class qy extends qh{[q](i=null,h=!0,t=!0){var s;super[q](...arguments),this.magic_code=i&&(s=i.magic_code)!==void 0?s:"",this.email_input=i&&(s=i.email_input)!==void 0?s:DATA.local.email_input!==""?DATA.local.email_input:""}persistEmailInput(){return DATA.local.email_input=this.email_input}mount(){return DATA.local.email_input,API.subscribe()}render(){var i=this,h,t,s,l,u,e,r,f,m=this._ns_||"",n,S,d,v,b,w,T,E,N,z,F,O,L,Y,g,C,Si,li,Ki,K,G,x,_,k,U,$,ui,rh,pi,Ni,Gi,fh,_i;if(e=this,e[Ge](),(r=f=1,e[Xn]===1)||(r=f=0,e[Xn]=1),(!r||f&2)&&e.flagSelf$("z1lpkn79-ag"),r||(n=J("h1",e,`z1lpkn79-ah ${m}`,"Imba ❤ InstantDB")),(S=e[Cn])||(e[Cn]=S=J("div",e,`card ${m}`,null)),s=l=u=null,!DATA.local.user){if((d=v=1,s=e[Hn])||(d=v=0,e[Hn]=s=J("div",null,`col ${m}`,null)),d||(s[yi]=S),h=t=null,YS==="REPLACE_WITH_YOUR_PUBLIC_APP_ID")(b=w=1,h=s[Qn])||(b=w=0,s[Qn]=h=J("p",null,`${m}`,"Please set your InstantDB App ID on line 1 in src/index.imba")),b||(h[yi]=s);else if(DATA.local.sentCodeΦ)(T=E=1,h=s[Zn])||(T=E=0,s[Zn]=h=J("p",null,`${m}`,"Check your email for the magic code.")),T||(h[yi]=s),(N=z=1,t=s[gn])||(N=z=0,s[gn]=t=J("div",null,`row ${m}`,null)),N||(t[yi]=s),(O=L=1,F=t[Jn])||(O=L=0,t[Jn]=F=J("input",t,`${m}`,null)),O||(F.type="text"),Y=t[Wn]||(t[Wn]=F.bind$("data",[this,"magic_code"])),O||(F.placeholder="Enter magic code"),O||!F.setup||F.setup(L),F[eh](L),N||(g=J("button",t,`${m}`,"Login")),N||g.on$("click",{$_:[function(zh,Ah){return API.loginWithCode(i.magic_code)}]},this);else(C=Si=1,h=s[Bn])||(C=Si=0,s[Bn]=h=J("p",null,`${m}`,"Please enter your email and click 'get code' to receive a magic code.")),C||(h[yi]=s),(li=Ki=1,t=s[Rn])||(li=Ki=0,s[Rn]=t=J("div",null,`row ${m}`,null)),li||(t[yi]=s),(G=x=1,K=t[Mn])||(G=x=0,t[Mn]=K=J("input",t,`z1lpkn79-ar ${m}`,null)),G||(K.type="text"),_=t[Un]||(t[Un]=K.bind$("data",[this,"email_input"])),G||(K.placeholder="Enter your email"),G||!K.setup||K.setup(x),K[eh](x),li||(k=J("button",t,`z1lpkn79-as ${m}`,"get code")),li||k.on$("click",{$_:[function(zh,Ah){return API.sendMagicCode()}]},this);s[qn]=s[Di](h,0,s[qn]),s[Pn]=s[Di](t,0,s[Pn])}else(U=$=1,s=e[Vn])||(U=$=0,e[Vn]=s=J("div",null,`z1lpkn79-at row ${m}`,null)),U||(s[yi]=S),(ui=s[jn])||(s[jn]=ui=J("p",s,`${m}`,null)),U||ui[Di]("Crush it "),ii.context=s[xn]||(s[xn]={_:ui}),rh=DATA.local.user.email.split("@").shift(),ii.context=null,rh===s[Dn]&&U||(s[An]=ui[Di](s[Dn]=rh,0,s[An])),U||ui[Di]("!"),U||(pi=J("button",s,`${m}`,"logout")),U||pi.on$("click",{$_:[function(zh,Ah){return API.logout(),i.email_input=""}]},this),(Ni=Gi=1,l=e[pn])||(Ni=Gi=0,e[pn]=l=Xs("add-task",null,`${m}`,null)),Ni||(l[yi]=S),Ni||!l.setup||l.setup(Gi),l[eh](Gi),(fh=_i=1,u=e[_n])||(fh=_i=0,e[_n]=u=Xs("task-list",null,`${m}`,null)),fh||(u[yi]=S),fh||!u.setup||u.setup(_i),u[eh](_i);return e[kn]=S[Di](s,0,e[kn]),e[$n]=S[Di](l,0,e[$n]),e[an]=S[Di](u,0,e[an]),e[Ye](f),e}static{this.prototype[Dh]=Gs,Bt([Yu.bind([])],this.prototype,"email_input",null),Bt([um.bind([])],this.prototype,"persistEmailInput",null),zi(this,Uy,"app",258),Cs("app",this,{cssid:"z1lpkn79-af"})}}var Py=Symbol();class Vy extends qh{[q](i=null,h=!0,t=!0){var s;super[q](...arguments),this.task_input=i&&(s=i.task_input)!==void 0?s:""}async saveTask(i){if(!DATA.local.user){console.error("Cannot save task: No DATA.local.user is logged in.");return}return console.log("there is id "+DATA.local.user.id),await DATA.instant.transact([Ht.tasks[M()].update({content:this.task_input,createdAt:Date.now()}).link({$users:DATA.local.user.id})]),this.task_input="",W()}render(){var i,h,t,s=this._ns_||"",l,u,e,r,f,m,n,S,d,v,b,w;return i=this,i[Ge](),(h=t=1,i[on]===1)||(h=t=0,i[on]=1),h||(l=J("div",i,`row ${s}`,null)),(e=r=1,u=i[cn])||(e=r=0,i[cn]=u=J("input",l,`${s}`,null)),f=i[In]||(i[In]=u.bind$("data",[this,"task_input"])),e||u.on$("keydown",{enter:!0,saveTask:!0},this),e||(u.placeholder="Add a task"),e||!u.setup||u.setup(r),u[eh](r),(n=S=1,m=i[iS])||(n=S=0,i[iS]=m=J("button",l,`z1lpkn79-bb icon ${s}`,null)),n||m.on$("click",{saveTask:!0},this),(v=b=1,d=i[hS])||(v=b=0,i[hS]=d=yt("svg",m,`z1lpkn79-bc ${s}`,null)),w=dm,w===i[tS]||d.set$("src",i[tS]=w),i[Ye](t),i}static{this.prototype[Dh]=Gs,Bt([Yu.bind([])],this.prototype,"task_input",null),zi(this,Py,"add-task",258),Cs("add-task",this,{})}}var jy=Symbol();class Ay extends qh{[q](i=null,h=!0,t=!0){var s;super[q](...arguments),this.task_content=i&&(s=i.task_content)!==void 0?s:"",this.taskID=i&&(s=i.taskID)!==void 0?s:""}editTask(i){return this.task_content=""+i.content,this.taskID=i.id}deleteTask(i){return DATA.instant.transact([Ht.tasks[i.id].delete()]),this.task_content="",this.taskID="",W()}saveTask(i){return DATA.instant.transact([Ht.tasks[i.id].update({content:this.task_content})]),this.task_content="",this.taskID="",W()}render(){var i=this,h,t,s,l,u,e,r=this._ns_||"",f,m,n,S,d,v,b,w,T,E,N,z,F,O,L,Y,g,C,Si,li,Ki,K,G,x,_,k,U,$,ui,rh,pi,Ni,Gi,fh,_i,zh,Ah,Xe,ul;h=this,h[Ge](),(t=s=1,h[sS]===1)||(t=s=0,h[sS]=1),(!t||s&2)&&h.flagSelf$("z1lpkn79-bd"),(l=h[lS])||(h[lS]=l=h0(1280,h)),u=0,e=l.$;for(let el=0,Ce=ki(DATA.local.tasks),HS=Ce.length;el<HS;el++){let Fh=Ce[el];if(this.taskID==="")(m=S=1,f=(n=e[Yn](By)).get(u))||(m=S=0,n.set(u,f=J("div",l,`z1lpkn79-be ${r}`,null))),m||(f[yi]=l),(d=f[uS])||(f[uS]=d=J("span",f,`z1lpkn79-bf z1lpkn79_be ${r}`,null)),v=Fh.content,v===f[rS]&&m||(f[eS]=d[Di](String(f[rS]=v),128,f[eS])),(w=T=1,b=f[fS])||(w=T=0,f[fS]=b=J("button",f,`icon z1lpkn79_be ${r}`,null)),E=f[mS]||(f[mS]={$_:[function(He,Qe,xh){return i.editTask(xh)},null]}),E.$_[1]=Fh,w||b.on$("click",E,this),(z=F=1,N=f[nS])||(z=F=0,f[nS]=N=yt("svg",b,`z1lpkn79-bh z1lpkn79_be ${r}`,null)),O=bm,O===f[SS]||N.set$("src",f[SS]=O),(Y=g=1,L=f[bS])||(Y=g=0,f[bS]=L=J("button",f,`icon z1lpkn79_be ${r}`,null)),C=f[dS]||(f[dS]={$_:[function(He,Qe,xh){return i.deleteTask(xh)},null]}),C.$_[1]=Fh,Y||L.on$("click",C,this),(li=Ki=1,Si=f[wS])||(li=Ki=0,f[wS]=Si=yt("svg",L,`z1lpkn79-bj z1lpkn79_be ${r}`,null)),K=wm,K===f[vS]||Si.set$("src",f[vS]=K),l.push(f,u++,n);else if(ge(this.taskID,Fh.id))(x=k=1,G=(_=e[Yn](Ry)).get(u))||(x=k=0,_.set(u,G=J("div",l,`z1lpkn79-bk ${r}`,null))),x||(G[yi]=l),($=ui=1,U=G[ES])||($=ui=0,G[ES]=U=J("input",G,`z1lpkn79-bl ${r}`,null)),rh=G[TS]||(G[TS]=U.bind$("data",[this,"task_content"])),pi=G[yS]||(G[yS]={enter:!0,saveTask:[null]}),pi.saveTask[0]=Fh,$||U.on$("keydown",pi,this),$||!U.setup||U.setup(ui),U[eh](ui),(Gi=fh=1,Ni=G[NS])||(Gi=fh=0,G[NS]=Ni=J("button",G,`z1lpkn79-bm icon ${r}`,null)),_i=G[zS]||(G[zS]={$_:[function(He,Qe,xh){return i.saveTask(xh)},null]}),_i.$_[1]=Fh,Gi||Ni.on$("click",_i,this),(Ah=Xe=1,zh=G[FS])||(Ah=Xe=0,G[FS]=zh=yt("svg",Ni,`z1lpkn79-bn ${r}`,null)),ul=Sm,ul===G[OS]||zh.set$("src",G[OS]=ul),l.push(G,u++,_)}return l[eh](u),h[Ye](s),h}static{zi(this,jy,"task-list",2),Cs("task-list",this,{})}}nu(((sl=ll=1,uh=Jt[LS])||(sl=ll=0,uh=Jt[LS]=uh=Xs("app",null,null,null)),sl||(uh[yi]=Jt._),sl||Jt.sym||!uh.setup||uh.setup(ll),Jt.sym||uh[eh](ll),uh));mu.register("z1lpkn79",`:root {--icon-size: 28px;}
:root div.row:not(._0) {display: flex;
gap: 1em;
--u_rg: 1em;
--u_cg: 1em;}
:root div.col:not(._0) {display: flex;
flex-direction: column;
gap: 1em;
--u_rg: 1em;
--u_cg: 1em;}
:root input {color: hsla(240.00,5.88%,10.00%,100%);
padding-left: 10px;
padding-right: 10px;
border-radius: 5px;
font-size: 16px;
flex-grow: 1;
box-shadow: var(--box-shadow-xs,0 1px 2px 0 hsla(var(--bxs-xs-color,0,0%,0%),var(--bxs-xs-alpha,0.05))), var(--box-shadow-inner,inset 0 2px 4px 0 hsla(var(--bxs-inner-color,0,0%,0%),var(--bxs-inner-alpha,0.06)));
padding-top: 5px;
padding-bottom: 5px;
height: var(--icon-size);}
:root button {color: hsla(240.00,5.88%,10.00%,100%);
background: hsla(240.00,4.76%,95.88%,100%);
border-radius: 5px;
font-size: 16px;
height: var(--icon-size);
padding-left: 1em;
padding-right: 1em;
display: flex;
flex-direction: row;
justify-content: center;
align-items: center;
align-content: center;}
:root button:is(:hover,.\\@hover):not(._0) {background: hsla(50.44,97.85%,63.53%,100%);}
:root button.icon:not(._0) {padding: 0px;
width: var(--icon-size);
height: var(--icon-size);}
:root div.card:not(._0) {max-width: 600px;
background: hsla(0.00,0.00%,100.00%,100%);
border-radius: 8px;
box-shadow: var(--box-shadow-lg,0 10px 15px -3px hsla(var(--bxs-lg-color,0,0%,0%), var(--bxs-lg-alpha,0.1)), 0 4px 6px -2px hsla(var(--bxs-lg-color,0,0%,0%),calc(var(--bxs-lg-alpha,0.1) * 0.5))), var(--box-shadow-md,0 4px 6px -1px hsla(var(--bxs-md-color,0,0%,0%), var(--bxs-md-alpha,0.1)), 0 2px 4px -1px hsla(var(--bxs-md-color,0,0%,0%),calc(var(--bxs-md-alpha,0.1) * 0.6)));
padding: 2em;
display: flex;
flex-direction: column;
justify-content: space-between;
text-align: left;
gap: 1em;
--u_rg: 1em;
--u_cg: 1em;}

.z1lpkn79-af {display: flex;
flex-direction: column;
justify-content: flex-start;
align-items: center;
align-content: center;}

.z1lpkn79-ag:not(#_):not(#_) {background: hsla(240.00,4.76%,95.88%,100%);
position: absolute;
top: 0rem;
right: 0rem;
bottom: 0rem;
left: 0rem;
display: flex;
flex-direction: column;
justify-content: center;
align-items: center;
align-content: center;
gap: 2em;
--u_rg: 2em;
--u_cg: 2em;}

.z1lpkn79-ah:not(#_):not(#_):not(#_) {font-size: xx-large;
font-family: var(--font-mono,Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace);}

.z1lpkn79-ar:not(#_):not(#_):not(#_) {width: auto;}

.z1lpkn79-as:not(#_):not(#_):not(#_) {padding-left: 1em;
padding-right: 1em;}

.z1lpkn79-at:not(#_):not(#_):not(#_) {display: flex;
flex-direction: row;
justify-content: flex-end;
align-items: center;
align-content: center;}

app-tag { display:block; }

.z1lpkn79-bb:not(#_):not(#_) {display: flex;
justify-content: center;
padding: 5px;}

.z1lpkn79-bc:not(#_):not(#_):not(#_) {width: 18px;
height: 18px;
fill: hsla(234.45,89.47%,73.92%,100%);}

add-task { display:block; }

.z1lpkn79-bd:not(#_):not(#_) {display: flex;
flex-direction: column;
gap: 0.5em;
--u_rg: 0.5em;
--u_cg: 0.5em;}

.z1lpkn79-be:not(#_):not(#_) {display: flex;
gap: 1em;
--u_rg: 1em;
--u_cg: 1em;}

.z1lpkn79-bf:not(#_):not(#_):not(#_) {font-family: var(--font-serif,Georgia, Cambria, "Times New Roman", Times, serif);
flex-grow: 1;}

.z1lpkn79-bf:not(#_):not(#_) {background: hsla(0.00,0.00%,98.04%,100%);
padding-left: 1em;
padding-right: 1em;
border-radius: 4px;}

button.z1lpkn79_be:not(#_) {display: flex;
justify-content: center;
padding: 5px;}

.z1lpkn79-bh:not(#_):not(#_):not(#_) {width: 18px;
height: 18px;
fill: hsla(234.45,89.47%,73.92%,100%);}

.z1lpkn79-bj:not(#_):not(#_):not(#_) {width: 18px;
height: 18px;
fill: hsla(234.45,89.47%,73.92%,100%);}

.z1lpkn79-bk:not(#_):not(#_) {display: flex;
gap: 1em;
--u_rg: 1em;
--u_cg: 1em;}

.z1lpkn79-bl:not(#_):not(#_):not(#_) {flex-grow: 1;}

.z1lpkn79-bm:not(#_):not(#_):not(#_) {display: flex;
flex-direction: row;
justify-content: center;
align-items: center;
align-content: center;}

.z1lpkn79-bn:not(#_):not(#_):not(#_) {width: 18px;
height: 18px;
fill: hsla(234.45,89.47%,73.92%,100%);}

task-list { display:block; }`);
